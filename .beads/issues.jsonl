{"id":"ArcataAI-0cn","title":"Job URL Submission Flow - End-to-end integration","description":"Epic: Connect HQ UI to Scala API for job URL submission. User submits URL -\u003e API processes via ETL pipeline -\u003e job appears in stream/tracker. Includes: API client, route action, notifications, side panel, data revalidation.","status":"open","issue_type":"epic","created_at":"2025-12-22T19:00:46.272951981-05:00","updated_at":"2025-12-22T19:00:46.272951981-05:00"}
{"id":"ArcataAI-0cn.3","title":"Create Notification component","description":"Create libs/components/src/lib/notifications/Notification.tsx\n\nFeatures:\n- Toast-style notification with Transition animation\n- States: loading (spinner), success (CheckCircleIcon), error (XCircleIcon)\n- Auto-dismiss after configurable timeout (default 5s for success)\n- Manual dismiss via X button\n- Props: { show, onClose, title, message, variant: 'loading' | 'success' | 'error' }\n\nAlso create NotificationProvider context for global notifications:\n- useNotification() hook returns { notify, dismiss }\n- Renders notification portal at document root\n\nExport from libs/components/src/index.ts","status":"open","issue_type":"task","created_at":"2025-12-22T19:01:14.422937459-05:00","updated_at":"2025-12-22T19:01:14.422937459-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.3","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:14.42387003-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.4","title":"Create JobDetailPanel side panel component","description":"Create apps/hq/src/routes/jobs/JobDetailPanel.tsx\n\nStubbed side panel using HeadlessUI Dialog that slides in from right (max-w-2xl).\n\nProps:\n- isOpen: boolean\n- onClose: () =\u003e void  \n- jobId: number | null\n- jobData?: { title: string, company: string, url: string } (optional, for immediate display)\n\nContent (stubbed):\n- Header with job title and close button\n- Company name\n- Link to original job posting\n- Placeholder sections for: Job Description, Requirements, Match Score, Notes\n- Footer with action buttons (placeholder)\n\nThis is a stub - full implementation comes later.","status":"open","issue_type":"task","created_at":"2025-12-22T19:01:23.666755521-05:00","updated_at":"2025-12-22T19:01:23.666755521-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.4","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:23.667547567-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732","title":"Rework ETL to use BoogieLoops AI directly","description":"Replace external BoogieLoops API calls with direct BoogieLoops AI Agent usage via Vercel AI Gateway. Includes: AI config, JobExtractionAgent, CompanyEnrichmentAgent, updated JobParser step, updated CompanyResolver step.","status":"open","issue_type":"epic","created_at":"2025-12-22T20:07:19.021507555-05:00","updated_at":"2025-12-22T20:07:19.021507555-05:00"}
{"id":"ArcataAI-732.2","title":"Add Schematic derivation to domain models","description":"Update domain models to derive Schematic for BoogieLoops AI structured output.\n\nFile: apps/api/src/main/scala/arcata/api/domain/ExtractedJobData.scala\n- Add: derives ReadWriter, Schematic\n- Remove: rawText field (not needed, HTML stored in object storage)\n- Import: boogieloops.schema.derivation.Schematic\n\nCreate new model for company extraction:\nFile: apps/api/src/main/scala/arcata/api/domain/ExtractedCompanyData.scala\n\nfinal case class ExtractedCompanyData(\n    name: String,\n    domain: Option[String] = None,\n    industry: Option[String] = None,\n    size: Option[String] = None,        // startup, small, medium, large, enterprise\n    description: Option[String] = None,\n    headquarters: Option[String] = None,\n    websiteUrl: Option[String] = None\n) derives ReadWriter, Schematic","status":"open","issue_type":"task","created_at":"2025-12-22T20:07:32.960257672-05:00","updated_at":"2025-12-22T20:07:32.960257672-05:00","dependencies":[{"issue_id":"ArcataAI-732.2","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:32.960809058-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.4","title":"Create CompanyEnrichmentAgent","description":"Create apps/api/src/main/scala/arcata/api/ai/CompanyEnrichmentAgent.scala\n\nUses BoogieLoops AI Agent to enrich company data from job posting context.\n\nclass CompanyEnrichmentAgent(config: AIConfig):\n  private val provider = OpenAICompatibleProvider(...)\n  \n  private val agent = Agent(\n    name = \"CompanyEnricher\",\n    instructions = \"\"\"You extract and enrich company information from job posting context.\nGiven the company name, job posting HTML, and URL, extract additional company details\nthat can be inferred from the content.\"\"\",\n    provider = provider,\n    model = config.model,\n    temperature = Some(0.1)\n  )\n  \n  def enrich(\n    companyName: String,\n    html: String,\n    url: String\n  ): Either[SchemaError, ExtractedCompanyData] =\n    agent.generateObjectWithoutHistory[ExtractedCompanyData](\n      s\"\"\"Extract company information for '$companyName' from this job posting.\nURL: $url\n\nHTML Content:\n$html\"\"\",\n      RequestMetadata()\n    ).map(_.data)\n\nThis enriches company records with industry, size, description, etc.","status":"open","issue_type":"task","created_at":"2025-12-22T20:07:49.132609219-05:00","updated_at":"2025-12-22T20:07:49.132609219-05:00","dependencies":[{"issue_id":"ArcataAI-732.4","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:49.133153582-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.4","depends_on_id":"ArcataAI-732.1","type":"blocks","created_at":"2025-12-22T20:08:30.363606251-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.4","depends_on_id":"ArcataAI-732.2","type":"blocks","created_at":"2025-12-22T20:08:30.375122774-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.5","title":"Update AddJobByUrl action to call real API","description":"Update apps/hq/src/routes/jobs/AddJobByUrl.tsx action function:\n\n1. Get session token from Supabase auth (getSession from @arcata/db)\n2. Call ingestJob() from api.ts with URL and token\n3. Return response shape: { success, error, jobId, streamId, message }\n\nThe action now:\n- Validates URL with joi (existing)\n- Gets auth token\n- Calls Scala API\n- Returns structured response for UI to consume\n\nError handling:\n- No session -\u003e return { success: false, error: 'Not authenticated' }\n- API error -\u003e return { success: false, error: response.error, details: response.details }\n- Network error -\u003e return { success: false, error: 'Network error' }","status":"closed","issue_type":"task","created_at":"2025-12-22T19:01:32.942779508-05:00","updated_at":"2025-12-22T19:41:14.890832914-05:00","closed_at":"2025-12-22T19:41:14.890832914-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.5","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:32.943702419-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.5","depends_on_id":"ArcataAI-0cn.2","type":"blocks","created_at":"2025-12-22T19:02:05.888458325-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-43a","title":"Remove unused @arcata/envs library","description":"The libs/envs package is declared as a dependency in multiple package.json files but never actually imported in any TypeScript code. Remove the library and all references to it.","status":"in_progress","priority":1,"issue_type":"chore","created_at":"2025-12-22T19:06:20.886846884-05:00","updated_at":"2025-12-22T19:06:25.331197341-05:00"}
{"id":"ArcataAI-732.8","title":"Update JobIngestionPipeline for new AI config","description":"Update apps/api/src/main/scala/arcata/api/etl/JobIngestionPipeline.scala\n\nConstructor change:\n- Old: JobIngestionPipeline(supabaseClient, boogieLoopsConfig, storageClient)\n- New: JobIngestionPipeline(supabaseClient, aiConfig, storageClient)\n\nUpdate step initialization:\n- jobParser = JobParser(aiConfig)\n- companyResolver = CompanyResolver(supabaseClient, aiConfig)\n\nUpdate execute() to pass HTML through to CompanyResolver:\n- CompanyResolverInput now needs html field\n- Pass fetcherOutput.html to companyResolver step\n\nUpdate ApiApp.scala to use new AIConfig instead of BoogieLoopsConfig.","status":"open","issue_type":"task","created_at":"2025-12-22T20:08:16.556802139-05:00","updated_at":"2025-12-22T20:08:16.556802139-05:00","dependencies":[{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:16.557377392-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732.5","type":"blocks","created_at":"2025-12-22T20:08:30.436829327-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732.6","type":"blocks","created_at":"2025-12-22T20:08:30.448042718-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732.10","type":"blocks","created_at":"2025-12-22T20:11:30.880713213-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.10","title":"Add early exit check for existing jobs in pipeline","description":"Address TODO on line 52 of JobIngestionPipeline.scala: 'look up existing job first! so we can exit early'\n\nAdd a new step at the beginning of the pipeline:\n\nStep 0: Check if job already exists by source URL\n- Call supabaseClient.findJobBySourceUrl(input.url)\n- If job exists:\n  - Skip HTML fetch, parsing, company resolution, job loading\n  - Go directly to StreamLoader (add to user's stream if not already there)\n  - Then ApplicationLoader if createApplication=true\n- If job doesn't exist:\n  - Continue with full pipeline\n\nThis optimization:\n1. Saves AI/API costs (no parsing needed)\n2. Faster response for duplicate URLs\n3. Still adds job to user's stream/applications\n\nImplementation approach:\n- Create new step: JobLookup (or inline check in execute())\n- Returns Either[StepError, Option[Job]]\n- If Some(job), short-circuit to step 5\n- If None, continue full pipeline\n\nAlso relates to company enrichment - only enrich NEW companies (option b from discussion).","status":"open","issue_type":"task","created_at":"2025-12-22T20:11:25.649060085-05:00","updated_at":"2025-12-22T20:11:25.649060085-05:00","dependencies":[{"issue_id":"ArcataAI-732.10","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:11:25.649643073-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.7","title":"Integrate NotificationProvider into HQ app","description":"Wrap HQ app with NotificationProvider:\n\n1. Update apps/hq/src/main.tsx or App.tsx to include NotificationProvider\n2. Ensure notification portal renders at document root level\n3. Test that useNotification() hook works from AddJobByUrl component\n\nThis enables global toast notifications across the HQ app.","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-22T19:01:50.169569164-05:00","updated_at":"2025-12-22T19:01:50.169569164-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.7","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:50.17029457-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.7","depends_on_id":"ArcataAI-0cn.3","type":"blocks","created_at":"2025-12-22T19:02:05.960462454-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-fen","title":"Add architecture diagram maintenance rule to AGENTS.md","description":"Add section to AGENTS.md instructing AI agents to keep architecture diagrams in sync when modifying system topology. Reference docs/architecture.md and apps/api/README.md diagrams.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-22T18:40:12.528576224-05:00","updated_at":"2025-12-22T18:42:50.802277545-05:00","closed_at":"2025-12-22T18:42:50.802277545-05:00"}
{"id":"ArcataAI-0cn.1","title":"Add VITE_API_URL environment variable","description":"Add VITE_API_URL to apps/hq environment config. Default: http://localhost:4203 for local dev. Update .env.example at root with this new variable. This enables the HQ frontend to call the Scala API.","status":"open","issue_type":"task","created_at":"2025-12-22T19:00:54.918743025-05:00","updated_at":"2025-12-22T19:00:54.918743025-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.1","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:00:54.919422872-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.8","title":"Add translations for job submission flow","description":"Add translation keys to apps/hq/public/locales/en.json\n\npages.hq.notifications:\n  processing: 'Processing job URL...'\n  success: 'Job added successfully'\n  error: 'Failed to add job'\n\npages.hq.ingestion:\n  stepOf: 'Step {{current}} of {{total}}'\n  steps:\n    fetching: 'Fetching'\n    parsing: 'Parsing'\n    resolving: 'Resolving'\n    loading: 'Loading'\n    streaming: 'Streaming'\n    tracking: 'Tracking'\n  errorAt: 'Failed at {{step}}'\n  errorRetry: 'Something went wrong. Try adding the job again.'\n\npages.hq.jobDetail:\n  title: 'Job Details'\n  apply: 'Apply'\n  department: 'Department'\n  location: 'Location'\n  jobUrl: 'Job URL'\n  description: 'Description'\n  qualifications: 'Qualifications'\n  responsibilities: 'Responsibilities'\n  loading: 'Loading job details...'","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-22T19:01:58.396826488-05:00","updated_at":"2025-12-22T20:00:39.742917947-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.8","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:58.397677379-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.5","title":"Rework JobParser step to use JobExtractionAgent","description":"Update apps/api/src/main/scala/arcata/api/etl/steps/JobParser.scala\n\nRemove:\n- HTTP calls to external BoogieLoops API\n- BoogieLoopsConfig dependency\n- BoogieLoopsResponse case class\n\nAdd:\n- JobExtractionAgent dependency\n- AIConfig dependency\n\nUpdated execute():\n1. Call jobExtractionAgent.extract(input.html, input.url)\n2. Map SchemaError to StepError.TransformationError\n3. Return JobParserOutput with extracted data\n\nConstructor change:\n- Old: JobParser(config: BoogieLoopsConfig)\n- New: JobParser(aiConfig: AIConfig)\n\nInternal: Creates JobExtractionAgent instance","status":"open","issue_type":"task","created_at":"2025-12-22T20:07:55.786194568-05:00","updated_at":"2025-12-22T20:07:55.786194568-05:00","dependencies":[{"issue_id":"ArcataAI-732.5","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:55.786871961-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.5","depends_on_id":"ArcataAI-732.3","type":"blocks","created_at":"2025-12-22T20:08:30.387385413-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.1","title":"Update Config with AI provider settings","description":"Update apps/api/src/main/scala/arcata/api/config/Config.scala\n\nReplace BoogieLoopsConfig with AIConfig:\n\nfinal case class AIConfig(\n    baseUrl: String,      // Vercel AI Gateway: https://api.vercel.ai/v1\n    apiKey: String,       // VERCEL_AI_GATEWAY_API_KEY\n    model: String         // anthropic/claude-sonnet-4-20250514\n)\n\nUpdate environment variable loading:\n- VERCEL_AI_GATEWAY_URL (default: https://api.vercel.ai/v1)\n- VERCEL_AI_GATEWAY_API_KEY (required)\n- AI_MODEL (default: anthropic/claude-sonnet-4-20250514)\n\nUpdate .env.example with new variables.","status":"open","issue_type":"task","created_at":"2025-12-22T20:07:25.968580865-05:00","updated_at":"2025-12-22T20:07:25.968580865-05:00","dependencies":[{"issue_id":"ArcataAI-732.1","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:25.969186437-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.3","title":"Create JobExtractionAgent","description":"Create apps/api/src/main/scala/arcata/api/ai/JobExtractionAgent.scala\n\nUses BoogieLoops AI Agent with OpenAICompatibleProvider via Vercel AI Gateway.\n\nclass JobExtractionAgent(config: AIConfig):\n  private val provider = OpenAICompatibleProvider(\n    baseUrl = config.baseUrl,\n    apiKey = config.apiKey,\n    modelId = config.model,\n    strictModelValidation = false\n  )\n  \n  private val agent = Agent(\n    name = \"JobExtractor\",\n    instructions = \"\"\"You are a job posting parser. Given HTML content from a job posting page,\nextract structured job information. Be thorough but concise. If information is not present,\nleave the field empty rather than guessing.\"\"\",\n    provider = provider,\n    model = config.model,\n    temperature = Some(0.1)  // Low temp for consistent extraction\n  )\n  \n  def extract(html: String, url: String): Either[SchemaError, ExtractedJobData] =\n    agent.generateObjectWithoutHistory[ExtractedJobData](\n      s\"\"\"Extract job details from this HTML. Source URL: $url\n      \nHTML Content:\n$html\"\"\",\n      RequestMetadata()\n    ).map(_.data)","status":"open","issue_type":"task","created_at":"2025-12-22T20:07:41.368941884-05:00","updated_at":"2025-12-22T20:07:41.368941884-05:00","dependencies":[{"issue_id":"ArcataAI-732.3","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:41.369535442-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.3","depends_on_id":"ArcataAI-732.1","type":"blocks","created_at":"2025-12-22T20:08:30.339437238-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.3","depends_on_id":"ArcataAI-732.2","type":"blocks","created_at":"2025-12-22T20:08:30.351560756-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-lbq","title":"Remove docs/plans/ directory","description":"Delete the docs/plans/ directory. Planning now lives in bd CLI. Remove 2025-12-22-migration-to-arcata-ai.md and the plans/ folder.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-22T18:39:59.689120305-05:00","updated_at":"2025-12-22T18:40:42.482487766-05:00","closed_at":"2025-12-22T18:40:42.482487766-05:00"}
{"id":"ArcataAI-0y4","title":"Create docs/architecture.md","description":"Create high-level architecture documentation with ASCII system diagram showing: Auth (:4200), HQ (:4201), API (:4203), Supabase, ObjectStorage, BoogieLoops. Include component descriptions, shared libraries table, and external services table with links to ObjectStorage and BoogieLoops repos.","status":"closed","issue_type":"chore","created_at":"2025-12-22T18:40:06.211440628-05:00","updated_at":"2025-12-22T18:41:42.569010098-05:00","closed_at":"2025-12-22T18:41:42.569010098-05:00"}
{"id":"ArcataAI-5nt","title":"Rewrite root README.md","description":"Replace the outdated README with a new developer-focused quick start guide. Must include: mission statement (candidate-first, O'Saasy promise), prerequisites (Bun, Supabase CLI, Mill), setup instructions, local Supabase guidance with link to CLI docs, dev server commands, project structure overview, links to docs/architecture.md and apps/api/README.md, license section.","status":"closed","issue_type":"chore","created_at":"2025-12-22T18:40:03.568237117-05:00","updated_at":"2025-12-22T18:41:09.678503543-05:00","closed_at":"2025-12-22T18:41:09.678503543-05:00"}
{"id":"ArcataAI-733","title":"Create apps/api/README.md with ETL diagram","description":"Create API service documentation with: prerequisites (Java 11+, Mill), setup instructions, make commands, ETL pipeline ASCII diagram showing HtmlFetcher -\u003e JobParser -\u003e CompanyResolver -\u003e JobLoader/StreamLoader/ApplicationLoader flow. Include pipeline steps table and links to ObjectStorage, BoogieLoops, Mill docs, Cask docs, and back to system architecture.","status":"closed","issue_type":"chore","created_at":"2025-12-22T18:40:09.110647261-05:00","updated_at":"2025-12-22T18:42:14.980871458-05:00","closed_at":"2025-12-22T18:42:14.980871458-05:00"}
{"id":"ArcataAI-732.7","title":"Update Company domain model with enrichment fields","description":"Update apps/api/src/main/scala/arcata/api/domain/Company.scala\n\nAdd fields to match ExtractedCompanyData:\n- industry: Option[String] = None\n- companySize: Option[String] = None  // startup, small, medium, large, enterprise\n- description: Option[String] = None\n- headquarters: Option[String] = None\n\nUpdate SupabaseClient company methods to handle new fields.\n\nMay need Supabase migration to add columns to companies table:\n- industry VARCHAR\n- company_size VARCHAR\n- description TEXT\n- headquarters VARCHAR","status":"open","issue_type":"task","created_at":"2025-12-22T20:08:09.511404162-05:00","updated_at":"2025-12-22T20:08:09.511404162-05:00","dependencies":[{"issue_id":"ArcataAI-732.7","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:09.512117114-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.7","depends_on_id":"ArcataAI-732.9","type":"blocks","created_at":"2025-12-22T20:08:30.424381927-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.13","title":"Simplify AddJobPopover to just collect URL","description":"Simplify apps/hq/src/routes/jobs/AddJobByUrl.tsx\n\nRemove:\n- Route action (no longer needed)\n- useFetcher (parent handles submission)\n- Success/error handling in component\n\nAddJobPopover now just:\n- Renders popover with URL input\n- Validates URL with joi\n- Calls onSubmit(url) prop and closes popover\n- Parent (HQ.tsx) handles the rest\n\nProps:\ninterface AddJobPopoverProps {\n  actuator: ReactNode;\n  onSubmit: (url: string) =\u003e void;\n  disabled?: boolean;\n}","status":"open","issue_type":"task","created_at":"2025-12-22T19:41:25.86427536-05:00","updated_at":"2025-12-22T19:41:25.86427536-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.13","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:41:25.864908144-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.6","title":"Update AddJobPopover UI for processing states","description":"Update apps/hq/src/routes/jobs/AddJobByUrl.tsx AddJobPopover component:\n\n1. Track submission state via fetcher.state ('idle', 'submitting', 'loading')\n2. Show notification on submit start (loading state)\n3. On success:\n   - Show success notification\n   - Close popover\n   - Trigger data revalidation (useRevalidator or navigate with replace)\n   - Open JobDetailPanel with returned jobId\n4. On error:\n   - Show error notification with message\n   - Keep popover open for retry\n\nState management:\n- Use useState for panel visibility: [panelJobId, setPanelJobId]\n- Use useEffect to react to fetcher.data changes\n\nButton states:\n- Disabled during submission\n- Shows spinner or 'Processing...' text","status":"closed","issue_type":"task","created_at":"2025-12-22T19:01:42.782527837-05:00","updated_at":"2025-12-22T19:41:19.147317085-05:00","closed_at":"2025-12-22T19:41:19.147317085-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:42.783256921-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn.3","type":"blocks","created_at":"2025-12-22T19:02:05.906980281-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn.4","type":"blocks","created_at":"2025-12-22T19:02:05.924932055-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn.5","type":"blocks","created_at":"2025-12-22T19:02:05.942032206-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.9","title":"Add Supabase migration for company enrichment fields","description":"Create supabase/migrations/20241222000010_add_company_enrichment_fields.sql\n\nALTER TABLE companies ADD COLUMN IF NOT EXISTS industry VARCHAR;\nALTER TABLE companies ADD COLUMN IF NOT EXISTS company_size VARCHAR;\nALTER TABLE companies ADD COLUMN IF NOT EXISTS description TEXT;\nALTER TABLE companies ADD COLUMN IF NOT EXISTS headquarters VARCHAR;\n\n-- Add index for industry filtering\nCREATE INDEX IF NOT EXISTS idx_companies_industry ON companies(industry);\n\nRun: supabase db push to apply migration","status":"open","issue_type":"task","created_at":"2025-12-22T20:08:22.363455525-05:00","updated_at":"2025-12-22T20:08:22.363455525-05:00","dependencies":[{"issue_id":"ArcataAI-732.9","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:22.364046279-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.11","title":"Create IngestionProgress component with step indicators","description":"Create apps/hq/src/routes/jobs/IngestionProgress.tsx\n\nProps:\ninterface IngestionProgressProps {\n  status: 'processing' | 'success' | 'error';\n  currentStep: number;\n  totalSteps: number;  // Dynamic! 7 for new job, 3 for existing\n  stepName: string;\n  error?: string;\n}\n\nSteps for NEW job (totalSteps=7):\n1. Checking - Looking up job...\n2. Fetching - Getting job page... (HtmlFetcher)\n3. Parsing - Extracting job details... (JobParser)\n4. Resolving - Finding company... (CompanyResolver)\n5. Loading - Creating job record... (JobLoader)\n6. Streaming - Adding to your feed... (StreamLoader)\n7. Tracking - Creating application... (ApplicationLoader, if enabled)\n\nSteps for EXISTING job (totalSteps=3):\n1. Checking - Looking up job... (found!)\n2. Streaming - Adding to your feed...\n3. Tracking - Creating application...\n\nUI: Horizontal dots progress indicator\n- Shows step name with animated dots: 'Checking...' -\u003e 'Fetching...' etc\n- Complete steps: solid indigo dot\n- Current step: indigo dot with pulsing ring\n- Upcoming steps: gray dot\n- 'Step X of Y' label (Y is dynamic)\n\nOn error: Show which step failed with error message\nOn success: Show all dots complete briefly, then transition\n\nThis component replaces 'Add Job' button in HQ header while processing.","status":"open","issue_type":"task","created_at":"2025-12-22T19:40:50.747883196-05:00","updated_at":"2025-12-22T20:11:49.655063978-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.11","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:50.748443117-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.12","title":"Hoist job ingestion state to HQ.tsx","description":"Move job ingestion state management to HQ.tsx\n\nState:\ninterface IngestionState {\n  status: 'idle' | 'processing' | 'success' | 'error';\n  currentStep: number;  // 0 when idle, 1-6 during processing\n  stepName: string;     // 'Fetching', 'Parsing', etc.\n  jobId?: number;\n  streamId?: number;\n  applicationId?: number;\n  error?: string;\n}\n\nStep name mapping:\n1: 'Fetching'\n2: 'Parsing'\n3: 'Resolving'\n4: 'Loading'\n5: 'Streaming'\n6: 'Tracking'\n\nFlow in HQ.tsx:\n1. handleSubmitJob(url) called from AddJobPopover\n2. Set status='processing', step=1\n3. Call ingestJobWithProgress() with onProgress callback\n4. onProgress updates currentStep and stepName as server emits\n5. On complete: set status='success', wait 1s, open JobDetailPanel, reset to idle\n6. On error: set status='error' with error message, require manual dismiss\n\nHeader rendering:\n- idle: show AddJobPopover\n- processing: show IngestionProgress with step/stepName\n- success: show IngestionProgress with all complete (brief)\n- error: show IngestionProgress with error + X dismiss button\n\nRevalidate data immediately on success.","status":"open","issue_type":"task","created_at":"2025-12-22T19:40:57.987426268-05:00","updated_at":"2025-12-22T20:00:32.312027459-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:57.988193644-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.10","type":"blocks","created_at":"2025-12-22T19:41:03.230136292-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.11","type":"blocks","created_at":"2025-12-22T19:41:03.242665376-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.4","type":"blocks","created_at":"2025-12-22T19:41:03.254602896-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.13","type":"blocks","created_at":"2025-12-22T19:41:29.414259601-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.6","title":"Rework CompanyResolver step to use CompanyEnrichmentAgent","description":"Update apps/api/src/main/scala/arcata/api/etl/steps/CompanyResolver.scala\n\nAdd:\n- CompanyEnrichmentAgent dependency\n- AIConfig dependency\n- HTML passed through from previous step (update input/output types)\n\nUpdated flow:\n1. Extract domain from URL (existing logic)\n2. Look up company by domain in DB\n3. If found:\n   - Check if company needs enrichment (missing industry, size, etc.)\n   - If needs enrichment, call companyEnrichmentAgent.enrich()\n   - Update company record with enriched data\n4. If not found:\n   - Call companyEnrichmentAgent.enrich() to get full company data\n   - Create new company with enriched data\n\nUpdate CompanyResolverInput to include html field.\nUpdate Company domain model if needed for new fields (industry, size, etc.)\n\nConstructor change:\n- Old: CompanyResolver(supabaseClient: SupabaseClient)\n- New: CompanyResolver(supabaseClient: SupabaseClient, aiConfig: AIConfig)","status":"open","issue_type":"task","created_at":"2025-12-22T20:08:03.621993476-05:00","updated_at":"2025-12-22T20:08:03.621993476-05:00","dependencies":[{"issue_id":"ArcataAI-732.6","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:03.622736427-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.6","depends_on_id":"ArcataAI-732.4","type":"blocks","created_at":"2025-12-22T20:08:30.39957561-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.6","depends_on_id":"ArcataAI-732.7","type":"blocks","created_at":"2025-12-22T20:08:30.411463839-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-adp","title":"Update package.json license field","description":"Change license field from 'MIT' to 'SEE LICENSE.md' to reflect the O'Saasy license.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-22T18:40:10.632742613-05:00","updated_at":"2025-12-22T18:42:32.352676129-05:00","closed_at":"2025-12-22T18:42:32.352676129-05:00"}
{"id":"ArcataAI-0cn.2","title":"Create API client for Scala backend","description":"Create apps/hq/src/lib/api.ts with typed API client. Based on OpenAPI spec:\n\nTypes:\n- IngestJobRequest: { url: string, source?: string, createApplication?: boolean, notes?: string }\n- IngestJobResponse: { success: boolean, jobId: number, streamId?: number, applicationId?: number, message: string }\n- JobErrorResponse: { success: boolean, error: string, details?: string }\n\nFunctions:\n- getApiUrl(): string - reads VITE_API_URL from env\n- ingestJob(request: IngestJobRequest, token: string): Promise\u003cIngestJobResponse\u003e\n  - POST to /api/v1/jobs/ingest\n  - Authorization: Bearer \u003ctoken\u003e\n  - Content-Type: application/json\n  - Handle errors, return typed response","status":"open","issue_type":"task","created_at":"2025-12-22T19:01:05.255965613-05:00","updated_at":"2025-12-22T19:01:05.255965613-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.2","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:05.257395033-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.2","depends_on_id":"ArcataAI-0cn.1","type":"blocks","created_at":"2025-12-22T19:02:05.869426963-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.10","title":"Add WebSocket client for job ingestion in HQ app","description":"Create WebSocket client in apps/hq/src/lib/api.ts\n\nTypes:\ninterface ProgressUpdate {\n  step: number;\n  totalSteps: number;  // Dynamic: 7 for new, 3 for existing\n  status: 'checking' | 'fetching' | 'parsing' | 'resolving' | 'loading' | 'streaming' | 'tracking' | 'complete' | 'error';\n  message: string;\n  jobId?: number;\n  streamId?: number;\n  applicationId?: number;\n  error?: string;\n}\n\nFunction:\ningestJobWithProgress(\n  request: IngestJobRequest,\n  token: string,\n  onProgress: (update: ProgressUpdate) =\u003e void\n): Promise\u003cIngestJobResult\u003e\n\nImplementation:\n1. Build WS URL: http-\u003ews, https-\u003ewss conversion\n2. Connect to ${wsUrl}/api/v1/jobs/ingest/ws?token=${token}\n3. On open: send request as JSON\n4. On message: parse ProgressUpdate, call onProgress\n   - UI uses totalSteps to know how many dots to render\n5. On 'complete': resolve promise with success data\n6. On 'error': resolve promise with error data\n7. 5 minute timeout - reject if no complete/error received\n8. Clean up WebSocket on completion\n\nKeep REST ingestJob() function as fallback (not used in this flow but available).","status":"open","issue_type":"task","created_at":"2025-12-22T19:40:43.550323531-05:00","updated_at":"2025-12-22T20:12:11.413544734-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.10","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:43.551053073-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.10","depends_on_id":"ArcataAI-0cn.9","type":"blocks","created_at":"2025-12-22T19:41:03.206300117-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.10","depends_on_id":"ArcataAI-0cn.2","type":"blocks","created_at":"2025-12-22T19:41:03.218550778-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.9","title":"Add WebSocket endpoint for job ingestion progress","description":"Add WebSocket endpoint and ProgressEmitter to ETL framework.\n\nPart 1: Create ProgressEmitter trait in framework\n- File: apps/api/src/main/scala/arcata/api/etl/framework/ProgressEmitter.scala\n\ntrait ProgressEmitter:\n  def emit(step: Int, totalSteps: Int, status: String, message: String): Unit\n\nobject ProgressEmitter:\n  val noop: ProgressEmitter = (_, _, _, _) =\u003e ()\n\nPart 2: Update JobIngestionPipeline to accept ProgressEmitter\n- Add optional progressEmitter parameter\n- Emit progress before each step\n- totalSteps is dynamic: 7 for new job, 3 for existing job\n\nNew job flow:\n1. 'checking' - 'Looking up job...'\n2. 'fetching' - 'Getting job page...'\n3. 'parsing' - 'Extracting job details...'\n4. 'resolving' - 'Finding company...'\n5. 'loading' - 'Creating job record...'\n6. 'streaming' - 'Adding to your feed...'\n7. 'tracking' - 'Creating application...' (if enabled)\n\nExisting job flow:\n1. 'checking' - 'Looking up job...' (found!)\n2. 'streaming' - 'Adding to your feed...'\n3. 'tracking' - 'Creating application...' (if enabled)\n\n- Emit 'complete' or 'error' at end\n\nPart 3: Create WebSocket endpoint\n- File: apps/api/src/main/scala/arcata/api/http/routes/JobRoutes.scala\n- Endpoint: /api/v1/jobs/ingest/ws?token=xxx\n\nProgress message format:\n{ \"step\": 1, \"totalSteps\": 7, \"status\": \"checking\", \"message\": \"Looking up job...\" }\n{ \"step\": 7, \"totalSteps\": 7, \"status\": \"complete\", \"jobId\": 123, \"streamId\": 456, \"applicationId\": 789 }\n{ \"step\": 2, \"totalSteps\": 7, \"status\": \"error\", \"error\": \"Failed to fetch page\" }\n\nServer closes connection after complete/error.","status":"open","issue_type":"task","created_at":"2025-12-22T19:40:36.577884921-05:00","updated_at":"2025-12-22T20:12:01.037772408-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.9","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:36.57867964-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.9","depends_on_id":"ArcataAI-732.8","type":"blocks","created_at":"2025-12-22T20:08:35.649687826-05:00","created_by":"daemon"}]}
