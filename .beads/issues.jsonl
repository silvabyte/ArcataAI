{"id":"ArcataAI-0cn","title":"Job URL Submission Flow - End-to-end integration","description":"Epic: Connect HQ UI to Scala API for job URL submission. User submits URL -\u003e API processes via ETL pipeline -\u003e job appears in stream/tracker. Includes: API client, route action, notifications, side panel, data revalidation.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-22T19:00:46.272951981-05:00","updated_at":"2025-12-22T21:58:02.225701242-05:00","closed_at":"2025-12-22T21:58:02.225701242-05:00"}
{"id":"ArcataAI-0cn.1","title":"Add VITE_API_URL environment variable","description":"Add VITE_API_URL to apps/hq environment config. Default: http://localhost:4203 for local dev. Update .env.example at root with this new variable. This enables the HQ frontend to call the Scala API.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:00:54.918743025-05:00","updated_at":"2025-12-22T20:23:58.524224551-05:00","closed_at":"2025-12-22T20:23:58.524224551-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.1","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:00:54.919422872-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.10","title":"Add WebSocket client for job ingestion in HQ app","description":"Create WebSocket client in apps/hq/src/lib/api.ts\n\nTypes:\ninterface ProgressUpdate {\n  step: number;\n  totalSteps: number;  // Dynamic: 7 for new, 3 for existing\n  status: 'checking' | 'fetching' | 'parsing' | 'resolving' | 'loading' | 'streaming' | 'tracking' | 'complete' | 'error';\n  message: string;\n  jobId?: number;\n  streamId?: number;\n  applicationId?: number;\n  error?: string;\n}\n\nFunction:\ningestJobWithProgress(\n  request: IngestJobRequest,\n  token: string,\n  onProgress: (update: ProgressUpdate) =\u003e void\n): Promise\u003cIngestJobResult\u003e\n\nImplementation:\n1. Build WS URL: http-\u003ews, https-\u003ewss conversion\n2. Connect to ${wsUrl}/api/v1/jobs/ingest/ws?token=${token}\n3. On open: send request as JSON\n4. On message: parse ProgressUpdate, call onProgress\n   - UI uses totalSteps to know how many dots to render\n5. On 'complete': resolve promise with success data\n6. On 'error': resolve promise with error data\n7. 5 minute timeout - reject if no complete/error received\n8. Clean up WebSocket on completion\n\nKeep REST ingestJob() function as fallback (not used in this flow but available).","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:40:43.550323531-05:00","updated_at":"2025-12-22T21:55:15.292326077-05:00","closed_at":"2025-12-22T21:55:15.292326077-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.10","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:43.551053073-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.10","depends_on_id":"ArcataAI-0cn.9","type":"blocks","created_at":"2025-12-22T19:41:03.206300117-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.10","depends_on_id":"ArcataAI-0cn.2","type":"blocks","created_at":"2025-12-22T19:41:03.218550778-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.11","title":"Create IngestionProgress component with step indicators","description":"Create apps/hq/src/routes/jobs/IngestionProgress.tsx\n\nProps:\ninterface IngestionProgressProps {\n  status: 'processing' | 'success' | 'error';\n  currentStep: number;\n  totalSteps: number;  // Dynamic! 7 for new job, 3 for existing\n  stepName: string;\n  error?: string;\n}\n\nSteps for NEW job (totalSteps=7):\n1. Checking - Looking up job...\n2. Fetching - Getting job page... (HtmlFetcher)\n3. Parsing - Extracting job details... (JobParser)\n4. Resolving - Finding company... (CompanyResolver)\n5. Loading - Creating job record... (JobLoader)\n6. Streaming - Adding to your feed... (StreamLoader)\n7. Tracking - Creating application... (ApplicationLoader, if enabled)\n\nSteps for EXISTING job (totalSteps=3):\n1. Checking - Looking up job... (found!)\n2. Streaming - Adding to your feed...\n3. Tracking - Creating application...\n\nUI: Horizontal dots progress indicator\n- Shows step name with animated dots: 'Checking...' -\u003e 'Fetching...' etc\n- Complete steps: solid indigo dot\n- Current step: indigo dot with pulsing ring\n- Upcoming steps: gray dot\n- 'Step X of Y' label (Y is dynamic)\n\nOn error: Show which step failed with error message\nOn success: Show all dots complete briefly, then transition\n\nThis component replaces 'Add Job' button in HQ header while processing.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:40:50.747883196-05:00","updated_at":"2025-12-22T20:33:39.610542757-05:00","closed_at":"2025-12-22T20:33:39.610542757-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.11","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:50.748443117-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.12","title":"Hoist job ingestion state to HQ.tsx","description":"Move job ingestion state management to HQ.tsx\n\nState:\ninterface IngestionState {\n  status: 'idle' | 'processing' | 'success' | 'error';\n  currentStep: number;  // 0 when idle, 1-6 during processing\n  stepName: string;     // 'Fetching', 'Parsing', etc.\n  jobId?: number;\n  streamId?: number;\n  applicationId?: number;\n  error?: string;\n}\n\nStep name mapping:\n1: 'Fetching'\n2: 'Parsing'\n3: 'Resolving'\n4: 'Loading'\n5: 'Streaming'\n6: 'Tracking'\n\nFlow in HQ.tsx:\n1. handleSubmitJob(url) called from AddJobPopover\n2. Set status='processing', step=1\n3. Call ingestJobWithProgress() with onProgress callback\n4. onProgress updates currentStep and stepName as server emits\n5. On complete: set status='success', wait 1s, open JobDetailPanel, reset to idle\n6. On error: set status='error' with error message, require manual dismiss\n\nHeader rendering:\n- idle: show AddJobPopover\n- processing: show IngestionProgress with step/stepName\n- success: show IngestionProgress with all complete (brief)\n- error: show IngestionProgress with error + X dismiss button\n\nRevalidate data immediately on success.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:40:57.987426268-05:00","updated_at":"2025-12-22T21:58:02.211363611-05:00","closed_at":"2025-12-22T21:58:02.211363611-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:57.988193644-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.10","type":"blocks","created_at":"2025-12-22T19:41:03.230136292-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.11","type":"blocks","created_at":"2025-12-22T19:41:03.242665376-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.4","type":"blocks","created_at":"2025-12-22T19:41:03.254602896-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.12","depends_on_id":"ArcataAI-0cn.13","type":"blocks","created_at":"2025-12-22T19:41:29.414259601-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.13","title":"Simplify AddJobPopover to just collect URL","description":"Simplify apps/hq/src/routes/jobs/AddJobByUrl.tsx\n\nRemove:\n- Route action (no longer needed)\n- useFetcher (parent handles submission)\n- Success/error handling in component\n\nAddJobPopover now just:\n- Renders popover with URL input\n- Validates URL with joi\n- Calls onSubmit(url) prop and closes popover\n- Parent (HQ.tsx) handles the rest\n\nProps:\ninterface AddJobPopoverProps {\n  actuator: ReactNode;\n  onSubmit: (url: string) =\u003e void;\n  disabled?: boolean;\n}","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:41:25.86427536-05:00","updated_at":"2025-12-22T20:36:42.996734738-05:00","closed_at":"2025-12-22T20:36:42.996734738-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.13","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:41:25.864908144-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.2","title":"Create API client for Scala backend","description":"Create apps/hq/src/lib/api.ts with typed API client. Based on OpenAPI spec:\n\nTypes:\n- IngestJobRequest: { url: string, source?: string, createApplication?: boolean, notes?: string }\n- IngestJobResponse: { success: boolean, jobId: number, streamId?: number, applicationId?: number, message: string }\n- JobErrorResponse: { success: boolean, error: string, details?: string }\n\nFunctions:\n- getApiUrl(): string - reads VITE_API_URL from env\n- ingestJob(request: IngestJobRequest, token: string): Promise\u003cIngestJobResponse\u003e\n  - POST to /api/v1/jobs/ingest\n  - Authorization: Bearer \u003ctoken\u003e\n  - Content-Type: application/json\n  - Handle errors, return typed response","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:01:05.255965613-05:00","updated_at":"2025-12-22T21:40:45.901879253-05:00","closed_at":"2025-12-22T21:40:45.901879253-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.2","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:05.257395033-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.2","depends_on_id":"ArcataAI-0cn.1","type":"blocks","created_at":"2025-12-22T19:02:05.869426963-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.3","title":"Create Notification component","description":"Create libs/components/src/lib/notifications/Notification.tsx\n\nFeatures:\n- Toast-style notification with Transition animation\n- States: loading (spinner), success (CheckCircleIcon), error (XCircleIcon)\n- Auto-dismiss after configurable timeout (default 5s for success)\n- Manual dismiss via X button\n- Props: { show, onClose, title, message, variant: 'loading' | 'success' | 'error' }\n\nAlso create NotificationProvider context for global notifications:\n- useNotification() hook returns { notify, dismiss }\n- Renders notification portal at document root\n\nExport from libs/components/src/index.ts","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:01:14.422937459-05:00","updated_at":"2025-12-22T20:27:07.24628079-05:00","closed_at":"2025-12-22T20:27:07.24628079-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.3","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:14.42387003-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.4","title":"Create JobDetailPanel side panel component","description":"Create apps/hq/src/routes/jobs/JobDetailPanel.tsx\n\nStubbed side panel using HeadlessUI Dialog that slides in from right (max-w-2xl).\n\nProps:\n- isOpen: boolean\n- onClose: () =\u003e void  \n- jobId: number | null\n- jobData?: { title: string, company: string, url: string } (optional, for immediate display)\n\nContent (stubbed):\n- Header with job title and close button\n- Company name\n- Link to original job posting\n- Placeholder sections for: Job Description, Requirements, Match Score, Notes\n- Footer with action buttons (placeholder)\n\nThis is a stub - full implementation comes later.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:01:23.666755521-05:00","updated_at":"2025-12-22T20:30:50.982982806-05:00","closed_at":"2025-12-22T20:30:50.982982806-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.4","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:23.667547567-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.5","title":"Update AddJobByUrl action to call real API","description":"Update apps/hq/src/routes/jobs/AddJobByUrl.tsx action function:\n\n1. Get session token from Supabase auth (getSession from @arcata/db)\n2. Call ingestJob() from api.ts with URL and token\n3. Return response shape: { success, error, jobId, streamId, message }\n\nThe action now:\n- Validates URL with joi (existing)\n- Gets auth token\n- Calls Scala API\n- Returns structured response for UI to consume\n\nError handling:\n- No session -\u003e return { success: false, error: 'Not authenticated' }\n- API error -\u003e return { success: false, error: response.error, details: response.details }\n- Network error -\u003e return { success: false, error: 'Network error' }","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:01:32.942779508-05:00","updated_at":"2025-12-22T19:41:14.890832914-05:00","closed_at":"2025-12-22T19:41:14.890832914-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.5","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:32.943702419-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.5","depends_on_id":"ArcataAI-0cn.2","type":"blocks","created_at":"2025-12-22T19:02:05.888458325-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.6","title":"Update AddJobPopover UI for processing states","description":"Update apps/hq/src/routes/jobs/AddJobByUrl.tsx AddJobPopover component:\n\n1. Track submission state via fetcher.state ('idle', 'submitting', 'loading')\n2. Show notification on submit start (loading state)\n3. On success:\n   - Show success notification\n   - Close popover\n   - Trigger data revalidation (useRevalidator or navigate with replace)\n   - Open JobDetailPanel with returned jobId\n4. On error:\n   - Show error notification with message\n   - Keep popover open for retry\n\nState management:\n- Use useState for panel visibility: [panelJobId, setPanelJobId]\n- Use useEffect to react to fetcher.data changes\n\nButton states:\n- Disabled during submission\n- Shows spinner or 'Processing...' text","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:01:42.782527837-05:00","updated_at":"2025-12-22T19:41:19.147317085-05:00","closed_at":"2025-12-22T19:41:19.147317085-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:42.783256921-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn.3","type":"blocks","created_at":"2025-12-22T19:02:05.906980281-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn.4","type":"blocks","created_at":"2025-12-22T19:02:05.924932055-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.6","depends_on_id":"ArcataAI-0cn.5","type":"blocks","created_at":"2025-12-22T19:02:05.942032206-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.7","title":"Integrate NotificationProvider into HQ app","description":"Wrap HQ app with NotificationProvider:\n\n1. Update apps/hq/src/main.tsx or App.tsx to include NotificationProvider\n2. Ensure notification portal renders at document root level\n3. Test that useNotification() hook works from AddJobByUrl component\n\nThis enables global toast notifications across the HQ app.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T19:01:50.169569164-05:00","updated_at":"2025-12-22T21:40:45.920010516-05:00","closed_at":"2025-12-22T21:40:45.920010516-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.7","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:50.17029457-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.7","depends_on_id":"ArcataAI-0cn.3","type":"blocks","created_at":"2025-12-22T19:02:05.960462454-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.8","title":"Add translations for job submission flow","description":"Add translation keys to apps/hq/public/locales/en.json\n\npages.hq.notifications:\n  processing: 'Processing job URL...'\n  success: 'Job added successfully'\n  error: 'Failed to add job'\n\npages.hq.ingestion:\n  stepOf: 'Step {{current}} of {{total}}'\n  steps:\n    fetching: 'Fetching'\n    parsing: 'Parsing'\n    resolving: 'Resolving'\n    loading: 'Loading'\n    streaming: 'Streaming'\n    tracking: 'Tracking'\n  errorAt: 'Failed at {{step}}'\n  errorRetry: 'Something went wrong. Try adding the job again.'\n\npages.hq.jobDetail:\n  title: 'Job Details'\n  apply: 'Apply'\n  department: 'Department'\n  location: 'Location'\n  jobUrl: 'Job URL'\n  description: 'Description'\n  qualifications: 'Qualifications'\n  responsibilities: 'Responsibilities'\n  loading: 'Loading job details...'","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T19:01:58.396826488-05:00","updated_at":"2025-12-22T21:40:45.938090919-05:00","closed_at":"2025-12-22T21:40:45.938090919-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.8","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:01:58.397677379-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0cn.9","title":"Add WebSocket endpoint for job ingestion progress","description":"Add WebSocket endpoint and ProgressEmitter to ETL framework.\n\nPart 1: Create ProgressEmitter trait in framework\n- File: apps/api/src/main/scala/arcata/api/etl/framework/ProgressEmitter.scala\n\ntrait ProgressEmitter:\n  def emit(step: Int, totalSteps: Int, status: String, message: String): Unit\n\nobject ProgressEmitter:\n  val noop: ProgressEmitter = (_, _, _, _) =\u003e ()\n\nPart 2: Update JobIngestionPipeline to accept ProgressEmitter\n- Add optional progressEmitter parameter\n- Emit progress before each step\n- totalSteps is dynamic: 7 for new job, 3 for existing job\n\nNew job flow:\n1. 'checking' - 'Looking up job...'\n2. 'fetching' - 'Getting job page...'\n3. 'parsing' - 'Extracting job details...'\n4. 'resolving' - 'Finding company...'\n5. 'loading' - 'Creating job record...'\n6. 'streaming' - 'Adding to your feed...'\n7. 'tracking' - 'Creating application...' (if enabled)\n\nExisting job flow:\n1. 'checking' - 'Looking up job...' (found!)\n2. 'streaming' - 'Adding to your feed...'\n3. 'tracking' - 'Creating application...' (if enabled)\n\n- Emit 'complete' or 'error' at end\n\nPart 3: Create WebSocket endpoint\n- File: apps/api/src/main/scala/arcata/api/http/routes/JobRoutes.scala\n- Endpoint: /api/v1/jobs/ingest/ws?token=xxx\n\nProgress message format:\n{ \"step\": 1, \"totalSteps\": 7, \"status\": \"checking\", \"message\": \"Looking up job...\" }\n{ \"step\": 7, \"totalSteps\": 7, \"status\": \"complete\", \"jobId\": 123, \"streamId\": 456, \"applicationId\": 789 }\n{ \"step\": 2, \"totalSteps\": 7, \"status\": \"error\", \"error\": \"Failed to fetch page\" }\n\nServer closes connection after complete/error.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T19:40:36.577884921-05:00","updated_at":"2025-12-22T21:53:27.180949854-05:00","closed_at":"2025-12-22T21:53:27.180949854-05:00","dependencies":[{"issue_id":"ArcataAI-0cn.9","depends_on_id":"ArcataAI-0cn","type":"parent-child","created_at":"2025-12-22T19:40:36.57867964-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-0cn.9","depends_on_id":"ArcataAI-732.8","type":"blocks","created_at":"2025-12-22T20:08:35.649687826-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-0y4","title":"Create docs/architecture.md","description":"Create high-level architecture documentation with ASCII system diagram showing: Auth (:4200), HQ (:4201), API (:4203), Supabase, ObjectStorage, BoogieLoops. Include component descriptions, shared libraries table, and external services table with links to ObjectStorage and BoogieLoops repos.","status":"closed","priority":0,"issue_type":"chore","created_at":"2025-12-22T18:40:06.211440628-05:00","updated_at":"2025-12-22T18:41:42.569010098-05:00","closed_at":"2025-12-22T18:41:42.569010098-05:00"}
{"id":"ArcataAI-330","title":"Refactor auth module to be self-contained","description":"Extract auth decorator from JobRoutes into a self-contained auth module that owns its own config. Support multiple auth types (JWT, API keys) with clean decorator API: @authenticated(Vector(AuthType.JWT, AuthType.ApiKey))","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-23T10:59:46.437279259-05:00","updated_at":"2025-12-23T11:09:01.270517247-05:00","closed_at":"2025-12-23T11:09:01.270517247-05:00"}
{"id":"ArcataAI-330.1","title":"Create AuthConfig.scala - self-contained config singleton","description":"Create auth/AuthConfig.scala that lazy-loads auth config from environment variables (SUPABASE_JWT_SECRET, API_KEYS). The auth module should own its configuration, not receive it from ApiApp.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:59:50.844131691-05:00","updated_at":"2025-12-23T11:01:19.94994637-05:00","closed_at":"2025-12-23T11:01:19.94994637-05:00","dependencies":[{"issue_id":"ArcataAI-330.1","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T10:59:50.844772592-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-330.2","title":"Create AuthTypes.scala - enums and result types","description":"Create auth/AuthTypes.scala with: AuthType enum (JWT, ApiKey), AuthResult sealed trait (Success, Failure), updated AuthenticatedRequest case class with authType field.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:59:55.219307288-05:00","updated_at":"2025-12-23T11:01:36.690575251-05:00","closed_at":"2025-12-23T11:01:36.690575251-05:00","dependencies":[{"issue_id":"ArcataAI-330.2","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T10:59:55.219893974-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-330.3","title":"Create ApiKeyValidator.scala","description":"Create auth/ApiKeyValidator.scala that validates X-API-Key header against configured API keys from AuthConfig.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:59:59.163152032-05:00","updated_at":"2025-12-23T11:01:52.41879436-05:00","closed_at":"2025-12-23T11:01:52.41879436-05:00","dependencies":[{"issue_id":"ArcataAI-330.3","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T10:59:59.163783465-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-330.4","title":"Rewrite AuthDecorators.scala with authenticated decorator","description":"Rewrite auth/AuthDecorators.scala with the 'authenticated' RawDecorator class. Should accept allowedTypes: Vector[AuthType] param (default JWT only). Try each auth type until success. Pass authReq to handler.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T11:00:04.258061154-05:00","updated_at":"2025-12-23T11:02:20.445760592-05:00","closed_at":"2025-12-23T11:02:20.445760592-05:00","dependencies":[{"issue_id":"ArcataAI-330.4","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T11:00:04.258630726-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-330.4","depends_on_id":"ArcataAI-330.1","type":"blocks","created_at":"2025-12-23T11:00:24.51928749-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-330.4","depends_on_id":"ArcataAI-330.2","type":"blocks","created_at":"2025-12-23T11:00:24.532914977-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-330.4","depends_on_id":"ArcataAI-330.3","type":"blocks","created_at":"2025-12-23T11:00:24.544900217-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-330.5","title":"Update JobRoutes.scala to use new auth decorator","description":"Remove jwtValidator param from JobRoutes constructor. Remove inner 'authenticated' class. Import and use @authenticated() decorator from auth package. Update handler param name to authReq.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T11:00:08.282910336-05:00","updated_at":"2025-12-23T11:03:49.201528131-05:00","closed_at":"2025-12-23T11:03:49.201528131-05:00","dependencies":[{"issue_id":"ArcataAI-330.5","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T11:00:08.283703354-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-330.5","depends_on_id":"ArcataAI-330.4","type":"blocks","created_at":"2025-12-23T11:00:28.206587545-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-330.6","title":"Update ApiApp.scala - remove jwtValidator wiring","description":"Remove 'lazy val jwtValidator' from ApiApp. Remove jwtValidator param from JobRoutes instantiation. Auth module now owns its config.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T11:00:11.734822637-05:00","updated_at":"2025-12-23T11:04:28.21419692-05:00","closed_at":"2025-12-23T11:04:28.21419692-05:00","dependencies":[{"issue_id":"ArcataAI-330.6","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T11:00:11.736265735-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-330.6","depends_on_id":"ArcataAI-330.5","type":"blocks","created_at":"2025-12-23T11:00:28.217909921-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-330.7","title":"Update .env.example with API_KEYS variable","description":"Add API_KEYS environment variable to apps/api/.env.example with documentation comment explaining format (comma-separated).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T11:00:15.657001424-05:00","updated_at":"2025-12-23T11:04:47.758058539-05:00","closed_at":"2025-12-23T11:04:47.758058539-05:00","dependencies":[{"issue_id":"ArcataAI-330.7","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T11:00:15.65758343-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-330.8","title":"Write tests for auth module using utest","description":"Write comprehensive tests for: AuthConfig loading, ApiKeyValidator, authenticated decorator (JWT auth, API key auth, combined auth, failure cases). Use utest library.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T11:00:19.788935565-05:00","updated_at":"2025-12-23T11:09:01.258912285-05:00","closed_at":"2025-12-23T11:09:01.258912285-05:00","dependencies":[{"issue_id":"ArcataAI-330.8","depends_on_id":"ArcataAI-330","type":"parent-child","created_at":"2025-12-23T11:00:19.790250412-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-330.8","depends_on_id":"ArcataAI-330.4","type":"blocks","created_at":"2025-12-23T11:00:31.743922193-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-43a","title":"Remove unused @arcata/envs library","description":"The libs/envs package is declared as a dependency in multiple package.json files but never actually imported in any TypeScript code. Remove the library and all references to it.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-22T19:06:20.886846884-05:00","updated_at":"2025-12-23T08:28:13.974862584-05:00","closed_at":"2025-12-23T08:28:13.974862584-05:00"}
{"id":"ArcataAI-4bh","title":"Wire up JobDetailPanel to fetch and display actual job data after ingestion","description":"After successful job ingestion, the side panel opens but shows placeholder text instead of real job data.\n\n**Current behavior (HQ.tsx:100-108):**\n- Sets hardcoded: `{ title: 'New Job', company: '', url: '' }`\n- Panel shows 'Job description will appear here', etc.\n\n**Expected:**\n- Fetch job details from API using the jobId\n- Display actual title, description, requirements, company name\n- Show the extracted data from the ingestion pipeline\n\n**Files:**\n- apps/hq/src/routes/hq/HQ.tsx (line 104)\n- apps/hq/src/routes/jobs/JobDetailPanel.tsx","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:17:41.867715263-05:00","updated_at":"2025-12-27T12:34:52.504371059-05:00","closed_at":"2025-12-27T12:34:52.504371059-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-4bh","depends_on_id":"ArcataAI-eh7","type":"related","created_at":"2025-12-23T15:59:34.849726223-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-4ll","title":"Integrate Shadcn Kanban into HQ","description":"Replace custom KanbanLane with the new Shadcn Kanban component from @arcata/components. Enable drag-and-drop for job applications between status columns with optimistic updates and database persistence.\n\n## Components\n- KanbanProvider: Manages DnD state, wraps the board\n- KanbanBoard: Droppable column container  \n- KanbanCards: Renders cards in a column with SortableContext\n- KanbanCard: Draggable card with drag overlay support\n- KanbanHeader: Column header\n\n## Data Model Mapping\n- KanbanItemProps.id -\u003e string(application_id)\n- KanbanItemProps.column -\u003e string(status_id)\n- KanbanItemProps.name -\u003e job title or company\n- KanbanColumnProps.id -\u003e string(status_id)\n- KanbanColumnProps.name -\u003e status name\n\n## Key Tasks\n1. Fix kanban imports (already done)\n2. Add exports to @arcata/components (already done)\n3. Create adapter types/mappers in HQ\n4. Replace board implementation with KanbanProvider\n5. Implement persistence on drag end\n6. Polish card UI with job details\n7. Clean up old KanbanLane component","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-26T15:44:58.61698218-05:00","updated_at":"2025-12-26T18:08:06.727402253-05:00","closed_at":"2025-12-26T18:08:06.727402253-05:00"}
{"id":"ArcataAI-4ll.1","title":"Create Kanban adapter types and mappers","description":"Create TypeScript types that extend KanbanItemProps and KanbanColumnProps, carrying the full domain objects.\n\n## Step 1: Add Joined Types to @arcata/db\n\nAdd to `libs/db/src/lib/resourceTypes.ts`:\n\n```typescript\n// === Joined Types (for queries with relations) ===\n\n/** Job with nested company data */\nexport type JobWithCompany = Job \u0026 {\n  companies: Company | null;\n};\n\n/** JobApplication with nested job and company data */\nexport type JobApplicationWithJob = JobApplication \u0026 {\n  jobs: JobWithCompany | null;\n};\n```\n\n## Step 2: Create Kanban Adapter Types\n\nCreate `apps/hq/src/routes/hq/kanban/types.ts`:\n\n```typescript\nimport type { KanbanItemProps, KanbanColumnProps } from '@arcata/components';\nimport type { JobApplicationWithJob, ApplicationStatus } from '@arcata/db';\n\n// === Card Type ===\n// Satisfies Shadcn's required shape + carries full application record\nexport type KanbanApplication = KanbanItemProps \u0026 {\n  application: JobApplicationWithJob;\n};\n\n// === Column Type ===\n// Satisfies Shadcn's required shape + carries full status record\nexport type KanbanStatus = KanbanColumnProps \u0026 {\n  status: ApplicationStatus;\n};\n\n// === Mappers ===\n\nexport function toKanbanApplication(app: JobApplicationWithJob): KanbanApplication {\n  return {\n    // Required by Shadcn KanbanItemProps\n    id: String(app.application_id),\n    name: app.jobs?.title ?? 'Unknown',\n    column: String(app.status_id),\n    // Full domain data\n    application: app,\n  };\n}\n\nexport function toKanbanStatus(status: ApplicationStatus): KanbanStatus {\n  return {\n    // Required by Shadcn KanbanColumnProps\n    id: String(status.status_id),\n    name: status.name,\n    // Full domain data\n    status,\n  };\n}\n```\n\n## Files\n\n1. Modify: `libs/db/src/lib/resourceTypes.ts` - Add `JobWithCompany` and `JobApplicationWithJob`\n2. Create: `apps/hq/src/routes/hq/kanban/types.ts` - Kanban adapter types and mappers\n\n## Why This Approach\n\n- **No data duplication** - Don't flatten fields that already exist in `application`\n- **Full access** - Card component can access any field via `item.application.jobs?.title` etc.\n- **Single source of truth** - Joined types live in `@arcata/db` where all DB types are defined\n- **Type safety** - TypeScript knows exact shape through nested structure","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:45:12.125714265-05:00","updated_at":"2025-12-26T17:42:37.885650716-05:00","closed_at":"2025-12-26T17:42:37.885655144-05:00","dependencies":[{"issue_id":"ArcataAI-4ll.1","depends_on_id":"ArcataAI-4ll","type":"parent-child","created_at":"2025-12-26T15:45:12.126320304-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-4ll.2","title":"Replace HQ board with KanbanProvider","description":"Replace the manual board implementation in HQ.tsx with KanbanProvider from @arcata/components.\n\n## Changes to HQ.tsx\n\n### 1. Import kanban components\n\n```typescript\nimport {\n  KanbanProvider,\n  KanbanBoard,\n  KanbanCards,\n  KanbanCard,\n  KanbanHeader,\n} from '@arcata/components';\nimport { \n  toKanbanApplication, \n  toKanbanStatus, \n  type KanbanApplication,\n  type KanbanStatus,\n} from './kanban/types';\n```\n\n### 2. Transform data with useMemo\n\n```typescript\nconst kanbanColumns = useMemo(\n  () =\u003e statuses.map(toKanbanStatus),\n  [statuses]\n);\n\nconst kanbanDataFromServer = useMemo(\n  () =\u003e applications.map(toKanbanApplication),\n  [applications]\n);\n```\n\n### 3. Local state for optimistic updates\n\n```typescript\nconst [localKanbanData, setLocalKanbanData] = useState\u003cKanbanApplication[]\u003e([]);\nconst [savingIds, setSavingIds] = useState\u003cSet\u003cstring\u003e\u003e(new Set());\n\n// Sync from server when data changes\nuseEffect(() =\u003e {\n  setLocalKanbanData(kanbanDataFromServer);\n}, [kanbanDataFromServer]);\n```\n\n### 4. Handle data changes (optimistic)\n\n```typescript\nconst handleDataChange = useCallback((newData: KanbanApplication[]) =\u003e {\n  // Find what changed\n  const changed = findChangedItem(localKanbanData, newData);\n  \n  if (changed) {\n    // Mark as saving (shows spinner)\n    setSavingIds(prev =\u003e new Set(prev).add(changed.id));\n    \n    // Optimistic update\n    setLocalKanbanData(newData);\n    \n    // Persist (Task 3 handles this)\n    persistChange(changed, newData)\n      .finally(() =\u003e {\n        setSavingIds(prev =\u003e {\n          const next = new Set(prev);\n          next.delete(changed.id);\n          return next;\n        });\n      });\n  }\n}, [localKanbanData]);\n```\n\n### 5. Replace board JSX\n\n**Before:**\n```tsx\n\u003cdiv className=\"flex h-full gap-3\"\u003e\n  {boardData.map(({ status, apps }) =\u003e (\n    \u003cKanbanLane\n      title={status.name}\n      count={apps.length}\n      statusId={status.status_id}\n      onRename={handleRenameStatus}\n    \u003e\n      {apps.map((a) =\u003e \u003cdiv key={a.application_id}\u003e{a.job_id}\u003c/div\u003e)}\n    \u003c/KanbanLane\u003e\n  ))}\n\u003c/div\u003e\n```\n\n**After:**\n```tsx\n\u003cKanbanProvider\n  columns={kanbanColumns}\n  data={localKanbanData}\n  onDataChange={handleDataChange}\n\u003e\n  {(column: KanbanStatus) =\u003e (\n    \u003cKanbanBoard id={column.id} key={column.id}\u003e\n      \u003cKanbanHeader\u003e\n        \u003cEditableText\n          value={column.name}\n          onSave={(newName) =\u003e handleRenameStatus(column.status.status_id, newName)}\n          className=\"font-semibold text-2xl text-white\"\n        /\u003e\n        \u003cspan className=\"text-4xl text-white font-extralight\"\u003e\n          {localKanbanData.filter(d =\u003e d.column === column.id).length}\n        \u003c/span\u003e\n      \u003c/KanbanHeader\u003e\n      \u003cKanbanCards id={column.id}\u003e\n        {(item: KanbanApplication) =\u003e (\n          \u003cJobCard\n            key={item.id}\n            item={item}\n            isSaving={savingIds.has(item.id)}\n            columnIndex={kanbanColumns.findIndex(c =\u003e c.id === item.column)}\n            totalColumns={kanbanColumns.length}\n            onViewDetails={...}\n            onRemove={...}\n          /\u003e\n        )}\n      \u003c/KanbanCards\u003e\n    \u003c/KanbanBoard\u003e\n  )}\n\u003c/KanbanProvider\u003e\n```\n\n### 6. Refresh icon spinner on cards\n\nPass `isSaving` to JobCard component. When true, show the refresh icon with `animate-spin` class:\n\n```tsx\n// In JobCard.tsx\n{isSaving ? (\n  \u003cRefreshIcon className=\"h-4 w-4 animate-spin\" /\u003e\n) : (\n  \u003cDropdownMenu\u003e...\u003c/DropdownMenu\u003e\n)}\n```\n\n## Files\n\n- Modify: `apps/hq/src/routes/hq/HQ.tsx`\n\n## Depends On\n\n- ArcataAI-4ll.1 (adapter types)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:45:28.721884339-05:00","updated_at":"2025-12-26T17:50:14.170945752-05:00","closed_at":"2025-12-26T17:50:14.1709498-05:00","dependencies":[{"issue_id":"ArcataAI-4ll.2","depends_on_id":"ArcataAI-4ll","type":"parent-child","created_at":"2025-12-26T15:45:28.722611465-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-4ll.2","depends_on_id":"ArcataAI-4ll.1","type":"blocks","created_at":"2025-12-26T15:45:34.370026742-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-4ll.3","title":"Implement drag-and-drop persistence","description":"Persist status and order changes to Supabase when cards are dragged.\n\n## Ordering Strategy: Sparse\n\nUse large gaps (1000) between cards. When inserting:\n- **Between cards:** Use midpoint (e.g., between 1000 and 2000 ‚Üí 1500)\n- **At end:** lastOrder + 1000\n- **At beginning:** firstOrder - 1000 (or 0 if first card)\n\nOnly update the **moved card** - no need to update siblings.\n\n## Implementation\n\n### 1. Calculate new order\n\n```typescript\n// apps/hq/src/routes/hq/kanban/orderUtils.ts\n\nconst ORDER_GAP = 1000;\n\nexport function calculateNewOrder(\n  siblings: KanbanApplication[],  // Cards in destination column, sorted by status_order\n  insertIndex: number\n): number {\n  // Empty column\n  if (siblings.length === 0) return ORDER_GAP;\n  \n  // Insert at beginning\n  if (insertIndex === 0) {\n    const firstOrder = siblings[0].application.status_order;\n    return Math.max(0, firstOrder - ORDER_GAP);\n  }\n  \n  // Insert at end\n  if (insertIndex \u003e= siblings.length) {\n    const lastOrder = siblings[siblings.length - 1].application.status_order;\n    return lastOrder + ORDER_GAP;\n  }\n  \n  // Insert between\n  const before = siblings[insertIndex - 1].application.status_order;\n  const after = siblings[insertIndex].application.status_order;\n  return Math.floor((before + after) / 2);\n}\n```\n\n### 2. Persist change function\n\n```typescript\n// In HQ.tsx\n\nconst { notify } = useNotification();\n\nconst persistChange = useCallback(async (\n  movedItem: KanbanApplication,\n  newData: KanbanApplication[],\n) =\u003e {\n  const newStatusId = Number(movedItem.column);\n  \n  // Get siblings in destination column (excluding moved item)\n  const siblings = newData\n    .filter(d =\u003e d.column === movedItem.column \u0026\u0026 d.id !== movedItem.id)\n    .sort((a, b) =\u003e a.application.status_order - b.application.status_order);\n  \n  // Find where moved item landed\n  const insertIndex = newData\n    .filter(d =\u003e d.column === movedItem.column)\n    .findIndex(d =\u003e d.id === movedItem.id);\n  \n  const newOrder = calculateNewOrder(siblings, insertIndex);\n  \n  try {\n    await db.job_applications.update(movedItem.application.application_id, {\n      status_id: newStatusId,\n      status_order: newOrder,\n    });\n  } catch (error) {\n    // Show error notification\n    notify(\n      t('pages.hq.kanban.errors.moveFailedTitle'),\n      'error',\n      t('pages.hq.kanban.errors.moveFailedMessage'),\n    );\n    // Revert to server state\n    revalidator.revalidate();\n  }\n}, [notify, revalidator, t]);\n```\n\n### 3. Add translations\n\nAdd to `apps/hq/public/locales/en.json`:\n\n```json\n{\n  \"pages\": {\n    \"hq\": {\n      \"kanban\": {\n        \"errors\": {\n          \"moveFailedTitle\": \"Couldn't move card\",\n          \"moveFailedMessage\": \"Something went wrong. Your board has been refreshed.\"\n        }\n      }\n    }\n  }\n}\n```\n\n## Error Handling Flow\n\n1. Drag card ‚Üí optimistic update + show spinner\n2. API call fails ‚Üí show notification with friendly message\n3. User sees notification, board reverts to server state\n4. User dismisses notification, can retry\n\n## Files\n\n- Create: `apps/hq/src/routes/hq/kanban/orderUtils.ts`\n- Modify: `apps/hq/src/routes/hq/HQ.tsx` (persistChange function)\n- Modify: `apps/hq/public/locales/en.json` (add error messages)\n\n## Depends On\n\n- ArcataAI-4ll.2 (board implementation with optimistic state)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:45:52.889991557-05:00","updated_at":"2025-12-26T17:56:09.19596883-05:00","closed_at":"2025-12-26T17:56:09.195977817-05:00","dependencies":[{"issue_id":"ArcataAI-4ll.3","depends_on_id":"ArcataAI-4ll","type":"parent-child","created_at":"2025-12-26T15:45:52.890512208-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-4ll.3","depends_on_id":"ArcataAI-4ll.2","type":"blocks","created_at":"2025-12-26T15:45:56.971727469-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-4ll.4","title":"Design and implement Kanban card UI","description":"Create the kanban card UI based on design comp.\n\n## Card Anatomy (from design)\n\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Updated 20min ago               ‚ãÆ       ‚îÇ  ‚Üê Header: relative timestamp + menu\n‚îÇ                            (or spinner) ‚îÇ  ‚Üê Shows spinner when isSaving=true\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ Software Engineer III                   ‚îÇ  ‚Üê Job title (bold)\n‚îÇ @ Google Cloud                          ‚îÇ  ‚Üê Company name with @ prefix\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  15% ‚òë        ‚îÇ  ‚Üê Progress bar + completion %\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ üè¢ Mid-level  ‚è± Full-time  üè† Mountain..‚îÇ  ‚Üê Tags: level, type, location\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n## Data Fields\n\n| Field | Source | Notes |\n|-------|--------|-------|\n| Job title | `jobs.title` | Join required |\n| Company name | `companies.company_name` | Join through jobs |\n| Updated timestamp | `job_applications.updated_at` | Relative time (\"20min ago\") |\n| Progress % | Calculated | `Math.floor((columnIndex + 1) / totalColumns * 100)` |\n| Experience level | `jobs.experience_level` | Tag with icon |\n| Job type | `jobs.job_type` | Tag with icon (Fulltime, Contract, etc.) |\n| Location | `jobs.location` | Tag with icon, truncate if long |\n\n## Progress Bar Calculation\n\nSimple formula based on column position:\n```typescript\nconst progress = Math.floor((columnIndex + 1) / totalColumns * 100);\n// Column 1 of 5 = 20%\n// Column 2 of 5 = 40%\n// etc.\n```\n\n## Card Actions Menu (‚ãÆ)\n\n- **Full Job Description** - Opens job detail panel\n- **Remove from Tracking** - Deletes the application\n\n## Step 1: Add DB helper function\n\nCreate `libs/db/src/lib/jobApplications.ts`:\n\n```typescript\nimport supabaseClient from './client';\nimport type { JobApplicationWithJob } from './resourceTypes';\n\n/**\n * Fetch job applications with joined job and company data\n */\nexport async function listApplicationsWithJobs(\n  profileId: string\n): Promise\u003cJobApplicationWithJob[]\u003e {\n  const { data, error } = await supabaseClient\n    .from('job_applications')\n    .select(`\n      *,\n      jobs (\n        title,\n        experience_level,\n        job_type,\n        location,\n        companies (\n          company_name\n        )\n      )\n    `)\n    .eq('profile_id', profileId)\n    .order('status_order', { ascending: true });\n\n  if (error) throw error;\n  return data as JobApplicationWithJob[];\n}\n```\n\nExport from `libs/db/src/index.ts`:\n```typescript\nexport * from './lib/jobApplications';\n```\n\n## Step 2: Update HQ loader\n\nReplace current query in `apps/hq/src/routes/hq/HQ.tsx`:\n\n```typescript\nimport { listApplicationsWithJobs } from '@arcata/db';\n\nexport const loader = async () =\u003e {\n  const user = await getCurrentUser();\n  const [applications, statuses] = await Promise.all([\n    listApplicationsWithJobs(user?.id),  // \u003c-- New helper\n    db.application_statuses.list\u003cApplicationStatus\u003e({\n      eq: { key: 'profile_id', value: user?.id },\n    }),\n  ]);\n  // ...\n};\n```\n\n## Step 3: Create JobCard component\n\nCreate `apps/hq/src/routes/hq/kanban/JobCard.tsx`:\n\n```tsx\nimport { KanbanCard } from '@arcata/components';\nimport type { KanbanApplication } from './types';\n\ntype JobCardProps = {\n  item: KanbanApplication;\n  isSaving: boolean;\n  columnIndex: number;\n  totalColumns: number;\n  onViewDetails: (applicationId: number) =\u003e void;\n  onRemove: (applicationId: number) =\u003e void;\n};\n\nexport function JobCard({\n  item,\n  isSaving,\n  columnIndex,\n  totalColumns,\n  onViewDetails,\n  onRemove,\n}: JobCardProps) {\n  const progress = Math.floor((columnIndex + 1) / totalColumns * 100);\n  const { application } = item;\n  const job = application.jobs;\n  const company = job?.companies;\n\n  return (\n    \u003cKanbanCard id={item.id} name={item.name} column={item.column}\u003e\n      {/* Header */}\n      \u003cdiv className=\"flex items-center justify-between\"\u003e\n        \u003cspan className=\"text-xs text-muted-foreground\"\u003e\n          {formatRelativeTime(application.updated_at)}\n        \u003c/span\u003e\n        {isSaving ? (\n          \u003cRefreshIcon className=\"h-4 w-4 animate-spin\" /\u003e\n        ) : (\n          \u003cDropdownMenu\u003e\n            \u003cDropdownMenuTrigger\u003e\n              \u003cMoreVerticalIcon className=\"h-4 w-4\" /\u003e\n            \u003c/DropdownMenuTrigger\u003e\n            \u003cDropdownMenuContent\u003e\n              \u003cDropdownMenuItem onClick={() =\u003e onViewDetails(application.application_id)}\u003e\n                {t('pages.hq.kanban.actions.viewDetails')}\n              \u003c/DropdownMenuItem\u003e\n              \u003cDropdownMenuItem onClick={() =\u003e onRemove(application.application_id)}\u003e\n                {t('pages.hq.kanban.actions.remove')}\n              \u003c/DropdownMenuItem\u003e\n            \u003c/DropdownMenuContent\u003e\n          \u003c/DropdownMenu\u003e\n        )}\n      \u003c/div\u003e\n\n      {/* Title \u0026 Company */}\n      \u003cp className=\"font-semibold text-sm line-clamp-2\"\u003e{job?.title ?? 'Unknown'}\u003c/p\u003e\n      \u003cp className=\"text-xs text-muted-foreground\"\u003e@ {company?.company_name ?? 'Unknown'}\u003c/p\u003e\n\n      {/* Progress Bar */}\n      \u003cdiv className=\"flex items-center gap-2 mt-2\"\u003e\n        \u003cdiv className=\"flex-1 h-1 bg-muted rounded\"\u003e\n          \u003cdiv\n            className=\"h-full bg-primary rounded transition-all\"\n            style={{ width: `${progress}%` }}\n          /\u003e\n        \u003c/div\u003e\n        \u003cspan className=\"text-xs text-muted-foreground\"\u003e{progress}%\u003c/span\u003e\n      \u003c/div\u003e\n\n      {/* Tags */}\n      \u003cdiv className=\"flex flex-wrap gap-2 mt-2 text-xs text-muted-foreground\"\u003e\n        {job?.experience_level \u0026\u0026 (\n          \u003cspan className=\"flex items-center gap-1\"\u003e\n            \u003cBuildingIcon className=\"h-3 w-3\" /\u003e\n            {job.experience_level}\n          \u003c/span\u003e\n        )}\n        {job?.job_type \u0026\u0026 (\n          \u003cspan className=\"flex items-center gap-1\"\u003e\n            \u003cClockIcon className=\"h-3 w-3\" /\u003e\n            {job.job_type}\n          \u003c/span\u003e\n        )}\n        {job?.location \u0026\u0026 (\n          \u003cspan className=\"flex items-center gap-1\"\u003e\n            \u003cMapPinIcon className=\"h-3 w-3\" /\u003e\n            {truncate(job.location, 12)}\n          \u003c/span\u003e\n        )}\n      \u003c/div\u003e\n    \u003c/KanbanCard\u003e\n  );\n}\n```\n\n## Step 4: Add translations\n\nAdd to `apps/hq/public/locales/en.json`:\n\n```json\n{\n  \"pages\": {\n    \"hq\": {\n      \"kanban\": {\n        \"actions\": {\n          \"viewDetails\": \"Full Job Description\",\n          \"remove\": \"Remove from Tracking\"\n        }\n      }\n    }\n  }\n}\n```\n\n## Files\n\n- Create: `libs/db/src/lib/jobApplications.ts` (helper function)\n- Modify: `libs/db/src/index.ts` (export helper)\n- Create: `apps/hq/src/routes/hq/kanban/JobCard.tsx` (card component)\n- Modify: `apps/hq/src/routes/hq/HQ.tsx` (use new loader helper)\n- Modify: `apps/hq/public/locales/en.json` (add translations)\n- May need: Dropdown menu component from shadcn\n\n## Depends On\n\n- ArcataAI-4ll.2 (board implementation)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-26T15:46:13.101362825-05:00","updated_at":"2025-12-26T18:05:08.694271808-05:00","closed_at":"2025-12-26T18:05:08.694277849-05:00","dependencies":[{"issue_id":"ArcataAI-4ll.4","depends_on_id":"ArcataAI-4ll","type":"parent-child","created_at":"2025-12-26T15:46:13.101992239-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-4ll.4","depends_on_id":"ArcataAI-4ll.2","type":"blocks","created_at":"2025-12-26T15:46:19.001986194-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-4ll.5","title":"Clean up old KanbanLane component","description":"Remove the old KanbanLane component and its CSS after the new implementation is working.\n\n## Files to Delete\n- apps/hq/src/routes/hq/kanban/KanbanLane.tsx\n- apps/hq/src/routes/hq/kanban/KanBanLane.css\n\n## Cleanup\n- Remove unused imports from HQ.tsx\n- Ensure no other components reference KanbanLane\n\n## Verify\n- App builds without errors\n- All kanban functionality works\n- No console warnings about missing files\n\n## Depends On\n- ArcataAI-4ll.3 (persistence working)\n- ArcataAI-4ll.4 (card UI working)","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-26T15:46:27.218119071-05:00","updated_at":"2025-12-26T18:08:06.711668341-05:00","closed_at":"2025-12-26T18:08:06.71167292-05:00","dependencies":[{"issue_id":"ArcataAI-4ll.5","depends_on_id":"ArcataAI-4ll","type":"parent-child","created_at":"2025-12-26T15:46:27.219021992-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-4ll.5","depends_on_id":"ArcataAI-4ll.3","type":"blocks","created_at":"2025-12-26T15:46:32.011265752-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-4ll.5","depends_on_id":"ArcataAI-4ll.4","type":"blocks","created_at":"2025-12-26T15:46:32.023449754-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-59j","title":"Rewrite API tests from munit to utest framework","description":"The API tests are written using munit but build.sc is configured for utest. Need to remove all munit tests and rewrite using proper utest patterns.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:33:41.512606674-05:00","updated_at":"2025-12-23T10:43:08.940859916-05:00","closed_at":"2025-12-23T10:43:08.940859916-05:00"}
{"id":"ArcataAI-59j.1","title":"Remove old munit test files","description":"Delete all 10 existing test files that use munit framework","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:33:47.537565792-05:00","updated_at":"2025-12-23T10:35:02.384038281-05:00","closed_at":"2025-12-23T10:35:02.384038281-05:00","dependencies":[{"issue_id":"ArcataAI-59j.1","depends_on_id":"ArcataAI-59j","type":"parent-child","created_at":"2025-12-23T10:33:47.538145183-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-59j.2","title":"Write DomainModelsSuite using utest","description":"Test domain models (Company, Job, ExtractedJobData, JobStreamEntry, JobApplication) JSON serialization with upickle","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:33:53.443430493-05:00","updated_at":"2025-12-23T10:35:49.885022783-05:00","closed_at":"2025-12-23T10:35:49.885022783-05:00","dependencies":[{"issue_id":"ArcataAI-59j.2","depends_on_id":"ArcataAI-59j","type":"parent-child","created_at":"2025-12-23T10:33:53.444255192-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-59j.3","title":"Write ETL framework tests using utest","description":"Test BaseStep, BasePipeline, PipelineContext, StepError - covers step composition, error handling, context creation","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:33:59.357963835-05:00","updated_at":"2025-12-23T10:36:56.781536674-05:00","closed_at":"2025-12-23T10:36:56.781536674-05:00","dependencies":[{"issue_id":"ArcataAI-59j.3","depends_on_id":"ArcataAI-59j","type":"parent-child","created_at":"2025-12-23T10:33:59.358558396-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-59j.4","title":"Write ETL step tests using utest","description":"Test JobLoader, StreamLoader, ApplicationLoader, CompanyResolver steps with mock SupabaseClient","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:34:05.262610265-05:00","updated_at":"2025-12-23T10:38:14.206352422-05:00","closed_at":"2025-12-23T10:38:14.206352422-05:00","dependencies":[{"issue_id":"ArcataAI-59j.4","depends_on_id":"ArcataAI-59j","type":"parent-child","created_at":"2025-12-23T10:34:05.263504009-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-59j.5","title":"Write ObjectStorageClient tests using utest","description":"Test ObjectStorageClient URL building and API interactions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:34:12.013904889-05:00","updated_at":"2025-12-23T10:38:59.381500889-05:00","closed_at":"2025-12-23T10:38:59.381500889-05:00","dependencies":[{"issue_id":"ArcataAI-59j.5","depends_on_id":"ArcataAI-59j","type":"parent-child","created_at":"2025-12-23T10:34:12.014645464-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-59j.6","title":"Verify all tests pass with utest runner","description":"Run ./mill api.test and ensure all new utest tests pass","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:34:18.534503016-05:00","updated_at":"2025-12-23T10:43:07.717550576-05:00","closed_at":"2025-12-23T10:43:07.717550576-05:00","dependencies":[{"issue_id":"ArcataAI-59j.6","depends_on_id":"ArcataAI-59j","type":"parent-child","created_at":"2025-12-23T10:34:18.535205888-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er","title":"Job Discovery Collector Service","description":"## Overview\n\nCron ETL workflow that iterates through job sources (starting with Greenhouse ATS) and discovers new job postings to ingest into the system. This is a system-level workflow that creates/updates jobs in the global jobs table.\n\n## Architecture\n\n```\nPOST /api/v1/cron/job-discovery  ‚îÄ‚îÄ‚ñ∂  returns 202 + runId\n         ‚îÇ\n         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                JobDiscoveryWorkflow (BaseWorkflow)              ‚îÇ\n‚îÇ  Iterates through JobSourceRegistry, respects rate limits      ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº for each JobSource\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                    JobSource.discoverJobs()                     ‚îÇ\n‚îÇ  e.g., GreenhouseJobSource queries companies table,             ‚îÇ\n‚îÇ        calls Greenhouse API, returns job URLs                   ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº for each job URL (with rate limiting)\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ              JobIngestionPipeline.run(url, \"system\")            ‚îÇ\n‚îÇ  Reuses existing ETL: fetch ‚Üí extract ‚Üí load                    ‚îÇ\n‚îÇ  Deduplicates via normalized source_url                         ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n## JobSource Framework\n\n```scala\n// Easy to contribute new sources - implement this trait\ntrait JobSource:\n  def sourceId: String                    // e.g., \"greenhouse\"\n  def name: String                        // e.g., \"Greenhouse ATS\"\n  def config: JobSourceConfig             // rate limiting config\n  def discoverJobs(supabase: SupabaseClient): Seq[DiscoveredJob]\n\ncase class JobSourceConfig(\n    companyBatchSize: Int = 1,          // companies per run\n    jobsPerCompany: Int = 1,            // jobs per company\n    delayMs: Int = 1000                 // delay between requests\n)\n\nobject JobSourceRegistry:\n  def all: Seq[JobSource] = Seq(GreenhouseJobSource)\n```\n\n## MVP Scope (Alpha)\n\n- Single source: Greenhouse ATS\n- Query companies where company_jobs_source = 'greenhouse'\n- Use Greenhouse JSON API: boards-api.greenhouse.io/v1/boards/{company}/jobs\n- Conservative rate limits: 1 company, 1 job, 1s delay\n- Reuse JobIngestionPipeline for job processing\n\n## Success Criteria\n\n- [ ] Database migration adds company_jobs_source column\n- [ ] JobSource trait and registry implemented\n- [ ] GreenhouseJobSource fetches jobs from API\n- [ ] URL normalization utility for deduplication\n- [ ] JobDiscoveryWorkflow orchestrates the flow\n- [ ] HTTP endpoint triggers workflow async\n- [ ] Tests cover the new components\n- [ ] Documentation updated","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-02T11:08:07.581572949-05:00","updated_at":"2026-01-02T12:27:09.27155563-05:00","closed_at":"2026-01-02T12:27:09.27155563-05:00"}
{"id":"ArcataAI-5er.1","title":"Add company_jobs_source column migration","description":"## Overview\n\nAdd `company_jobs_source` column to the `companies` table to identify which ATS/job board platform a company uses.\n\n## Database Changes\n\n**File:** `supabase/migrations/YYYYMMDDHHMMSS_company_jobs_source.sql`\n\n```sql\n-- Add company_jobs_source column to identify ATS platform\nALTER TABLE companies\nADD COLUMN company_jobs_source TEXT;\n\n-- Add CHECK constraint for valid values\nALTER TABLE companies\nADD CONSTRAINT companies_jobs_source_check\nCHECK (company_jobs_source IS NULL OR company_jobs_source IN (\n  'greenhouse',\n  'lever',\n  'ashby',\n  'workday',\n  'icims',\n  'workable',\n  'custom'\n));\n\n-- Index for efficient filtering by source\nCREATE INDEX companies_jobs_source_idx ON companies(company_jobs_source)\nWHERE company_jobs_source IS NOT NULL;\n\n-- Comment\nCOMMENT ON COLUMN companies.company_jobs_source IS \n  'ATS platform type: greenhouse, lever, ashby, workday, icims, workable, custom';\n```\n\n## Scala Model Update\n\n**File:** `apps/api/src/main/scala/arcata/api/domain/Company.scala`\n\nAdd field to the Company case class:\n```scala\ncompanyJobsSource: Option[String] = None\n```\n\n## Existing Schema Context\n\nThe companies table already has:\n- `company_jobs_url` (TEXT) - stores the ATS job board URL (e.g., https://job-boards.greenhouse.io/temporaltechnologies)\n- No existing ATS type column\n\n## Acceptance Criteria\n\n- [ ] Migration creates column with CHECK constraint\n- [ ] Partial index on non-null values for efficient filtering\n- [ ] Company Scala domain model updated with companyJobsSource field\n- [ ] Run `supabase db reset` to verify migration works\n- [ ] Regenerate TypeScript types if needed","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:08:22.35324064-05:00","updated_at":"2026-01-02T12:19:02.870960895-05:00","closed_at":"2026-01-02T12:19:02.870960895-05:00","dependencies":[{"issue_id":"ArcataAI-5er.1","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:08:22.35395684-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.2","title":"Create URL normalization utility","description":"## Overview\n\nCreate a reusable utility for normalizing job URLs to enable reliable deduplication. Jobs from different sources may have query params, tracking codes, or slight URL variations that should resolve to the same job.\n\n## Implementation\n\n**File:** `apps/api/src/main/scala/arcata/api/util/UrlNormalizer.scala`\n\n```scala\npackage arcata.api.util\n\nimport java.net.URI\n\nobject UrlNormalizer:\n  /**\n   * Normalize a URL for deduplication purposes.\n   * \n   * - Removes query parameters\n   * - Removes fragment (#anchor)\n   * - Lowercases scheme and host\n   * - Removes trailing slashes\n   * \n   * @param url The raw URL to normalize\n   * @return Normalized URL string, or original if parsing fails\n   */\n  def normalize(url: String): String = ???\n\n  /**\n   * Extract the company identifier from a Greenhouse URL.\n   * e.g., \"https://job-boards.greenhouse.io/temporaltechnologies\" -\u003e \"temporaltechnologies\"\n   * e.g., \"https://boards.greenhouse.io/stripe\" -\u003e \"stripe\"\n   */\n  def extractGreenhouseCompanyId(url: String): Option[String] = ???\n```\n\n## Existing Deduplication Pattern\n\nThe `JobIngestionPipeline` already uses `SupabaseClient.findJobBySourceUrl()` for deduplication (see `apps/api/src/main/scala/arcata/api/etl/JobIngestionPipeline.scala:62`).\n\nThis utility should be called:\n1. Before storing `source_url` in the jobs table\n2. Before calling `findJobBySourceUrl` to check for existing jobs\n\n## Test Cases\n\n| Input | Expected Output |\n|-------|-----------------|\n| `https://example.com/job/123?utm_source=linkedin` | `https://example.com/job/123` |\n| `https://EXAMPLE.COM/Job/123/` | `https://example.com/job/123` |\n| `https://example.com/job/123#apply` | `https://example.com/job/123` |\n| `https://job-boards.greenhouse.io/temporal/jobs/123?gh_jid=456` | `https://job-boards.greenhouse.io/temporal/jobs/123` |\n\n## Greenhouse Company ID Extraction\n\n| Input | Expected Output |\n|-------|-----------------|\n| `https://job-boards.greenhouse.io/temporaltechnologies` | `Some(\"temporaltechnologies\")` |\n| `https://boards.greenhouse.io/stripe` | `Some(\"stripe\")` |\n| `https://boards-api.greenhouse.io/v1/boards/acme/jobs` | `Some(\"acme\")` |\n| `https://example.com/careers` | `None` |\n\n## Acceptance Criteria\n\n- [ ] UrlNormalizer object with normalize() method\n- [ ] extractGreenhouseCompanyId() helper method\n- [ ] Unit tests in `apps/api/src/test/scala/arcata/api/util/UrlNormalizerSuite.scala`\n- [ ] Tests use utest framework (project standard)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:08:38.880969355-05:00","updated_at":"2026-01-02T12:20:44.338403503-05:00","closed_at":"2026-01-02T12:20:44.338403503-05:00","dependencies":[{"issue_id":"ArcataAI-5er.2","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:08:38.88191788-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.3","title":"Create JobSource trait and registry","description":"## Overview\n\nDefine the framework for job sources - a pluggable system where new ATS integrations can be easily added by implementing a simple trait.\n\n## Implementation\n\n### JobSource Trait\n\n**File:** `apps/api/src/main/scala/arcata/api/etl/sources/JobSource.scala`\n\n```scala\npackage arcata.api.etl.sources\n\nimport arcata.api.clients.SupabaseClient\n\n/**\n * Configuration for rate limiting a job source.\n *\n * @param companyBatchSize Max companies to process per workflow run\n * @param jobsPerCompany Max jobs to fetch per company\n * @param delayBetweenRequestsMs Delay between HTTP requests\n */\ncase class JobSourceConfig(\n    companyBatchSize: Int = 1,\n    jobsPerCompany: Int = 1,\n    delayBetweenRequestsMs: Int = 1000\n)\n\n/**\n * A discovered job URL ready for ingestion.\n *\n * @param url The job posting URL (should be normalized)\n * @param companyId Optional company ID if known\n * @param metadata Additional context (e.g., greenhouse job ID)\n */\ncase class DiscoveredJob(\n    url: String,\n    companyId: Option[Long] = None,\n    metadata: Map[String, String] = Map.empty\n)\n\n/**\n * Trait for job discovery sources.\n *\n * Implement this trait to add a new ATS integration. The framework will:\n * 1. Call discoverJobs() to get URLs\n * 2. Process each URL through JobIngestionPipeline\n * 3. Respect rate limiting via config\n */\ntrait JobSource:\n  /** Unique identifier for this source (e.g., \"greenhouse\") */\n  def sourceId: String\n\n  /** Human-readable name (e.g., \"Greenhouse ATS\") */\n  def name: String\n\n  /** Rate limiting configuration */\n  def config: JobSourceConfig\n\n  /**\n   * Discover job URLs from this source.\n   *\n   * @param supabase Client for querying companies\n   * @return Sequence of discovered jobs to ingest\n   */\n  def discoverJobs(supabase: SupabaseClient): Seq[DiscoveredJob]\n```\n\n### JobSource Registry\n\n**File:** `apps/api/src/main/scala/arcata/api/etl/sources/JobSourceRegistry.scala`\n\n```scala\npackage arcata.api.etl.sources\n\n/**\n * Registry of all available job sources.\n * Add new sources here to enable them in JobDiscoveryWorkflow.\n */\nobject JobSourceRegistry:\n  def all: Seq[JobSource] = Seq(\n    GreenhouseJobSource\n    // Add new sources here:\n    // LeverJobSource,\n    // AshbyJobSource,\n  )\n\n  def get(sourceId: String): Option[JobSource] =\n    all.find(_.sourceId == sourceId)\n```\n\n## Directory Structure\n\nCreate new directory:\n```\napps/api/src/main/scala/arcata/api/etl/\n‚îú‚îÄ‚îÄ sources/           # NEW\n‚îÇ   ‚îú‚îÄ‚îÄ JobSource.scala\n‚îÇ   ‚îú‚îÄ‚îÄ JobSourceRegistry.scala\n‚îÇ   ‚îî‚îÄ‚îÄ GreenhouseJobSource.scala  (separate task)\n‚îú‚îÄ‚îÄ framework/\n‚îú‚îÄ‚îÄ steps/\n‚îî‚îÄ‚îÄ workflows/\n```\n\n## Design Patterns Used\n\nThis follows the same patterns as existing ETL framework:\n- Trait with companion case classes for Input/Output (here: DiscoveredJob)\n- Registry pattern similar to how steps are organized\n- Config as case class for easy defaults and overrides\n\n## Acceptance Criteria\n\n- [ ] JobSource trait with sourceId, name, config, discoverJobs()\n- [ ] JobSourceConfig case class for rate limiting\n- [ ] DiscoveredJob case class for discovered job URLs\n- [ ] JobSourceRegistry object with all() and get() methods\n- [ ] sources/ directory created under etl/","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:08:57.974939138-05:00","updated_at":"2026-01-02T12:20:44.358714454-05:00","closed_at":"2026-01-02T12:20:44.358714454-05:00","dependencies":[{"issue_id":"ArcataAI-5er.3","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:08:57.975687331-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.4","title":"Add findCompaniesByJobSource to SupabaseClient","description":"## Overview\n\nAdd a method to SupabaseClient for querying companies by their job source type (e.g., all Greenhouse companies).\n\n## Implementation\n\n**File:** `apps/api/src/main/scala/arcata/api/clients/SupabaseClient.scala`\n\nAdd method following existing patterns (see findJobBySourceUrl, findJobsToCheck):\n\n```scala\n/**\n * Find companies that use a specific job board source.\n *\n * @param source The job source type (e.g., \"greenhouse\")\n * @param limit Maximum companies to return\n * @return Companies with matching company_jobs_source\n */\ndef findCompaniesByJobSource(source: String, limit: Int): Seq[Company] = {\n  val response = requests.get(\n    s\"$baseUrl/companies\",\n    headers = headers,\n    params = Map(\n      \"company_jobs_source\" -\u003e s\"eq.$source\",\n      \"company_jobs_url\" -\u003e \"not.is.null\",\n      \"limit\" -\u003e limit.toString,\n      \"order\" -\u003e \"company_id.asc\"\n    )\n  )\n  parseResponse[Seq[Company]](response).getOrElse(Seq.empty)\n}\n```\n\n## Existing Patterns Reference\n\nThe SupabaseClient already has similar query methods:\n- `findJobBySourceUrl(sourceUrl: String): Option[Job]` - equality filter\n- `findJobsToCheck(batchSize: Int, olderThanDays: Int): Seq[Job]` - complex filtering with limit\n\nKey patterns:\n- Uses PostgREST `eq.$value` syntax for equality\n- Uses `not.is.null` for null checks\n- Returns `Seq.empty` on error (consistent with existing methods)\n- Uses `parseResponse[T]` helper\n\n## Usage\n\n```scala\n// In GreenhouseJobSource\nval companies = supabase.findCompaniesByJobSource(\"greenhouse\", config.companyBatchSize)\ncompanies.foreach { company =\u003e\n  // Process company.companyJobsUrl\n}\n```\n\n## Acceptance Criteria\n\n- [ ] Method added to SupabaseClient\n- [ ] Filters by company_jobs_source = source\n- [ ] Ensures company_jobs_url is not null (required for discovery)\n- [ ] Respects limit parameter\n- [ ] Orders by company_id for consistent pagination\n- [ ] Returns empty Seq on error (consistent with existing patterns)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:09:13.418436139-05:00","updated_at":"2026-01-02T12:20:44.375049661-05:00","closed_at":"2026-01-02T12:20:44.375049661-05:00","dependencies":[{"issue_id":"ArcataAI-5er.4","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:09:13.419145827-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.5","title":"Implement GreenhouseJobSource","description":"## Overview\n\nImplement the first JobSource for Greenhouse ATS. Uses the Greenhouse JSON API to discover job URLs.\n\n## Greenhouse API\n\n**Endpoint:** `https://boards-api.greenhouse.io/v1/boards/{company_id}/jobs`\n\n**Example:** `https://boards-api.greenhouse.io/v1/boards/temporaltechnologies/jobs`\n\n**Response structure:**\n```json\n{\n  \"jobs\": [\n    {\n      \"id\": 123456,\n      \"title\": \"Software Engineer\",\n      \"absolute_url\": \"https://job-boards.greenhouse.io/temporaltechnologies/jobs/123456\",\n      \"location\": { \"name\": \"San Francisco, CA\" },\n      ...\n    }\n  ]\n}\n```\n\n## Implementation\n\n**File:** `apps/api/src/main/scala/arcata/api/etl/sources/GreenhouseJobSource.scala`\n\n```scala\npackage arcata.api.etl.sources\n\nimport arcata.api.clients.SupabaseClient\nimport arcata.api.util.UrlNormalizer\nimport scribe.Logging\nimport upickle.default.*\n\ncase class GreenhouseJob(\n    id: Long,\n    title: String,\n    absolute_url: String\n) derives ReadWriter\n\ncase class GreenhouseJobsResponse(\n    jobs: Seq[GreenhouseJob]\n) derives ReadWriter\n\nobject GreenhouseJobSource extends JobSource with Logging:\n  val sourceId = \"greenhouse\"\n  val name = \"Greenhouse ATS\"\n  \n  // Conservative defaults - can be increased after testing\n  val config = JobSourceConfig(\n    companyBatchSize = 1,\n    jobsPerCompany = 1,\n    delayBetweenRequestsMs = 1000\n  )\n\n  override def discoverJobs(supabase: SupabaseClient): Seq[DiscoveredJob] = {\n    // 1. Query companies with greenhouse source\n    val companies = supabase.findCompaniesByJobSource(\"greenhouse\", config.companyBatchSize)\n    \n    companies.flatMap { company =\u003e\n      // 2. Extract company ID from jobs URL\n      company.companyJobsUrl.flatMap(UrlNormalizer.extractGreenhouseCompanyId) match\n        case Some(ghCompanyId) =\u003e\n          fetchJobsFromApi(ghCompanyId, company.companyId, config.jobsPerCompany)\n        case None =\u003e\n          logger.warn(s\"Could not extract Greenhouse ID from ${company.companyJobsUrl}\")\n          Seq.empty\n    }\n  }\n\n  private def fetchJobsFromApi(\n      ghCompanyId: String,\n      companyId: Option[Long],\n      limit: Int\n  ): Seq[DiscoveredJob] = {\n    val url = s\"https://boards-api.greenhouse.io/v1/boards/$ghCompanyId/jobs\"\n    try {\n      val response = requests.get(url, readTimeout = 10000)\n      if response.is2xx then\n        val parsed = read[GreenhouseJobsResponse](response.text())\n        parsed.jobs.take(limit).map { job =\u003e\n          DiscoveredJob(\n            url = UrlNormalizer.normalize(job.absolute_url),\n            companyId = companyId,\n            metadata = Map(\"greenhouse_job_id\" -\u003e job.id.toString)\n          )\n        }\n      else\n        logger.error(s\"Greenhouse API error: ${response.statusCode}\")\n        Seq.empty\n    } catch {\n      case e: Exception =\u003e\n        logger.error(s\"Failed to fetch from Greenhouse: ${e.getMessage}\")\n        Seq.empty\n    }\n  }\n```\n\n## Dependencies\n\n- Requires: ArcataAI-5er.2 (UrlNormalizer)\n- Requires: ArcataAI-5er.3 (JobSource trait)\n- Requires: ArcataAI-5er.4 (findCompaniesByJobSource)\n\n## Acceptance Criteria\n\n- [ ] GreenhouseJobSource implements JobSource trait\n- [ ] Queries companies by source type using SupabaseClient\n- [ ] Extracts company ID from company_jobs_url using UrlNormalizer\n- [ ] Calls Greenhouse API and parses JSON response with upickle\n- [ ] Returns DiscoveredJob with normalized URLs\n- [ ] Handles errors gracefully (returns empty Seq, logs error)\n- [ ] Respects jobsPerCompany limit","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:09:32.11140192-05:00","updated_at":"2026-01-02T12:20:44.391398064-05:00","closed_at":"2026-01-02T12:20:44.391398064-05:00","dependencies":[{"issue_id":"ArcataAI-5er.5","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:09:32.112011632-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.5","depends_on_id":"ArcataAI-5er.2","type":"blocks","created_at":"2026-01-02T11:11:09.053769371-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.5","depends_on_id":"ArcataAI-5er.3","type":"blocks","created_at":"2026-01-02T11:11:09.073764471-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.5","depends_on_id":"ArcataAI-5er.4","type":"blocks","created_at":"2026-01-02T11:11:09.090258339-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.6","title":"Implement JobDiscoveryWorkflow","description":"## Overview\n\nImplement the main workflow that orchestrates job discovery across all registered sources.\n\n## Implementation\n\n**File:** `apps/api/src/main/scala/arcata/api/etl/workflows/JobDiscoveryWorkflow.scala`\n\n```scala\npackage arcata.api.etl.workflows\n\nimport arcata.api.clients.{ObjectStorageClient, SupabaseClient}\nimport arcata.api.config.AIConfig\nimport arcata.api.etl.{JobIngestionInput, JobIngestionPipeline}\nimport arcata.api.etl.framework.*\nimport arcata.api.etl.sources.{JobSourceRegistry, DiscoveredJob}\n\ncase class JobDiscoveryInput(\n    sourceId: Option[String] = None  // None = all sources, Some = specific source\n)\n\ncase class JobDiscoveryOutput(\n    totalDiscovered: Int,\n    totalIngested: Int,\n    totalSkipped: Int,   // Already existed\n    totalFailed: Int,\n    bySource: Map[String, Int]\n)\n\nclass JobDiscoveryWorkflow(\n    supabaseClient: SupabaseClient,\n    aiConfig: AIConfig,\n    storageClient: Option[ObjectStorageClient] = None\n)(using ac: castor.Context)\n    extends BaseWorkflow[JobDiscoveryInput, JobDiscoveryOutput]:\n\n  val name = \"JobDiscoveryWorkflow\"\n\n  private val ingestionPipeline = JobIngestionPipeline(\n    supabaseClient, aiConfig, storageClient\n  )\n\n  override def execute(\n      input: JobDiscoveryInput,\n      ctx: PipelineContext\n  ): Either[StepError, JobDiscoveryOutput] = {\n    val sources = input.sourceId match\n      case Some(id) =\u003e JobSourceRegistry.get(id).toSeq\n      case None =\u003e JobSourceRegistry.all\n\n    var totalDiscovered = 0\n    var totalIngested = 0\n    var totalSkipped = 0\n    var totalFailed = 0\n    val bySource = scala.collection.mutable.Map[String, Int]()\n\n    for source \u003c- sources do\n      logger.info(s\"[${ctx.runId}] Processing source: ${source.name}\")\n      \n      val jobs = source.discoverJobs(supabaseClient)\n      totalDiscovered += jobs.size\n      bySource(source.sourceId) = jobs.size\n\n      for job \u003c- jobs do\n        // Rate limiting delay\n        if source.config.delayBetweenRequestsMs \u003e 0 then\n          Thread.sleep(source.config.delayBetweenRequestsMs)\n\n        // Process through ingestion pipeline\n        val result = ingestionPipeline.run(\n          JobIngestionInput(\n            url = job.url,\n            profileId = \"system\",\n            source = s\"discovery:${source.sourceId}\",\n            createApplication = false\n          ),\n          \"system\"\n        )\n\n        if result.isSuccess then totalIngested += 1\n        else totalFailed += 1\n\n    Right(JobDiscoveryOutput(\n      totalDiscovered = totalDiscovered,\n      totalIngested = totalIngested,\n      totalSkipped = totalSkipped,\n      totalFailed = totalFailed,\n      bySource = bySource.toMap\n    ))\n  }\n\n  override def onSuccess(result: PipelineResult[JobDiscoveryOutput]): Unit =\n    result.output.foreach { out =\u003e\n      logger.info(\n        s\"[$name] Completed: discovered=${out.totalDiscovered}, \" +\n        s\"ingested=${out.totalIngested}, skipped=${out.totalSkipped}, \" +\n        s\"failed=${out.totalFailed}\"\n      )\n    }\n\nobject JobDiscoveryWorkflow:\n  def apply(\n      supabaseClient: SupabaseClient,\n      aiConfig: AIConfig,\n      storageClient: Option[ObjectStorageClient] = None\n  )(using ac: castor.Context): JobDiscoveryWorkflow =\n    new JobDiscoveryWorkflow(supabaseClient, aiConfig, storageClient)\n```\n\n## Existing Patterns Reference\n\nFollow the pattern from `JobStatusWorkflow` (`apps/api/src/main/scala/arcata/api/etl/workflows/JobStatusWorkflow.scala`):\n- Extends `BaseWorkflow[I, O]`\n- Input/Output case classes defined at top\n- Uses `castor.Context` for async execution\n- Overrides `onSuccess` for detailed logging\n- Companion object with `apply` factory\n\n## Key Behaviors\n\n1. **Source iteration**: Processes all sources from JobSourceRegistry (or specific one if sourceId provided)\n2. **Rate limiting**: Respects `delayBetweenRequestsMs` between each job ingestion\n3. **Deduplication**: Handled by JobIngestionPipeline (checks findJobBySourceUrl)\n4. **Metrics**: Tracks discovered/ingested/skipped/failed counts\n\n## Dependencies\n\n- Requires: ArcataAI-5er.3 (JobSource framework)\n- Requires: ArcataAI-5er.5 (GreenhouseJobSource)\n- Uses: JobIngestionPipeline (existing)\n\n## Acceptance Criteria\n\n- [ ] Extends BaseWorkflow[JobDiscoveryInput, JobDiscoveryOutput]\n- [ ] Iterates through JobSourceRegistry.all or specific source\n- [ ] Respects rate limiting delays between requests\n- [ ] Calls JobIngestionPipeline.run() for each discovered URL\n- [ ] Uses source=\"discovery:{sourceId}\" to track origin\n- [ ] Tracks metrics (discovered, ingested, skipped, failed)\n- [ ] Logs progress and results","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:10:01.711127312-05:00","updated_at":"2026-01-02T12:21:51.854540104-05:00","closed_at":"2026-01-02T12:21:51.854540104-05:00","dependencies":[{"issue_id":"ArcataAI-5er.6","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:10:01.712579651-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.6","depends_on_id":"ArcataAI-5er.3","type":"blocks","created_at":"2026-01-02T11:11:14.815645869-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.6","depends_on_id":"ArcataAI-5er.5","type":"blocks","created_at":"2026-01-02T11:11:14.835594618-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.7","title":"Create HTTP endpoint for JobDiscoveryWorkflow","description":"## Overview\n\nAdd HTTP endpoint to trigger the JobDiscoveryWorkflow asynchronously, following the pattern from JobStatusWorkflow.\n\n## Implementation\n\n**File:** Update `apps/api/src/main/scala/arcata/api/routes/CronRoutes.scala` (or add to existing routes file)\n\nFollowing the pattern from JobStatusWorkflow endpoint:\n\n```scala\n// POST /api/v1/cron/job-discovery\n// Optionally accepts: { \"sourceId\": \"greenhouse\" } to filter to specific source\n\ncase request @ cask.Request(req) if req.uri.startsWith(\"/api/v1/cron/job-discovery\") =\u003e\n  request.post { _ =\u003e\n    val runId = java.util.UUID.randomUUID().toString\n    \n    // Parse optional sourceId from request body\n    val sourceId: Option[String] = Try {\n      val json = ujson.read(request.text())\n      json.obj.get(\"sourceId\").map(_.str)\n    }.toOption.flatten\n    \n    val input = JobDiscoveryInput(sourceId = sourceId)\n    \n    jobDiscoveryWorkflow.send(WorkflowRun(input, \"system\"))\n    \n    cask.Response(\n      ujson.Obj(\n        \"runId\" -\u003e runId,\n        \"status\" -\u003e \"accepted\",\n        \"message\" -\u003e \"Job discovery workflow started\"\n      ).toString,\n      statusCode = 202,\n      headers = Seq(\"Content-Type\" -\u003e \"application/json\")\n    )\n  }\n```\n\n## Workflow Initialization\n\nThe workflow needs to be initialized in ApiApp.scala with the castor context:\n\n```scala\n// In ApiApp or wherever routes are wired\ngiven actorContext: castor.Context = castor.Context.Simple.global\n\nval jobDiscoveryWorkflow = JobDiscoveryWorkflow(\n  supabaseClient,\n  aiConfig,\n  Some(storageClient)\n)\n```\n\n## Existing Pattern Reference\n\nSee how JobStatusWorkflow is wired up - this should follow the same pattern for:\n- Route registration\n- Workflow instantiation with dependencies\n- 202 Accepted response pattern\n\n## API Contract\n\n**Request:**\n```\nPOST /api/v1/cron/job-discovery\nContent-Type: application/json\n\n{\n  \"sourceId\": \"greenhouse\"  // optional - omit for all sources\n}\n```\n\n**Response:**\n```\nHTTP/1.1 202 Accepted\nContent-Type: application/json\n\n{\n  \"runId\": \"uuid-here\",\n  \"status\": \"accepted\",\n  \"message\": \"Job discovery workflow started\"\n}\n```\n\n## Acceptance Criteria\n\n- [ ] POST /api/v1/cron/job-discovery endpoint added\n- [ ] Returns 202 Accepted with runId\n- [ ] Workflow runs asynchronously via castor actor\n- [ ] Optionally accepts sourceId filter in request body\n- [ ] JobDiscoveryWorkflow initialized with proper dependencies\n- [ ] Follows existing route patterns in the codebase","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:10:18.657344272-05:00","updated_at":"2026-01-02T12:23:49.549621995-05:00","closed_at":"2026-01-02T12:23:49.549621995-05:00","dependencies":[{"issue_id":"ArcataAI-5er.7","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:10:18.658107103-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.7","depends_on_id":"ArcataAI-5er.6","type":"blocks","created_at":"2026-01-02T11:11:21.402007458-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.8","title":"Write tests for Job Discovery system","description":"## Overview\n\nWrite unit tests for all new Job Discovery components using utest (project standard).\n\n## Test Files\n\n### 1. UrlNormalizer Tests\n\n**File:** `apps/api/src/test/scala/arcata/api/util/UrlNormalizerSuite.scala`\n\n```scala\npackage arcata.api.util\n\nimport utest.*\n\nobject UrlNormalizerSuite extends TestSuite:\n  val tests = Tests {\n    test(\"normalize\") {\n      test(\"removes query parameters\") {\n        val result = UrlNormalizer.normalize(\"https://example.com/job/123?utm_source=linkedin\")\n        assert(result == \"https://example.com/job/123\")\n      }\n      test(\"removes fragment\") {\n        val result = UrlNormalizer.normalize(\"https://example.com/job/123#apply\")\n        assert(result == \"https://example.com/job/123\")\n      }\n      test(\"lowercases host\") {\n        val result = UrlNormalizer.normalize(\"https://EXAMPLE.COM/Job/123\")\n        assert(result == \"https://example.com/Job/123\")\n      }\n      test(\"removes trailing slash\") {\n        val result = UrlNormalizer.normalize(\"https://example.com/job/123/\")\n        assert(result == \"https://example.com/job/123\")\n      }\n    }\n    \n    test(\"extractGreenhouseCompanyId\") {\n      test(\"extracts from job-boards.greenhouse.io\") {\n        val result = UrlNormalizer.extractGreenhouseCompanyId(\n          \"https://job-boards.greenhouse.io/temporaltechnologies\"\n        )\n        assert(result == Some(\"temporaltechnologies\"))\n      }\n      test(\"extracts from boards.greenhouse.io\") {\n        val result = UrlNormalizer.extractGreenhouseCompanyId(\n          \"https://boards.greenhouse.io/stripe\"\n        )\n        assert(result == Some(\"stripe\"))\n      }\n      test(\"returns None for non-greenhouse URL\") {\n        val result = UrlNormalizer.extractGreenhouseCompanyId(\n          \"https://example.com/careers\"\n        )\n        assert(result == None)\n      }\n    }\n  }\n```\n\n### 2. GreenhouseJobSource Tests\n\n**File:** `apps/api/src/test/scala/arcata/api/etl/sources/GreenhouseJobSourceSuite.scala`\n\nTest:\n- API response parsing (mock response)\n- Company ID extraction from various URL formats\n- Error handling (API errors, malformed responses)\n\n### 3. JobDiscoveryWorkflow Tests\n\n**File:** `apps/api/src/test/scala/arcata/api/etl/workflows/JobDiscoveryWorkflowSuite.scala`\n\nTest:\n- Workflow orchestration (mock sources)\n- Metrics aggregation\n- Source filtering by sourceId\n\n## Existing Test Patterns\n\nReference existing test files for patterns:\n- `apps/api/src/test/scala/arcata/api/etl/framework/` - framework tests\n- `apps/api/src/test/scala/arcata/api/etl/steps/` - step tests\n- `apps/api/src/test/scala/arcata/api/domain/DomainModelsSuite.scala` - model tests\n\nKey patterns:\n- Use `utest.TestSuite` and `Tests { }` block\n- Nested test blocks for organization\n- `assert()` for assertions\n- Companion objects for test fixtures\n\n## Running Tests\n\n```bash\ncd apps/api\nmake test\n```\n\n## Acceptance Criteria\n\n- [ ] UrlNormalizerSuite tests URL normalization edge cases\n- [ ] UrlNormalizerSuite tests Greenhouse company ID extraction\n- [ ] GreenhouseJobSourceSuite tests API response parsing\n- [ ] JobDiscoveryWorkflowSuite tests workflow orchestration\n- [ ] All tests use utest framework\n- [ ] All tests pass with `make test`","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:10:36.50317114-05:00","updated_at":"2026-01-02T12:25:42.044295034-05:00","closed_at":"2026-01-02T12:25:42.044295034-05:00","dependencies":[{"issue_id":"ArcataAI-5er.8","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:10:36.503814076-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.8","depends_on_id":"ArcataAI-5er.2","type":"blocks","created_at":"2026-01-02T11:11:27.226510475-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.8","depends_on_id":"ArcataAI-5er.5","type":"blocks","created_at":"2026-01-02T11:11:27.244674805-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.8","depends_on_id":"ArcataAI-5er.6","type":"blocks","created_at":"2026-01-02T11:11:27.260947348-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5er.9","title":"Update documentation for Job Discovery system","description":"## Overview\n\nUpdate architecture documentation to include the Job Discovery system and JobSource framework.\n\n## Documentation Updates\n\n### 1. apps/api/README.md - ETL Pipeline Diagram\n\nAdd Job Discovery workflow to the existing ETL diagram:\n\n```\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ                    Job Discovery Flow                           ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ                                                                 ‚îÇ\n‚îÇ  POST /api/v1/cron/job-discovery                               ‚îÇ\n‚îÇ         ‚îÇ                                                       ‚îÇ\n‚îÇ         ‚ñº                                                       ‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ\n‚îÇ  ‚îÇ           JobDiscoveryWorkflow (async)                   ‚îÇ   ‚îÇ\n‚îÇ  ‚îÇ  - Iterates JobSourceRegistry                            ‚îÇ   ‚îÇ\n‚îÇ  ‚îÇ  - Respects rate limits                                  ‚îÇ   ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ\n‚îÇ         ‚îÇ                                                       ‚îÇ\n‚îÇ         ‚ñº for each source                                       ‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ\n‚îÇ  ‚îÇ           JobSource.discoverJobs()                       ‚îÇ   ‚îÇ\n‚îÇ  ‚îÇ  e.g., GreenhouseJobSource                               ‚îÇ   ‚îÇ\n‚îÇ  ‚îÇ  - Queries companies by source type                      ‚îÇ   ‚îÇ\n‚îÇ  ‚îÇ  - Calls ATS API for job listings                        ‚îÇ   ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ\n‚îÇ         ‚îÇ                                                       ‚îÇ\n‚îÇ         ‚ñº for each job URL                                      ‚îÇ\n‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ\n‚îÇ  ‚îÇ           JobIngestionPipeline                           ‚îÇ   ‚îÇ\n‚îÇ  ‚îÇ  (reuses existing ETL)                                   ‚îÇ   ‚îÇ\n‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ\n‚îÇ                                                                 ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n### 2. docs/architecture.md - System Overview\n\nAdd section describing the job discovery cron system and how it fits into the overall architecture:\n- How cron workflows are triggered\n- How JobDiscoveryWorkflow fits into the ETL layer\n- Rate limiting and deduplication strategies\n\n### 3. apps/api/src/main/scala/arcata/api/etl/sources/README.md (NEW)\n\nCreate documentation for the JobSource framework:\n\n```markdown\n# Job Sources Framework\n\nThis directory contains the pluggable job source system for discovering jobs from various ATS platforms.\n\n## Adding a New Job Source\n\n1. Create a new file: `{AtsName}JobSource.scala`\n2. Implement the `JobSource` trait:\n   - `sourceId`: Unique identifier (e.g., \"lever\")\n   - `name`: Human-readable name\n   - `config`: Rate limiting settings\n   - `discoverJobs()`: Discovery logic\n3. Register in `JobSourceRegistry.all`\n\n## Example Implementation\n\nSee `GreenhouseJobSource.scala` for reference implementation.\n\n## Configuration\n\nEach source defines its own `JobSourceConfig`:\n- `companyBatchSize`: Max companies per workflow run\n- `jobsPerCompany`: Max jobs to fetch per company  \n- `delayBetweenRequestsMs`: Rate limiting delay between HTTP requests\n\n## Testing\n\nRun `make test` from apps/api to run all ETL tests including sources.\n```\n\n## Acceptance Criteria\n\n- [ ] apps/api/README.md updated with Job Discovery diagram\n- [ ] docs/architecture.md updated with cron system description\n- [ ] sources/README.md created with framework documentation\n- [ ] Documentation explains how to add new job sources\n- [ ] Documentation follows existing patterns in the codebase","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T11:10:55.994922859-05:00","updated_at":"2026-01-02T12:27:05.937593959-05:00","closed_at":"2026-01-02T12:27:05.937593959-05:00","dependencies":[{"issue_id":"ArcataAI-5er.9","depends_on_id":"ArcataAI-5er","type":"parent-child","created_at":"2026-01-02T11:10:55.995463546-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.9","depends_on_id":"ArcataAI-5er.3","type":"blocks","created_at":"2026-01-02T11:11:32.980432532-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.9","depends_on_id":"ArcataAI-5er.6","type":"blocks","created_at":"2026-01-02T11:11:33.000442397-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-5er.9","depends_on_id":"ArcataAI-5er.7","type":"blocks","created_at":"2026-01-02T11:11:33.016895973-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-5nt","title":"Rewrite root README.md","description":"Replace the outdated README with a new developer-focused quick start guide. Must include: mission statement (candidate-first, O'Saasy promise), prerequisites (Bun, Supabase CLI, Mill), setup instructions, local Supabase guidance with link to CLI docs, dev server commands, project structure overview, links to docs/architecture.md and apps/api/README.md, license section.","status":"closed","priority":0,"issue_type":"chore","created_at":"2025-12-22T18:40:03.568237117-05:00","updated_at":"2025-12-22T18:41:09.678503543-05:00","closed_at":"2025-12-22T18:41:09.678503543-05:00"}
{"id":"ArcataAI-6o9","title":"Sidebar Account \u0026 Settings","description":"Wire up the sidebar profile action (bottom-left) to display current user's name/avatar and navigate to /settings/account page with account management UI","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-27T10:22:11.028613058-05:00","updated_at":"2025-12-27T11:31:56.371089728-05:00","closed_at":"2025-12-27T11:31:56.371089728-05:00"}
{"id":"ArcataAI-6o9.1","title":"Create AccountSettings page component","description":"Create AccountSettings.tsx page component based on Tailwind template with: 1) Personal Info section, 2) Log Out section (simple logout button, placed away from delete), 3) Delete Account section at bottom. NO password fields - magic link auth only.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T10:22:15.403662783-05:00","updated_at":"2025-12-27T11:28:21.267406834-05:00","closed_at":"2025-12-27T11:28:21.267406834-05:00","dependencies":[{"issue_id":"ArcataAI-6o9.1","depends_on_id":"ArcataAI-6o9","type":"parent-child","created_at":"2025-12-27T10:22:15.404195601-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-6o9.2","title":"Add settings route to App","description":"Add /settings/account route to App.tsx router config, import AccountSettings component","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T10:22:15.415680806-05:00","updated_at":"2025-12-27T11:29:05.021324656-05:00","closed_at":"2025-12-27T11:29:05.021324656-05:00","dependencies":[{"issue_id":"ArcataAI-6o9.2","depends_on_id":"ArcataAI-6o9","type":"parent-child","created_at":"2025-12-27T10:22:15.416139539-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-6o9.2","depends_on_id":"ArcataAI-6o9.1","type":"blocks","created_at":"2025-12-27T10:41:58.350007735-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-6o9.3","title":"Update Sidebar user info to navigate to Account","description":"Update sidebar bottom-left action to show user full_name (fallback email), avatar (fallback icon), and navigate to /settings/account on click. Update translation keys from pages.profile to pages.account","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T10:22:15.428019233-05:00","updated_at":"2025-12-27T11:30:57.862531921-05:00","closed_at":"2025-12-27T11:30:57.862531921-05:00","dependencies":[{"issue_id":"ArcataAI-6o9.3","depends_on_id":"ArcataAI-6o9","type":"parent-child","created_at":"2025-12-27T10:22:15.42855152-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-6o9.3","depends_on_id":"ArcataAI-6o9.2","type":"blocks","created_at":"2025-12-27T10:42:04.070789083-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-6o9.4","title":"Implement AccountSettings UI","description":"Add translations for account settings page (title, section headers, form labels, buttons) under pages.account namespace","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T10:22:15.440759142-05:00","updated_at":"2025-12-27T11:31:55.172716108-05:00","closed_at":"2025-12-27T11:31:55.172716108-05:00","dependencies":[{"issue_id":"ArcataAI-6o9.4","depends_on_id":"ArcataAI-6o9","type":"parent-child","created_at":"2025-12-27T10:22:15.441147408-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-6o9.4","depends_on_id":"ArcataAI-6o9.1","type":"blocks","created_at":"2025-12-27T10:41:58.352066326-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732","title":"Rework ETL to use BoogieLoops AI directly","description":"Replace external BoogieLoops API calls with direct BoogieLoops AI Agent usage via Vercel AI Gateway. Includes: AI config, JobExtractionAgent, CompanyEnrichmentAgent, updated JobParser step, updated CompanyResolver step.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-22T20:07:19.021507555-05:00","updated_at":"2025-12-22T21:49:00.042958129-05:00","closed_at":"2025-12-22T21:49:00.042958129-05:00"}
{"id":"ArcataAI-732.1","title":"Update Config with AI provider settings","description":"Update apps/api/src/main/scala/arcata/api/config/Config.scala\n\nReplace BoogieLoopsConfig with AIConfig:\n\nfinal case class AIConfig(\n    baseUrl: String,      // Vercel AI Gateway: https://api.vercel.ai/v1\n    apiKey: String,       // VERCEL_AI_GATEWAY_API_KEY\n    model: String         // anthropic/claude-sonnet-4-20250514\n)\n\nUpdate environment variable loading:\n- VERCEL_AI_GATEWAY_URL (default: https://api.vercel.ai/v1)\n- VERCEL_AI_GATEWAY_API_KEY (required)\n- AI_MODEL (default: anthropic/claude-sonnet-4-20250514)\n\nUpdate .env.example with new variables.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:07:25.968580865-05:00","updated_at":"2025-12-22T20:50:51.275402876-05:00","closed_at":"2025-12-22T20:50:51.275402876-05:00","dependencies":[{"issue_id":"ArcataAI-732.1","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:25.969186437-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.10","title":"Add early exit check for existing jobs in pipeline","description":"Address TODO on line 52 of JobIngestionPipeline.scala: 'look up existing job first! so we can exit early'\n\nAdd a new step at the beginning of the pipeline:\n\nStep 0: Check if job already exists by source URL\n- Call supabaseClient.findJobBySourceUrl(input.url)\n- If job exists:\n  - Skip HTML fetch, parsing, company resolution, job loading\n  - Go directly to StreamLoader (add to user's stream if not already there)\n  - Then ApplicationLoader if createApplication=true\n- If job doesn't exist:\n  - Continue with full pipeline\n\nThis optimization:\n1. Saves AI/API costs (no parsing needed)\n2. Faster response for duplicate URLs\n3. Still adds job to user's stream/applications\n\nImplementation approach:\n- Create new step: JobLookup (or inline check in execute())\n- Returns Either[StepError, Option[Job]]\n- If Some(job), short-circuit to step 5\n- If None, continue full pipeline\n\nAlso relates to company enrichment - only enrich NEW companies (option b from discussion).","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:11:25.649060085-05:00","updated_at":"2025-12-22T21:45:18.073418892-05:00","closed_at":"2025-12-22T21:45:18.073418892-05:00","dependencies":[{"issue_id":"ArcataAI-732.10","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:11:25.649643073-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.2","title":"Add Schematic derivation to domain models","description":"Update domain models to derive Schematic for BoogieLoops AI structured output.\n\nFile: apps/api/src/main/scala/arcata/api/domain/ExtractedJobData.scala\n- Add: derives ReadWriter, Schematic\n- Remove: rawText field (not needed, HTML stored in object storage)\n- Import: boogieloops.schema.derivation.Schematic\n\nCreate new model for company extraction:\nFile: apps/api/src/main/scala/arcata/api/domain/ExtractedCompanyData.scala\n\nfinal case class ExtractedCompanyData(\n    name: String,\n    domain: Option[String] = None,\n    industry: Option[String] = None,\n    size: Option[String] = None,        // startup, small, medium, large, enterprise\n    description: Option[String] = None,\n    headquarters: Option[String] = None,\n    websiteUrl: Option[String] = None\n) derives ReadWriter, Schematic","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:07:32.960257672-05:00","updated_at":"2025-12-22T20:53:21.10622406-05:00","closed_at":"2025-12-22T20:53:21.10622406-05:00","dependencies":[{"issue_id":"ArcataAI-732.2","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:32.960809058-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.3","title":"Create JobExtractionAgent","description":"Create apps/api/src/main/scala/arcata/api/ai/JobExtractionAgent.scala\n\nUses BoogieLoops AI Agent with OpenAICompatibleProvider via Vercel AI Gateway.\n\nclass JobExtractionAgent(config: AIConfig):\n  private val provider = OpenAICompatibleProvider(\n    baseUrl = config.baseUrl,\n    apiKey = config.apiKey,\n    modelId = config.model,\n    strictModelValidation = false\n  )\n  \n  private val agent = Agent(\n    name = \"JobExtractor\",\n    instructions = \"\"\"You are a job posting parser. Given HTML content from a job posting page,\nextract structured job information. Be thorough but concise. If information is not present,\nleave the field empty rather than guessing.\"\"\",\n    provider = provider,\n    model = config.model,\n    temperature = Some(0.1)  // Low temp for consistent extraction\n  )\n  \n  def extract(html: String, url: String): Either[SchemaError, ExtractedJobData] =\n    agent.generateObjectWithoutHistory[ExtractedJobData](\n      s\"\"\"Extract job details from this HTML. Source URL: $url\n      \nHTML Content:\n$html\"\"\",\n      RequestMetadata()\n    ).map(_.data)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:07:41.368941884-05:00","updated_at":"2025-12-22T21:40:45.955947695-05:00","closed_at":"2025-12-22T21:40:45.955947695-05:00","dependencies":[{"issue_id":"ArcataAI-732.3","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:41.369535442-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.3","depends_on_id":"ArcataAI-732.1","type":"blocks","created_at":"2025-12-22T20:08:30.339437238-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.3","depends_on_id":"ArcataAI-732.2","type":"blocks","created_at":"2025-12-22T20:08:30.351560756-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.4","title":"Create CompanyEnrichmentAgent","description":"Create apps/api/src/main/scala/arcata/api/ai/CompanyEnrichmentAgent.scala\n\nUses BoogieLoops AI Agent to enrich company data from job posting context.\n\nclass CompanyEnrichmentAgent(config: AIConfig):\n  private val provider = OpenAICompatibleProvider(...)\n  \n  private val agent = Agent(\n    name = \"CompanyEnricher\",\n    instructions = \"\"\"You extract and enrich company information from job posting context.\nGiven the company name, job posting HTML, and URL, extract additional company details\nthat can be inferred from the content.\"\"\",\n    provider = provider,\n    model = config.model,\n    temperature = Some(0.1)\n  )\n  \n  def enrich(\n    companyName: String,\n    html: String,\n    url: String\n  ): Either[SchemaError, ExtractedCompanyData] =\n    agent.generateObjectWithoutHistory[ExtractedCompanyData](\n      s\"\"\"Extract company information for '$companyName' from this job posting.\nURL: $url\n\nHTML Content:\n$html\"\"\",\n      RequestMetadata()\n    ).map(_.data)\n\nThis enriches company records with industry, size, description, etc.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:07:49.132609219-05:00","updated_at":"2025-12-22T21:40:45.973857976-05:00","closed_at":"2025-12-22T21:40:45.973857976-05:00","dependencies":[{"issue_id":"ArcataAI-732.4","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:49.133153582-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.4","depends_on_id":"ArcataAI-732.1","type":"blocks","created_at":"2025-12-22T20:08:30.363606251-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.4","depends_on_id":"ArcataAI-732.2","type":"blocks","created_at":"2025-12-22T20:08:30.375122774-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.5","title":"Rework JobParser step to use JobExtractionAgent","description":"Update apps/api/src/main/scala/arcata/api/etl/steps/JobParser.scala\n\nRemove:\n- HTTP calls to external BoogieLoops API\n- BoogieLoopsConfig dependency\n- BoogieLoopsResponse case class\n\nAdd:\n- JobExtractionAgent dependency\n- AIConfig dependency\n\nUpdated execute():\n1. Call jobExtractionAgent.extract(input.html, input.url)\n2. Map SchemaError to StepError.TransformationError\n3. Return JobParserOutput with extracted data\n\nConstructor change:\n- Old: JobParser(config: BoogieLoopsConfig)\n- New: JobParser(aiConfig: AIConfig)\n\nInternal: Creates JobExtractionAgent instance","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:07:55.786194568-05:00","updated_at":"2025-12-22T21:45:18.036634777-05:00","closed_at":"2025-12-22T21:45:18.036634777-05:00","dependencies":[{"issue_id":"ArcataAI-732.5","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:07:55.786871961-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.5","depends_on_id":"ArcataAI-732.3","type":"blocks","created_at":"2025-12-22T20:08:30.387385413-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.6","title":"Rework CompanyResolver step to use CompanyEnrichmentAgent","description":"Update apps/api/src/main/scala/arcata/api/etl/steps/CompanyResolver.scala\n\nAdd:\n- CompanyEnrichmentAgent dependency\n- AIConfig dependency\n- HTML passed through from previous step (update input/output types)\n\nUpdated flow:\n1. Extract domain from URL (existing logic)\n2. Look up company by domain in DB\n3. If found:\n   - Check if company needs enrichment (missing industry, size, etc.)\n   - If needs enrichment, call companyEnrichmentAgent.enrich()\n   - Update company record with enriched data\n4. If not found:\n   - Call companyEnrichmentAgent.enrich() to get full company data\n   - Create new company with enriched data\n\nUpdate CompanyResolverInput to include html field.\nUpdate Company domain model if needed for new fields (industry, size, etc.)\n\nConstructor change:\n- Old: CompanyResolver(supabaseClient: SupabaseClient)\n- New: CompanyResolver(supabaseClient: SupabaseClient, aiConfig: AIConfig)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:08:03.621993476-05:00","updated_at":"2025-12-22T21:47:47.550553854-05:00","closed_at":"2025-12-22T21:47:47.550553854-05:00","dependencies":[{"issue_id":"ArcataAI-732.6","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:03.622736427-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.6","depends_on_id":"ArcataAI-732.4","type":"blocks","created_at":"2025-12-22T20:08:30.39957561-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.6","depends_on_id":"ArcataAI-732.7","type":"blocks","created_at":"2025-12-22T20:08:30.411463839-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.7","title":"Update Company domain model with enrichment fields","description":"Update apps/api/src/main/scala/arcata/api/domain/Company.scala\n\nAdd fields to match ExtractedCompanyData:\n- industry: Option[String] = None\n- companySize: Option[String] = None  // startup, small, medium, large, enterprise\n- description: Option[String] = None\n- headquarters: Option[String] = None\n\nUpdate SupabaseClient company methods to handle new fields.\n\nMay need Supabase migration to add columns to companies table:\n- industry VARCHAR\n- company_size VARCHAR\n- description TEXT\n- headquarters VARCHAR","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:08:09.511404162-05:00","updated_at":"2025-12-22T21:45:18.05299956-05:00","closed_at":"2025-12-22T21:45:18.05299956-05:00","dependencies":[{"issue_id":"ArcataAI-732.7","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:09.512117114-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.7","depends_on_id":"ArcataAI-732.9","type":"blocks","created_at":"2025-12-22T20:08:30.424381927-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.8","title":"Update JobIngestionPipeline for new AI config","description":"Update apps/api/src/main/scala/arcata/api/etl/JobIngestionPipeline.scala\n\nConstructor change:\n- Old: JobIngestionPipeline(supabaseClient, boogieLoopsConfig, storageClient)\n- New: JobIngestionPipeline(supabaseClient, aiConfig, storageClient)\n\nUpdate step initialization:\n- jobParser = JobParser(aiConfig)\n- companyResolver = CompanyResolver(supabaseClient, aiConfig)\n\nUpdate execute() to pass HTML through to CompanyResolver:\n- CompanyResolverInput now needs html field\n- Pass fetcherOutput.html to companyResolver step\n\nUpdate ApiApp.scala to use new AIConfig instead of BoogieLoopsConfig.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:08:16.556802139-05:00","updated_at":"2025-12-22T21:48:50.468857469-05:00","closed_at":"2025-12-22T21:48:50.468857469-05:00","dependencies":[{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:16.557377392-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732.5","type":"blocks","created_at":"2025-12-22T20:08:30.436829327-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732.6","type":"blocks","created_at":"2025-12-22T20:08:30.448042718-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-732.8","depends_on_id":"ArcataAI-732.10","type":"blocks","created_at":"2025-12-22T20:11:30.880713213-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-732.9","title":"Add Supabase migration for company enrichment fields","description":"Create supabase/migrations/20241222000010_add_company_enrichment_fields.sql\n\nALTER TABLE companies ADD COLUMN IF NOT EXISTS industry VARCHAR;\nALTER TABLE companies ADD COLUMN IF NOT EXISTS company_size VARCHAR;\nALTER TABLE companies ADD COLUMN IF NOT EXISTS description TEXT;\nALTER TABLE companies ADD COLUMN IF NOT EXISTS headquarters VARCHAR;\n\n-- Add index for industry filtering\nCREATE INDEX IF NOT EXISTS idx_companies_industry ON companies(industry);\n\nRun: supabase db push to apply migration","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-22T20:08:22.363455525-05:00","updated_at":"2025-12-22T20:51:37.035764371-05:00","closed_at":"2025-12-22T20:51:37.035764371-05:00","dependencies":[{"issue_id":"ArcataAI-732.9","depends_on_id":"ArcataAI-732","type":"parent-child","created_at":"2025-12-22T20:08:22.364046279-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-733","title":"Create apps/api/README.md with ETL diagram","description":"Create API service documentation with: prerequisites (Java 11+, Mill), setup instructions, make commands, ETL pipeline ASCII diagram showing HtmlFetcher -\u003e JobParser -\u003e CompanyResolver -\u003e JobLoader/StreamLoader/ApplicationLoader flow. Include pipeline steps table and links to ObjectStorage, BoogieLoops, Mill docs, Cask docs, and back to system architecture.","status":"closed","priority":0,"issue_type":"chore","created_at":"2025-12-22T18:40:09.110647261-05:00","updated_at":"2025-12-22T18:42:14.980871458-05:00","closed_at":"2025-12-22T18:42:14.980871458-05:00"}
{"id":"ArcataAI-746","title":"Profile+ Resume Builder Feature","description":"Complete profile management system with Lexical-based resume builder. Users can create/manage multiple job profiles with structured resume sections, drag-and-drop reordering, and component picker for adding sections.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-27T12:16:45.606942048-05:00","updated_at":"2025-12-27T16:45:44.417087368-05:00","closed_at":"2025-12-27T16:45:44.417087368-05:00"}
{"id":"ArcataAI-746.1","title":"Add status enum column to job_profiles table","description":"Database migration to replace is_active boolean with status enum.\n\n## Changes\n- Create PostgreSQL ENUM type: job_profile_status AS ENUM ('draft', 'live')\n- Add column: status job_profile_status DEFAULT 'draft'\n- Drop column: is_active\n- Update database.types.ts after migration\n- Update resourceTypes.ts JobProfile type\n\n## Notes\n- No data migration needed (no existing data)\n- Run: npx supabase db diff to generate migration\n- Regenerate types after migration","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:16:54.271489209-05:00","updated_at":"2025-12-27T12:33:23.177750706-05:00","closed_at":"2025-12-27T12:33:23.177750706-05:00","dependencies":[{"issue_id":"ArcataAI-746.1","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:16:54.271968575-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.10","title":"Create SummaryNode custom Lexical node","description":"Custom DecoratorNode for professional summary section.\n\n## Node: SummaryNode\nType: 'summary-section'\nExtends: DecoratorNode\n\n## State Fields\n- content: string (markdown)\n\n## decorate() Render\n- Section heading 'Professional Summary' (or just 'Summary')\n- Markdown content rendered\n- Click to edit: shows textarea/rich text input\n- Support basic markdown (bold, italic, links)\n\n## Component Picker Integration\n- Add as 'Professional Summary'\n- Icon: DocumentTextIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/SummaryNode.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createSummaryNode(): SummaryNode\n- $isSummaryNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:18:24.015965296-05:00","updated_at":"2025-12-27T13:21:26.879448981-05:00","closed_at":"2025-12-27T13:21:26.879448981-05:00","dependencies":[{"issue_id":"ArcataAI-746.10","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:18:24.016805763-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.10","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:07.338030711-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.11","title":"Create CertificationsNode custom Lexical node","description":"Custom DecoratorNode for certifications section.\n\n## Node: CertificationsNode\nType: 'certifications-section'\nExtends: DecoratorNode\n\n## State Fields\n- entries: Array of Certification\n  - id: string\n  - name: string (e.g., 'AWS Solutions Architect')\n  - issuer: string (e.g., 'Amazon Web Services')\n  - date: string (YYYY-MM)\n  - expirationDate: string | null (optional)\n  - credentialId: string | null (optional)\n  - url: string | null (optional, verification link)\n\n## decorate() Render\n- Section heading 'Certifications'\n- List of certifications\n- Each shows: name, issuer, date (expires: date if set)\n- Optional credential ID and link\n- Add/edit/delete controls\n- Inline editing\n\n## Component Picker Integration\n- Add as 'Certifications'\n- Icon: CheckBadgeIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/CertificationsNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/CertificationEntry.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createCertificationsNode(): CertificationsNode\n- $isCertificationsNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:18:32.414991728-05:00","updated_at":"2025-12-27T16:45:22.567925078-05:00","closed_at":"2025-12-27T16:45:22.567925078-05:00","dependencies":[{"issue_id":"ArcataAI-746.11","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:18:32.41560154-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.11","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:13.612895957-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.12","title":"Create ProjectsNode custom Lexical node","description":"Custom DecoratorNode for projects section.\n\n## Node: ProjectsNode\nType: 'projects-section'\nExtends: DecoratorNode\n\n## State Fields\n- entries: Array of Project\n  - id: string\n  - name: string\n  - description: string (markdown)\n  - url: string | null (project link)\n  - technologies: string[] (tags)\n  - highlights: string[] (bullet points)\n\n## decorate() Render\n- Section heading 'Projects'\n- List of projects\n- Each shows: name (linked if url), description\n- Technologies as tags\n- Highlights as bullet list\n- Add/edit/delete controls\n- Inline editing\n\n## Component Picker Integration\n- Add as 'Projects'\n- Icon: RocketLaunchIcon or CodeBracketIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/ProjectsNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/ProjectEntry.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createProjectsNode(): ProjectsNode\n- $isProjectsNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:18:40.595725635-05:00","updated_at":"2025-12-27T16:45:22.580827317-05:00","closed_at":"2025-12-27T16:45:22.580827317-05:00","dependencies":[{"issue_id":"ArcataAI-746.12","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:18:40.596299044-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.12","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:13.622827437-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.13","title":"Create AwardsNode custom Lexical node","description":"Custom DecoratorNode for awards/achievements section.\n\n## Node: AwardsNode\nType: 'awards-section'\nExtends: DecoratorNode\n\n## State Fields\n- entries: Array of Award\n  - id: string\n  - title: string (e.g., 'Employee of the Year')\n  - issuer: string (e.g., 'Acme Corp')\n  - date: string (YYYY-MM)\n  - description: string | null (optional details)\n\n## decorate() Render\n- Section heading 'Awards \u0026 Achievements'\n- List of awards\n- Each shows: title, issuer, date\n- Optional description\n- Add/edit/delete controls\n- Inline editing\n\n## Component Picker Integration\n- Add as 'Awards \u0026 Achievements'\n- Icon: TrophyIcon or StarIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/AwardsNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/AwardEntry.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createAwardsNode(): AwardsNode\n- $isAwardsNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:18:48.60473634-05:00","updated_at":"2025-12-27T16:45:22.593116869-05:00","closed_at":"2025-12-27T16:45:22.593116869-05:00","dependencies":[{"issue_id":"ArcataAI-746.13","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:18:48.605305872-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.13","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:13.633998866-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.14","title":"Create LanguagesNode custom Lexical node","description":"Custom DecoratorNode for languages section.\n\n## Node: LanguagesNode\nType: 'languages-section'\nExtends: DecoratorNode\n\n## State Fields\n- entries: Array of Language\n  - id: string\n  - language: string (e.g., 'Spanish')\n  - proficiency: string (e.g., 'Fluent', 'Native', 'Conversational', 'Basic')\n\n## decorate() Render\n- Section heading 'Languages'\n- List of languages with proficiency level\n- Simple inline layout (Language - Proficiency)\n- Add/edit/delete controls\n- Dropdown or text for proficiency level\n\n## Component Picker Integration\n- Add as 'Languages'\n- Icon: LanguageIcon or GlobeAltIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/LanguagesNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/LanguageEntry.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createLanguagesNode(): LanguagesNode\n- $isLanguagesNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:18:59.838715692-05:00","updated_at":"2025-12-27T16:45:22.603563675-05:00","closed_at":"2025-12-27T16:45:22.603563675-05:00","dependencies":[{"issue_id":"ArcataAI-746.14","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:18:59.839376854-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.14","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:13.645999336-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.15","title":"Create VolunteerNode custom Lexical node","description":"Custom DecoratorNode for volunteer experience section.\n\n## Node: VolunteerNode\nType: 'volunteer-section'\nExtends: DecoratorNode\n\n## State Fields\n- entries: Array of VolunteerEntry\n  - id: string\n  - organization: string\n  - role: string\n  - startDate: string (YYYY-MM)\n  - endDate: string | null (null = ongoing)\n  - description: string (markdown)\n\n## decorate() Render\n- Section heading 'Volunteer Experience'\n- Similar layout to Experience section\n- Each shows: role @ organization, date range\n- Description below\n- Add/edit/delete controls\n- Inline editing with date pickers\n\n## Component Picker Integration\n- Add as 'Volunteer Experience'\n- Icon: HeartIcon or HandRaisedIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/VolunteerNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/VolunteerEntry.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createVolunteerNode(): VolunteerNode\n- $isVolunteerNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:19:08.324544878-05:00","updated_at":"2025-12-27T16:45:22.615501993-05:00","closed_at":"2025-12-27T16:45:22.615501993-05:00","dependencies":[{"issue_id":"ArcataAI-746.15","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:19:08.325181602-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.15","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:13.657369616-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.16","title":"Create CustomSectionNode custom Lexical node","description":"Custom DecoratorNode for freeform custom sections.\n\n## Node: CustomSectionNode\nType: 'custom-section'\nExtends: DecoratorNode\n\n## State Fields\n- title: string (user-defined section heading)\n- content: string (markdown)\n\n## decorate() Render\n- Editable section heading (user types their own title)\n- Markdown content area\n- Click to edit content\n- Delete section button\n\n## Use Cases\n- References section\n- Publications\n- Hobbies/Interests\n- Any section type we haven't thought of\n\n## Component Picker Integration\n- Add as 'Custom Section'\n- Icon: PlusCircleIcon or DocumentPlusIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/CustomSectionNode.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createCustomSectionNode(): CustomSectionNode\n- $isCustomSectionNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:19:15.71293834-05:00","updated_at":"2025-12-27T16:45:22.627211253-05:00","closed_at":"2025-12-27T16:45:22.627211253-05:00","dependencies":[{"issue_id":"ArcataAI-746.16","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:19:15.713978418-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.16","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:13.66850793-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.17","title":"Create default resume template for new profiles","description":"When creating a new profile, initialize editor with template content.\n\n## Template Structure\nPre-populate new profiles with placeholder sections:\n1. ContactNode - empty fields\n2. SummaryNode - placeholder text 'Write a brief professional summary...'\n3. ExperienceNode - empty entries array\n4. EducationNode - empty entries array\n5. SkillsNode - empty categories array\n\n## Implementation\n- Create getDefaultResumeTemplate() function\n- Returns SerializedEditorState with above nodes\n- Called when creating new profile\n- Store as resume_data on insert\n\n## Location\n- apps/hq/src/components/blocks/editor-00/templates/defaultResumeTemplate.ts\n- Or could be a constant in the profile creation logic\n\n## Notes\n- Template should be valid Lexical state\n- Each node needs proper serialization\n- Test that template loads correctly in editor","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:19:25.579570149-05:00","updated_at":"2025-12-27T13:24:31.874499962-05:00","closed_at":"2025-12-27T13:24:31.874499962-05:00","dependencies":[{"issue_id":"ArcataAI-746.17","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:19:25.580292782-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.17","depends_on_id":"ArcataAI-746.6","type":"blocks","created_at":"2025-12-27T12:20:18.794984423-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.17","depends_on_id":"ArcataAI-746.7","type":"blocks","created_at":"2025-12-27T12:20:18.807784805-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.17","depends_on_id":"ArcataAI-746.8","type":"blocks","created_at":"2025-12-27T12:20:18.827556241-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.17","depends_on_id":"ArcataAI-746.9","type":"blocks","created_at":"2025-12-27T12:20:18.846785361-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.17","depends_on_id":"ArcataAI-746.10","type":"blocks","created_at":"2025-12-27T12:20:18.860044907-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.18","title":"Register all custom nodes in component picker menu","description":"Configure component picker to show all resume section types.\n\n## Component Picker Options\nAdd all custom nodes to the component picker menu (`/` command):\n\n| Label | Node | Icon |\n|-------|------|------|\n| Contact Information | ContactNode | UserCircleIcon |\n| Professional Summary | SummaryNode | DocumentTextIcon |\n| Work Experience | ExperienceNode | BriefcaseIcon |\n| Education | EducationNode | AcademicCapIcon |\n| Skills | SkillsNode | WrenchScrewdriverIcon |\n| Certifications | CertificationsNode | CheckBadgeIcon |\n| Projects | ProjectsNode | RocketLaunchIcon |\n| Awards \u0026 Achievements | AwardsNode | TrophyIcon |\n| Languages | LanguagesNode | GlobeAltIcon |\n| Volunteer Experience | VolunteerNode | HeartIcon |\n| Custom Section | CustomSectionNode | PlusCircleIcon |\n\n## Implementation\n- Modify ComponentPickerMenuPlugin configuration\n- Each option creates corresponding node via $create function\n- Group resume sections together in menu\n- Also include default block format options (paragraph, heading, list, quote)\n\n## Files\n- apps/hq/src/components/blocks/editor-00/plugins.tsx\n- May need custom component picker config file\n\n## Dependencies\n- All custom nodes must be created first\n- @shadcn-editor/component-picker-menu-plugin installed","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:19:48.000568126-05:00","updated_at":"2025-12-27T13:21:26.889366979-05:00","closed_at":"2025-12-27T13:21:26.889366979-05:00","dependencies":[{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:19:48.001163237-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.6","type":"blocks","created_at":"2025-12-27T12:20:25.520188687-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.7","type":"blocks","created_at":"2025-12-27T12:20:25.533308425-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.8","type":"blocks","created_at":"2025-12-27T12:20:25.547663513-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.9","type":"blocks","created_at":"2025-12-27T12:20:25.560244742-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.10","type":"blocks","created_at":"2025-12-27T12:20:25.572260789-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.11","type":"blocks","created_at":"2025-12-27T12:20:25.584947385-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.12","type":"blocks","created_at":"2025-12-27T12:20:25.597019653-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.13","type":"blocks","created_at":"2025-12-27T12:20:25.60970175-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.14","type":"blocks","created_at":"2025-12-27T12:20:25.620811474-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.15","type":"blocks","created_at":"2025-12-27T12:20:25.631480903-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.18","depends_on_id":"ArcataAI-746.16","type":"blocks","created_at":"2025-12-27T12:20:25.643867418-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.2","title":"Install and configure shadcn-editor in hq app","description":"Set up the Lexical-based shadcn-editor with required plugins.\n\n## Installation\n```bash\nnpx shadcn@latest add @shadcn-editor/editor\nnpx shadcn@latest add @shadcn-editor/component-picker-menu-plugin\nnpx shadcn@latest add @shadcn-editor/draggable-block-plugin\nnpx shadcn@latest add @shadcn-editor/block-format-toolbar-plugin\n```\n\n## Configuration\n- Editor will be placed in apps/hq/src/components/editor/ or similar\n- Configure initial plugins.tsx with:\n  - RichTextPlugin\n  - ComponentPickerMenuPlugin\n  - DraggableBlockPlugin\n  - BlockFormatToolbarPlugin\n- Configure nodes.tsx (empty initially, will add custom nodes)\n- Configure editor theme to match app styling\n\n## Files Created\n- apps/hq/src/components/blocks/editor-00/editor.tsx\n- apps/hq/src/components/blocks/editor-00/plugins.tsx\n- apps/hq/src/components/blocks/editor-00/nodes.tsx\n\n## Reference: Existing DnD Kit Usage\nThe project already has @dnd-kit/core installed. Here's existing drag-and-drop list code for reference:\n\n```tsx\nimport {\n  DndContext,\n  type DragEndEvent,\n  rectIntersection,\n  useDraggable,\n  useDroppable,\n} from '@dnd-kit/core';\nimport { restrictToVerticalAxis } from '@dnd-kit/modifiers';\nimport type { ReactNode } from 'react';\nimport { cn } from '@/lib/utils';\n\nexport type ListProviderProps = {\n  children: ReactNode;\n  onDragEnd: (event: DragEndEvent) =\u003e void;\n  className?: string;\n};\n\nexport const ListProvider = ({\n  children,\n  onDragEnd,\n  className,\n}: ListProviderProps) =\u003e (\n  \u003cDndContext\n    collisionDetection={rectIntersection}\n    modifiers={[restrictToVerticalAxis]}\n    onDragEnd={onDragEnd}\n  \u003e\n    \u003cdiv className={cn('flex size-full flex-col', className)}\u003e{children}\u003c/div\u003e\n  \u003c/DndContext\u003e\n);\n\nexport const ListItem = ({\n  id,\n  name,\n  index,\n  parent,\n  children,\n  className,\n}: ListItemProps) =\u003e {\n  const { attributes, listeners, setNodeRef, transform, isDragging } =\n    useDraggable({\n      id,\n      data: { index, parent },\n    });\n  return (\n    \u003cdiv\n      className={cn(\n        'flex cursor-grab items-center gap-2 rounded-md border bg-background p-2 shadow-sm',\n        isDragging \u0026\u0026 'cursor-grabbing',\n        className\n      )}\n      style={{\n        transform: transform\n          ? \\`translateX(\\${transform.x}px) translateY(\\${transform.y}px)\\`\n          : 'none',\n      }}\n      {...listeners}\n      {...attributes}\n      ref={setNodeRef}\n    \u003e\n      {children ?? \u003cp className=\"m-0 font-medium text-sm\"\u003e{name}\u003c/p\u003e}\n    \u003c/div\u003e\n  );\n};\n```\n\nNote: The shadcn-editor draggable-block-plugin may use its own DnD implementation. Check compatibility with existing @dnd-kit usage.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:17:04.268889799-05:00","updated_at":"2025-12-27T12:43:26.348722576-05:00","closed_at":"2025-12-27T12:43:26.348722576-05:00","dependencies":[{"issue_id":"ArcataAI-746.2","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:17:04.269480642-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.2","depends_on_id":"ArcataAI-746.1","type":"blocks","created_at":"2025-12-27T12:20:01.903817637-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.3","title":"Create profile list page with empty state","description":"Build /profiles route showing profile cards or empty state CTA.\n\n## Route Setup\n- Create apps/hq/src/routes/profiles/ProfilesPage.tsx\n- Add route to app router\n\n## Empty State (when no profiles)\n- Centered layout with:\n  - Folder/document icon (SVG)\n  - 'No profiles yet' heading\n  - 'Get started by creating a new profile.' subtext\n  - 'New Profile' button with PlusIcon\n- Use provided template styling (dark mode support)\n\n## Profile Grid (when profiles exist)\n- Grid layout: grid-cols-1 sm:grid-cols-2 lg:grid-cols-3\n- Each card shows:\n  - Profile name as title\n  - Status badge (Draft = yellow, Live = green)\n  - Last updated date as subtitle\n  - View / Edit action buttons at bottom\n- Card styling from provided template (rounded-lg, shadow, divide-y)\n\n## Actions\n- 'New Profile' button: Creates profile with name 'Untitled Profile', navigates to /profiles/:id\n- 'View' button: noop for now (maybe future preview?)\n- 'Edit' button: navigates to /profiles/:id\n\n## Data Fetching\n- Use generateResourceApi pattern from libs/db\n- Fetch job_profiles for current user\n- Order by updated_at desc","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:17:16.426268807-05:00","updated_at":"2025-12-27T12:37:04.155024001-05:00","closed_at":"2025-12-27T12:37:04.155024001-05:00","dependencies":[{"issue_id":"ArcataAI-746.3","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:17:16.427017244-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.3","depends_on_id":"ArcataAI-746.1","type":"blocks","created_at":"2025-12-27T12:20:01.916336051-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.4","title":"Create profile builder page with header","description":"Build /profiles/:id route with centered editor layout and header.\n\n## Route Setup\n- Create apps/hq/src/routes/profiles/ProfileBuilderPage.tsx\n- Create apps/hq/src/routes/profiles/[id]/index.tsx (or appropriate routing pattern)\n- Add route to app router\n\n## Page Layout\n- Clean centered single-column layout\n- Max width container (max-w-4xl or similar)\n- No sidebar\n\n## Header Section\nLeft side:\n- Back button/link to /profiles (arrow icon + 'Profiles')\n- Profile name (inline editable, click to edit or contenteditable)\n\nRight side:\n- Status badge (Draft/Live) - clickable to toggle status\n- 'Download' button (stubbed, shows toast 'Coming soon' or similar)\n- Auto-save indicator: 'Saving...' | 'Saved' | 'Error'\n\n## Header Styling\n- Take cues from invoice example header\n- Gradient/blur decorative background optional\n- Responsive (mobile menu for actions if needed)\n\n## Data\n- Fetch profile by id from job_profiles\n- Handle 404 if profile not found or not owned by user","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:17:27.359877923-05:00","updated_at":"2025-12-27T12:46:38.461170037-05:00","closed_at":"2025-12-27T12:46:38.461170037-05:00","dependencies":[{"issue_id":"ArcataAI-746.4","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:17:27.360507104-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.4","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:01.928909943-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.4","depends_on_id":"ArcataAI-746.3","type":"blocks","created_at":"2025-12-27T12:20:01.941610615-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.5","title":"Implement auto-save for profile editor","description":"Add debounced auto-save that persists editor state to database.\n\n## Behavior\n- Debounce: 2 seconds after last change\n- Save resume_data as SerializedEditorState JSON\n- Update updated_at timestamp (handled by DB trigger)\n\n## UI Feedback\n- 'Saving...' - while save in progress\n- 'Saved' - on successful save (show for 2s then fade or persist)\n- 'Error saving' - on failure (with retry option?)\n\n## Implementation\n- Use Lexical OnChangePlugin to detect changes\n- Debounce with setTimeout or useDebouncedCallback hook\n- Call job_profiles.update(id, { resume_data: serializedState })\n- Track save status in component state\n\n## Edge Cases\n- Don't save if no changes\n- Cancel pending save on unmount\n- Handle concurrent saves (last write wins is fine for v1)\n- Warn on navigation with unsaved changes? (optional for v1)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:17:37.890467209-05:00","updated_at":"2025-12-27T12:47:40.078829408-05:00","closed_at":"2025-12-27T12:47:40.078829408-05:00","dependencies":[{"issue_id":"ArcataAI-746.5","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:17:37.890963718-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.5","depends_on_id":"ArcataAI-746.4","type":"blocks","created_at":"2025-12-27T12:20:07.280528631-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.6","title":"Create ContactNode custom Lexical node","description":"Custom DecoratorNode for contact information section.\n\n## Node: ContactNode\nType: 'contact-section'\nExtends: DecoratorNode\n\n## State Fields (using createState)\n- name: string\n- email: string\n- phone: string\n- location: string (city, state or similar)\n- linkedIn: string (URL)\n- portfolio: string (URL)\n- github: string (URL)\n\n## decorate() Render\nReact component with:\n- Editable fields for each property\n- Clean layout (name prominent, other fields in grid/row)\n- Icons for email, phone, links\n- Inline editing (click to edit each field)\n\n## Component Picker Integration\n- Add to component picker menu as 'Contact Information'\n- Icon: UserCircleIcon or similar\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/ContactNode.tsx\n- Register in nodes.tsx\n- Add to component picker options\n\n## Utilities\n- $createContactNode(): ContactNode\n- $isContactNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:17:48.663523816-05:00","updated_at":"2025-12-27T13:21:26.83977327-05:00","closed_at":"2025-12-27T13:21:26.83977327-05:00","dependencies":[{"issue_id":"ArcataAI-746.6","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:17:48.664073089-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.6","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:07.293179733-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.7","title":"Create ExperienceNode custom Lexical node","description":"Custom DecoratorNode for work experience section.\n\n## Node: ExperienceNode\nType: 'experience-section'\nExtends: DecoratorNode\n\n## State Fields\n- entries: Array of ExperienceEntry\n  - id: string (for React key)\n  - company: string\n  - title: string\n  - location: string\n  - startDate: string (YYYY-MM format)\n  - endDate: string | null (null = current)\n  - current: boolean\n  - highlights: string[] (bullet points, markdown)\n\n## decorate() Render\nReact component with:\n- Section heading 'Experience'\n- List of experience entries\n- Each entry shows: title @ company, location, date range\n- Highlights as bullet list\n- Add entry button\n- Edit/delete entry buttons\n- Inline editing for each field\n- Date picker for dates\n- Checkbox for 'current' (disables endDate)\n\n## Component Picker Integration\n- Add as 'Work Experience'\n- Icon: BriefcaseIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/ExperienceNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/ExperienceEntry.tsx (render component)\n- Register in nodes.tsx\n\n## Utilities\n- $createExperienceNode(): ExperienceNode\n- $isExperienceNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:17:58.750821887-05:00","updated_at":"2025-12-27T13:21:26.850034919-05:00","closed_at":"2025-12-27T13:21:26.850034919-05:00","dependencies":[{"issue_id":"ArcataAI-746.7","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:17:58.751496447-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.7","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:07.304831579-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.8","title":"Create EducationNode custom Lexical node","description":"Custom DecoratorNode for education section.\n\n## Node: EducationNode\nType: 'education-section'\nExtends: DecoratorNode\n\n## State Fields\n- entries: Array of EducationEntry\n  - id: string\n  - institution: string\n  - degree: string (e.g., 'Bachelor of Science')\n  - field: string (e.g., 'Computer Science')\n  - startDate: string (YYYY-MM)\n  - endDate: string (YYYY-MM)\n  - gpa: string | null (optional)\n  - honors: string | null (optional, e.g., 'Magna Cum Laude')\n\n## decorate() Render\n- Section heading 'Education'\n- List of education entries\n- Each entry: degree in field, institution, date range\n- Optional GPA and honors display\n- Add/edit/delete entry controls\n- Inline editing\n\n## Component Picker Integration\n- Add as 'Education'\n- Icon: AcademicCapIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/EducationNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/EducationEntry.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createEducationNode(): EducationNode\n- $isEducationNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:18:07.193169879-05:00","updated_at":"2025-12-27T13:21:26.860521836-05:00","closed_at":"2025-12-27T13:21:26.860521836-05:00","dependencies":[{"issue_id":"ArcataAI-746.8","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:18:07.193876973-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.8","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:07.315937591-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-746.9","title":"Create SkillsNode custom Lexical node","description":"Custom DecoratorNode for skills section.\n\n## Node: SkillsNode\nType: 'skills-section'\nExtends: DecoratorNode\n\n## State Fields\n- categories: Array of SkillCategory\n  - id: string\n  - category: string (e.g., 'Languages', 'Frameworks', 'Tools')\n  - items: string[] (e.g., ['TypeScript', 'Python', 'Go'])\n\n## decorate() Render\n- Section heading 'Skills'\n- Grouped by category\n- Each category shows label + comma-separated or tag-style items\n- Add category button\n- Add item to category (inline input)\n- Remove item (x button on tag)\n- Edit category name\n- Delete category\n\n## Component Picker Integration\n- Add as 'Skills'\n- Icon: WrenchScrewdriverIcon or SparklesIcon\n\n## Files\n- apps/hq/src/components/blocks/editor-00/nodes/SkillsNode.tsx\n- apps/hq/src/components/blocks/editor-00/nodes/SkillCategory.tsx\n- Register in nodes.tsx\n\n## Utilities\n- $createSkillsNode(): SkillsNode\n- $isSkillsNode(node): boolean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:18:16.18181358-05:00","updated_at":"2025-12-27T13:21:26.869704381-05:00","closed_at":"2025-12-27T13:21:26.869704381-05:00","dependencies":[{"issue_id":"ArcataAI-746.9","depends_on_id":"ArcataAI-746","type":"parent-child","created_at":"2025-12-27T12:18:16.182776438-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-746.9","depends_on_id":"ArcataAI-746.2","type":"blocks","created_at":"2025-12-27T12:20:07.326802369-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-7ne","title":"Implement Track Job button functionality","description":"The 'Track Job' button in JobDetailPanel is currently disabled and does nothing.\n\n**Current state:**\n- Button is `disabled` in JobDetailPanel.tsx (line 159-165)\n- JobStreamPage has a TODO placeholder: `handleTrack` does nothing (line 242-244)\n\n**Expected:**\n- Clicking Track Job should create a job_application record\n- Move the job from the stream to the user's tracking board\n- Update UI to reflect the tracked state\n\n**Files:**\n- apps/hq/src/routes/jobs/JobDetailPanel.tsx (lines 159-165)\n- apps/hq/src/routes/job-stream/JobStreamPage.tsx (lines 242-244)\n\n**API needed:**\n- POST /api/v1/applications or similar to create tracking entry","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T15:17:49.452145052-05:00","updated_at":"2025-12-23T15:17:49.452145052-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-7ne","depends_on_id":"ArcataAI-eh7","type":"related","created_at":"2025-12-23T15:59:34.86387716-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-7ob","title":"Standalone Company ETL Workflow: Resolve company data holistically from company URL","description":"Create a standalone workflow for company enrichment that can:\n- Accept company URL directly (vs extracting from job URL)\n- Perform full company ETL: extract company page, transform/normalize data, load to DB\n- Be more thorough in data gathering than the inline job pipeline version\n- Handle different input types (job URL vs company URL) to determine enrichment strategy\n\nRelated to the existing CompanyResolver step which does inline company resolution during job ingestion.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-27T11:15:33.238637457-05:00","updated_at":"2025-12-27T11:15:33.238637457-05:00"}
{"id":"ArcataAI-8ep","title":"Auto-Apply Wizard: Browser extension for automated job applications","description":"Browser extension that auto-fills job applications using stored profile data. Requires job_site_automations table to store CSS selectors mapped to profile fields. Should support 'learning' new sites when user flags missing fields.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-26T17:21:55.172608525-05:00","updated_at":"2025-12-26T17:21:55.172608525-05:00"}
{"id":"ArcataAI-8h8","title":"Fix CORS issue in Scala API for UI requests","description":"The HQ frontend is hitting CORS errors when calling the Scala API. Need to add CORS headers to allow cross-origin requests from the UI.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T10:25:38.341818084-05:00","updated_at":"2025-12-23T10:28:35.034770756-05:00","closed_at":"2025-12-23T10:28:35.034770756-05:00"}
{"id":"ArcataAI-977","title":"Refactor: Extract data sanitization from SupabaseClient into ETL JobTransformer step","description":"Move data sanitization logic out of SupabaseClient into a dedicated ETL transformation step, following the Extractor ‚Üí Transformer ‚Üí Loader pattern.\n\n## Background\nCurrently SupabaseClient.writeJobForInsert() filters empty timestamp strings (lines 164-166), but the client should be 'dumb' - all data normalization/sanitization should happen in ETL steps.\n\n## Approach\n- Create a generic Transformed[A] wrapper type for compile-time safety\n- Add JobTransformer step between JobExtractor and CompanyResolver\n- Update downstream steps to accept Transformed[ExtractedJobData]\n- Remove sanitization from SupabaseClient\n\n## Pipeline Flow\nBefore: JobExtractor ‚Üí CompanyResolver ‚Üí JobLoader\nAfter:  JobExtractor ‚Üí JobTransformer ‚Üí CompanyResolver ‚Üí JobLoader\n\n## Key Design Decisions\n- Transformer never fails (best-effort cleaning)\n- Validation stays in Loader (final gate before persistence)\n- Transformed[A] wrapper ensures type safety without duplicating types\n- Pattern is reusable for future transformers","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-27T12:29:12.619961466-05:00","updated_at":"2025-12-27T12:52:34.440357171-05:00","closed_at":"2025-12-27T12:52:34.440357171-05:00"}
{"id":"ArcataAI-977.1","title":"Create Transformed[A] wrapper in ETL framework","description":"Create a generic wrapper type that indicates data has been through a transformation step.\n\n## File\napps/api/src/main/scala/arcata/api/etl/framework/Transformed.scala\n\n## Implementation\n```scala\npackage arcata.api.etl.framework\n\n/**\n * Wrapper indicating data has been through a transformation step.\n * Provides compile-time safety that raw extracted data can't bypass transformation.\n */\nfinal case class Transformed[A](value: A)\n```\n\n## Purpose\n- Type safety: compiler enforces pipeline ordering\n- No type duplication: ExtractedJobData remains single source of truth\n- Reusable: pattern works for future transformers (e.g., Transformed[CompanyData])","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:29:22.330933098-05:00","updated_at":"2025-12-27T12:52:34.421220231-05:00","closed_at":"2025-12-27T12:52:34.421220231-05:00","dependencies":[{"issue_id":"ArcataAI-977.1","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:29:22.331530568-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-977.2","title":"Create JobTransformer ETL step","description":"Create the new transformation step that sanitizes ExtractedJobData.\n\n## File\napps/api/src/main/scala/arcata/api/etl/steps/JobTransformer.scala\n\n## Input/Output\n- Input: JobTransformerInput(extracted: ExtractedJobData, sourceUrl: String)\n- Output: JobTransformerOutput(transformed: Transformed[ExtractedJobData], sourceUrl: String)\n\n## Behavior\n- Never fails (always returns Right)\n- Best-effort sanitization\n\n## Initial Sanitization Rules\n- sanitizeString: trim whitespace, empty string ‚Üí None\n- sanitizeList: remove empty entries from lists\n- Apply to all Option[String] fields\n- Pass through Int/Boolean fields unchanged\n\n## Expandability\nStructure allows easy addition of future rules:\n- URL validation/normalization\n- Date format normalization  \n- Enum value standardization","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:29:31.946668063-05:00","updated_at":"2025-12-27T12:52:34.422163616-05:00","closed_at":"2025-12-27T12:52:34.422163616-05:00","dependencies":[{"issue_id":"ArcataAI-977.2","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:29:31.947226487-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.2","depends_on_id":"ArcataAI-977.1","type":"blocks","created_at":"2025-12-27T12:30:53.040444097-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-977.3","title":"Update CompanyResolver to accept Transformed[ExtractedJobData]","description":"Modify CompanyResolver input/output types to work with transformed data.\n\n## File\napps/api/src/main/scala/arcata/api/etl/steps/CompanyResolver.scala\n\n## Changes\n1. Update import to include Transformed\n2. CompanyResolverInput: extractedData: ExtractedJobData ‚Üí Transformed[ExtractedJobData]\n3. CompanyResolverOutput: extractedData: ExtractedJobData ‚Üí Transformed[ExtractedJobData]\n4. Access fields via .value (e.g., input.extractedData.value.companyName)\n\n## Lines Affected\n- Line 6: Add Transformed import\n- Line 14-15: Input case class\n- Line 22-23: Output case class  \n- Line 76: Field access for companyName\n- Lines 67, 110: Output construction","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:29:40.648517289-05:00","updated_at":"2025-12-27T12:52:34.422977109-05:00","closed_at":"2025-12-27T12:52:34.422977109-05:00","dependencies":[{"issue_id":"ArcataAI-977.3","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:29:40.649124548-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.3","depends_on_id":"ArcataAI-977.1","type":"blocks","created_at":"2025-12-27T12:30:53.052150526-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-977.4","title":"Update JobLoader to accept Transformed[ExtractedJobData]","description":"Modify JobLoader input type to work with transformed data.\n\n## File\napps/api/src/main/scala/arcata/api/etl/steps/JobLoader.scala\n\n## Changes\n1. Update import to include Transformed\n2. JobLoaderInput: extractedData: ExtractedJobData ‚Üí Transformed[ExtractedJobData]\n3. Access all 17+ fields via .value (e.g., input.extractedData.value.title)\n\n## Field Access Updates\nAll field mappings in execute() need .value:\n- title, description, location, jobType\n- experienceLevel, educationLevel\n- salaryMin, salaryMax, salaryCurrency\n- qualifications, preferredQualifications\n- responsibilities, benefits, category\n- applicationUrl, isRemote\n- postedDate, closingDate","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:29:49.235783357-05:00","updated_at":"2025-12-27T12:52:34.424217388-05:00","closed_at":"2025-12-27T12:52:34.424217388-05:00","dependencies":[{"issue_id":"ArcataAI-977.4","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:29:49.236400505-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.4","depends_on_id":"ArcataAI-977.1","type":"blocks","created_at":"2025-12-27T12:30:53.064662191-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-977.5","title":"Integrate JobTransformer into JobIngestionPipeline","description":"Wire the new JobTransformer step into the pipeline.\n\n## File\napps/api/src/main/scala/arcata/api/etl/JobIngestionPipeline.scala\n\n## Changes\n1. Import JobTransformer, JobTransformerInput, JobTransformerOutput\n2. Instantiate JobTransformer in pipeline\n3. Insert between JobExtractor and CompanyResolver\n\n## Pipeline Flow Update\nBefore:\n  JobExtractor output ‚Üí CompanyResolverInput\n\nAfter:\n  JobExtractor output ‚Üí JobTransformerInput\n  JobTransformer output ‚Üí CompanyResolverInput\n\n## Wiring\n- JobTransformerInput(extracted = extractorOutput.extractedData, sourceUrl = ...)\n- CompanyResolverInput(extractedData = transformerOutput.transformed, ...)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:29:57.99924077-05:00","updated_at":"2025-12-27T12:52:34.42493732-05:00","closed_at":"2025-12-27T12:52:34.42493732-05:00","dependencies":[{"issue_id":"ArcataAI-977.5","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:29:57.9998534-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.5","depends_on_id":"ArcataAI-977.2","type":"blocks","created_at":"2025-12-27T12:30:53.076279346-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.5","depends_on_id":"ArcataAI-977.3","type":"blocks","created_at":"2025-12-27T12:30:53.087885388-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.5","depends_on_id":"ArcataAI-977.4","type":"blocks","created_at":"2025-12-27T12:30:53.100172033-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-977.6","title":"Remove sanitization from SupabaseClient","description":"Remove the data sanitization logic from SupabaseClient - it now happens in JobTransformer.\n\n## File\napps/api/src/main/scala/arcata/api/clients/SupabaseClient.scala\n\n## Changes\nLines 164-166, change from:\n```scala\n// Filter out empty strings for timestamp fields - PostgreSQL expects valid timestamps or null\njob.postedDate.filter(_.nonEmpty).foreach(v =\u003e obj(\"posted_date\") = v)\njob.closingDate.filter(_.nonEmpty).foreach(v =\u003e obj(\"closing_date\") = v)\n```\n\nTo:\n```scala\njob.postedDate.foreach(v =\u003e obj(\"posted_date\") = v)\njob.closingDate.foreach(v =\u003e obj(\"closing_date\") = v)\n```\n\n## Purpose\nClient should be 'dumb' - just serialize and send. All sanitization now happens in ETL layer.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:30:07.333786365-05:00","updated_at":"2025-12-27T12:52:34.425890433-05:00","closed_at":"2025-12-27T12:52:34.425890433-05:00","dependencies":[{"issue_id":"ArcataAI-977.6","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:30:07.334413703-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.6","depends_on_id":"ArcataAI-977.5","type":"blocks","created_at":"2025-12-27T12:30:53.11149453-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-977.7","title":"Update JobLoaderSuite tests for Transformed wrapper","description":"Update existing tests to wrap ExtractedJobData in Transformed.\n\n## File\napps/api/src/test/scala/arcata/api/etl/steps/JobLoaderSuite.scala\n\n## Changes\nWrap all ExtractedJobData instances in Transformed():\n\nLines 37, 66-70, 90, 113 - change from:\n```scala\nExtractedJobData(title = \"...\")\n```\n\nTo:\n```scala\nTransformed(ExtractedJobData(title = \"...\"))\n```\n\n## Import\nAdd: import arcata.api.etl.framework.Transformed","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:30:15.395933088-05:00","updated_at":"2025-12-27T12:52:34.42662799-05:00","closed_at":"2025-12-27T12:52:34.42662799-05:00","dependencies":[{"issue_id":"ArcataAI-977.7","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:30:15.396488015-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.7","depends_on_id":"ArcataAI-977.4","type":"blocks","created_at":"2025-12-27T12:30:53.12336504-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-977.8","title":"Add JobTransformerSuite tests","description":"Create tests for the new JobTransformer step.\n\n## File\napps/api/src/test/scala/arcata/api/etl/steps/JobTransformerSuite.scala\n\n## Test Cases\n1. Trims whitespace from string fields\n2. Converts empty strings to None\n3. Converts whitespace-only strings to None\n4. Preserves valid non-empty strings\n5. Removes empty entries from lists\n6. Passes through Int fields unchanged\n7. Passes through Boolean fields unchanged\n8. Never fails (always returns Right)\n9. Output is wrapped in Transformed\n\n## Pattern\nFollow existing test patterns in JobLoaderSuite, BaseStepSuite","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:30:23.552782573-05:00","updated_at":"2025-12-27T12:52:34.427679193-05:00","closed_at":"2025-12-27T12:52:34.427679193-05:00","dependencies":[{"issue_id":"ArcataAI-977.8","depends_on_id":"ArcataAI-977","type":"parent-child","created_at":"2025-12-27T12:30:23.553430091-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-977.8","depends_on_id":"ArcataAI-977.2","type":"blocks","created_at":"2025-12-27T12:30:53.135320888-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-9bx","title":"Wire up AccountSettings delete account functionality","description":"Add confirmation dialog and connect handleDeleteAccount to delete user account via Supabase","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T11:34:15.7672182-05:00","updated_at":"2025-12-27T22:12:32.034390038-05:00","closed_at":"2025-12-27T22:12:32.034390038-05:00"}
{"id":"ArcataAI-9bx.1","title":"Add deleteAccount function to @arcata/db auth library","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:37:30.879316675-05:00","updated_at":"2025-12-27T22:12:04.816504257-05:00","closed_at":"2025-12-27T22:12:04.816504257-05:00","dependencies":[{"issue_id":"ArcataAI-9bx.1","depends_on_id":"ArcataAI-9bx","type":"parent-child","created_at":"2025-12-27T12:37:30.879897471-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-9bx.2","title":"Add confirmation dialog to AccountSettings","description":"Use HeadlessUI Dialog with red warning styling, cancel/delete buttons","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T12:37:36.856450548-05:00","updated_at":"2025-12-27T22:12:28.329520585-05:00","closed_at":"2025-12-27T22:12:28.329520585-05:00","dependencies":[{"issue_id":"ArcataAI-9bx.2","depends_on_id":"ArcataAI-9bx","type":"parent-child","created_at":"2025-12-27T12:37:36.857141459-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-9bx.2","depends_on_id":"ArcataAI-9bx.1","type":"blocks","created_at":"2025-12-27T12:37:49.450707948-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-9bx.2","depends_on_id":"ArcataAI-9bx.3","type":"blocks","created_at":"2025-12-27T12:37:56.306031643-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-9bx.3","title":"Add delete dialog translations to en.json","description":"Add pages.account.deleteDialog.* and pages.account.notifications.deleteError","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T12:37:42.819430388-05:00","updated_at":"2025-12-27T22:12:06.021987416-05:00","closed_at":"2025-12-27T22:12:06.021987416-05:00","dependencies":[{"issue_id":"ArcataAI-9bx.3","depends_on_id":"ArcataAI-9bx","type":"parent-child","created_at":"2025-12-27T12:37:42.819822064-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-9jy","title":"Add PDF/JSON export to profile builder","description":"Export resume as PDF for job applications. Also consider JSON export for backup/import. Stub out the Download action in UI for now. Reference: react-pdf, puppeteer, or server-side generation options.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-27T11:34:04.916723375-05:00","updated_at":"2025-12-29T09:01:03.472284108-05:00","closed_at":"2025-12-29T09:01:03.472289679-05:00","dependencies":[{"issue_id":"ArcataAI-9jy","depends_on_id":"ArcataAI-746","type":"related","created_at":"2025-12-27T12:20:53.671749956-05:00","created_by":"daemon"}],"comments":[{"id":1,"issue_id":"ArcataAI-9jy","author":"matsilva","text":"## Implementation Plan\n\n**Approach:** Client-side PDF generation with @react-pdf/renderer\n\n### Tasks:\n1. Install @react-pdf/renderer in libs/components\n2. Create PDF document component (ResumePDF) that renders resume sections\n3. Create PDF section components for each node type (Contact, Summary, Experience, etc.)\n4. Add generateResumePDF utility function to extract data from Lexical editor state\n5. Wire up Download button in ProfileBuilderPage with loading state\n6. Test with sample profile data\n\n### Design Decisions:\n- Simple, clean single-column layout for v1\n- Immediate download on click (no modal)\n- Button loading state while generating\n- Filename: {profile-name}-resume.pdf\n\n### Future enhancements (not in scope):\n- JSON export for backup\n- Multiple resume templates\n- Preview before download","created_at":"2025-12-28T22:14:57Z"}]}
{"id":"ArcataAI-adp","title":"Update package.json license field","description":"Change license field from 'MIT' to 'SEE LICENSE.md' to reflect the O'Saasy license.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-22T18:40:10.632742613-05:00","updated_at":"2025-12-22T18:42:32.352676129-05:00","closed_at":"2025-12-22T18:42:32.352676129-05:00"}
{"id":"ArcataAI-aio","title":"Wire up AccountSettings save profile functionality","description":"Connect handleSaveProfile to update user metadata in Supabase (first name, last name, username, timezone)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T11:34:13.650133119-05:00","updated_at":"2025-12-27T12:24:44.257512037-05:00","closed_at":"2025-12-27T12:24:44.257512037-05:00"}
{"id":"ArcataAI-bcb","title":"Add API key auth to job ingestion endpoint","description":"Allow /api/v1/jobs/ingest to accept both JWT and API key auth. When authenticated via API key (profileId=service), skip job stream and application creation - only save job and company to database.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-03T17:57:15.901032103-05:00","updated_at":"2026-01-03T18:04:46.008939696-05:00","closed_at":"2026-01-03T18:04:46.008939696-05:00","dependencies":[{"issue_id":"ArcataAI-bcb","depends_on_id":"ArcataAI-cnj","type":"blocks","created_at":"2026-01-03T17:57:21.598954259-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-cnj","title":"Refactor CronRoutes to use @authenticated decorator","description":"Replace manual X-Cron-Secret validation with standard @authenticated(Vector(AuthType.ApiKey)) decorator. Remove cronSecret constructor parameter and use API_KEYS env var as single source of truth.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-03T17:57:14.467880224-05:00","updated_at":"2026-01-03T18:02:03.527632975-05:00","closed_at":"2026-01-03T18:02:03.527632975-05:00"}
{"id":"ArcataAI-d10","title":"Refactor data sanitization out of SupabaseClient into ETL layer","description":"Currently filtering empty timestamp strings in writeJobForInsert(), but the client should be 'dumb' - all data normalization/sanitization should happen in ETL steps before reaching the client.\n\nLocation: apps/api/src/main/scala/arcata/api/clients/SupabaseClient.scala:164-165\n\nThe fix added .filter(_.nonEmpty) for postedDate/closingDate, but this logic belongs in the ETL layer (e.g., JobLoader or a dedicated sanitization step).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T15:07:55.022343021-05:00","updated_at":"2025-12-27T12:31:43.708039469-05:00","closed_at":"2025-12-27T12:31:43.708039469-05:00","labels":["architecture","refactor"]}
{"id":"ArcataAI-dnp","title":"Fix Scalafix working directory in build.sc","description":"The `fixCheck` and `fix` tasks in build.sc are running in the wrong directory.\n\n**Error:**\n```\nCannot run program \"cs\" (in directory \"/home/matsilva/code/silvabyte/ArcataAI/apps/api/api\"): error=2, No such file or directory\n```\n\n**Problem:**\nThe `cwd` is set to `millSourcePath` which resolves to `apps/api/api` instead of `apps/api`.\n\n**File:** apps/api/build.sc\n\n**Fix:**\nChange `cwd = millSourcePath` to `cwd = millSourcePath / os.up` in the fix/fixCheck tasks (around lines 71 and 92).","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-23T09:31:59.394314855-05:00","updated_at":"2025-12-27T12:30:06.708950959-05:00","closed_at":"2025-12-27T12:30:06.708950959-05:00"}
{"id":"ArcataAI-eh7","title":"Job Detail Panel \u0026 Track Job Feature","description":"Epic for implementing the full job detail panel UI and track job functionality.\n\nGoals:\n- Display full job details in side panel after ingestion\n- Allow users to track jobs (add to kanban board)\n- Shared components: Toast notifications, Spinner, Skeleton UI\n\nRelated Issues:\n- ArcataAI-4bh: Wire up JobDetailPanel to fetch and display actual job data\n- ArcataAI-7ne: Implement Track Job button functionality","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-23T15:57:50.66214012-05:00","updated_at":"2025-12-23T16:19:35.310702399-05:00","closed_at":"2025-12-23T16:19:35.310706658-05:00","labels":["feature","frontend"]}
{"id":"ArcataAI-eh7.1","title":"Create Toast notification system","description":"Create a reusable toast notification system in the shared components library.\n\nLocation: libs/components/src/lib/toast/\n\nComponents needed:\n- ToastProvider.tsx - Context provider with state management for showing/hiding toasts\n- Toast.tsx - Individual toast component using Headless UI Transition\n- useToast.ts - Hook for triggering toasts from anywhere in the app\n- index.ts - Exports\n\nFeatures:\n- Support types: success, error, warning, info\n- Auto-dismiss after configurable timeout (default 5s)\n- Position: top-right on all screen sizes\n- Dark mode support\n- Close button\n\nTemplate provided by user uses @headlessui/react Transition component.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:57:58.195509842-05:00","updated_at":"2025-12-23T16:07:51.801156852-05:00","closed_at":"2025-12-23T16:07:51.801165589-05:00","labels":["component","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.1","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:57:58.196187148-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.10","title":"Wire up Track button in Job Stream cards","description":"Connect the Track button in Job Stream cards to useTrackJob hook.\n\nFiles:\n- apps/hq/src/routes/job-stream/JobCard/JobCardActions.tsx\n- apps/hq/src/routes/job-stream/JobStreamPage.tsx\n\nChanges to JobStreamPage.tsx:\n- Update query to include application_id from job_stream\n- Pass application_id to JobCard components\n- Implement handleTrack using useTrackJob\n\nChanges to JobCardActions.tsx:\n- Accept isTracked and isTracking props\n- Show 'Tracked' (disabled) when isTracked is true\n- Show Spinner when isTracking is true\n\nBehavior:\n- Same as JobDetailPanel Track button\n- On success: show toast, update card state\n- On error: show error toast","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:59:05.299544294-05:00","updated_at":"2025-12-23T16:18:35.113437033-05:00","closed_at":"2025-12-23T16:18:35.113446882-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.10","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:59:05.300615821-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.10","depends_on_id":"ArcataAI-eh7.8","type":"blocks","created_at":"2025-12-23T15:59:29.586599932-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.10","depends_on_id":"ArcataAI-eh7.2","type":"blocks","created_at":"2025-12-23T15:59:29.598316967-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.10","depends_on_id":"ArcataAI-eh7.1","type":"blocks","created_at":"2025-12-23T15:59:29.610904865-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.11","title":"Update exports in libs/components","description":"Update the main index.ts in libs/components to export new components.\n\nFile: libs/components/src/lib/index.ts\n\nAdd exports for:\n- Toast components (ToastProvider, Toast, useToast)\n- Spinner component\n- Skeleton component\n\nEnsure all new components are properly exported from the library.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:59:10.370342694-05:00","updated_at":"2025-12-23T16:18:35.127651094-05:00","closed_at":"2025-12-23T16:18:35.127655783-05:00","labels":["chore","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.11","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:59:10.371596678-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.11","depends_on_id":"ArcataAI-eh7.1","type":"blocks","created_at":"2025-12-23T15:59:29.624480656-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.11","depends_on_id":"ArcataAI-eh7.2","type":"blocks","created_at":"2025-12-23T15:59:29.637498696-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.11","depends_on_id":"ArcataAI-eh7.3","type":"blocks","created_at":"2025-12-23T15:59:29.650953721-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.2","title":"Create Spinner/Loader component","description":"Create a reusable spinner component for loading states.\n\nLocation: libs/components/src/lib/spinner/\n\nComponents needed:\n- Spinner.tsx - Spinning circle SVG component\n- index.ts - Exports\n\nProps:\n- size: 'sm' | 'md' | 'lg' or number\n- className: for custom styling/colors\n\nUsage: Inline in buttons during async operations, standalone loading indicators.\n\nUses animate-spin Tailwind class.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:04.373221075-05:00","updated_at":"2025-12-23T16:07:51.815785971-05:00","closed_at":"2025-12-23T16:07:51.815792724-05:00","labels":["component","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.2","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:04.37387763-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.3","title":"Create Skeleton UI components","description":"Create reusable skeleton components for loading states.\n\nLocation: libs/components/src/lib/skeleton/\n\nComponents needed:\n- Skeleton.tsx - Base skeleton component with animate-pulse\n- index.ts - Exports\n\nProps:\n- variant: 'text' | 'circular' | 'rectangular'\n- width: string | number\n- height: string | number\n- className: for custom styling\n\nUses animate-pulse Tailwind class and bg-gray-200 for the shimmer effect.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:11.723802984-05:00","updated_at":"2025-12-23T16:07:51.831004933-05:00","closed_at":"2025-12-23T16:07:51.831010805-05:00","labels":["component","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.3","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:11.72446515-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.4","title":"Add application_id FK to job_stream table","description":"Create migration to add application_id foreign key to job_stream table.\n\nFile: supabase/migrations/20241223000011_add_application_id_to_job_stream.sql\n\nChanges:\n- Add application_id BIGINT column (nullable)\n- Add foreign key constraint to job_applications(application_id)\n- Add index on application_id for query performance\n\nThis allows tracking which jobs in the stream have been added to the user's application tracker.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:17.378083612-05:00","updated_at":"2025-12-23T16:07:51.846238744-05:00","closed_at":"2025-12-23T16:07:51.846244946-05:00","labels":["database","migration"],"dependencies":[{"issue_id":"ArcataAI-eh7.4","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:17.379135841-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.5","title":"Create job detail types and data fetching hook","description":"Create TypeScript types and Supabase data fetching for job details.\n\nFiles:\n- apps/hq/src/routes/jobs/types.ts - Full JobDetail type\n- apps/hq/src/routes/jobs/useJobDetail.ts - React hook for fetching\n\nJobDetail type should include all fields from jobs table:\n- jobId, companyId, title, description, location\n- jobType, category, experienceLevel, educationLevel\n- salaryMin, salaryMax, salaryCurrency\n- qualifications, preferredQualifications, responsibilities\n- sourceUrl, applicationUrl, isRemote\n- postedDate, closingDate\n- companyName (joined from companies table)\n\nuseJobDetail hook:\n- Takes jobId: number | null\n- Fetches from Supabase with company join\n- Returns { data, isLoading, error }\n- Uses Supabase JS client (RLS enabled)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:25.667855148-05:00","updated_at":"2025-12-23T16:11:11.979232379-05:00","closed_at":"2025-12-23T16:11:11.979239383-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.5","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:25.66886285-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.6","title":"Rewrite JobDetailPanel component with new design","description":"Rewrite the JobDetailPanel component with the new design layout.\n\nFile: apps/hq/src/routes/jobs/JobDetailPanel.tsx\n\nLayout:\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ [Company Name]                                      ‚îÇ\n‚îÇ [Job Title]                        [üî• Track] [X]   ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ [üìÅ] Category  ‚îÇ  [üìç] Location  ‚îÇ  [üîó] Job URL    ‚îÇ\n‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§\n‚îÇ Description                                         ‚îÇ\n‚îÇ [text... More]                                      ‚îÇ\n‚îÇ                                                     ‚îÇ\n‚îÇ Qualifications                                      ‚îÇ\n‚îÇ ‚Ä¢ item 1                                            ‚îÇ\n‚îÇ ‚Ä¢ item 2                                            ‚îÇ\n‚îÇ                                                     ‚îÇ\n‚îÇ Responsibilities                                    ‚îÇ\n‚îÇ ‚Ä¢ item 1                                            ‚îÇ\n‚îÇ ‚Ä¢ item 2                                            ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n\nFeatures:\n- Track button: FiyaIcon (flame) + 'Track' label (top right)\n- Skeleton loading state while fetching\n- Description with expandable 'More' for long text\n- Qualifications as bullet list\n- Responsibilities as bullet list\n- Metadata row: Category, Location, Job URL link\n- Close button (X)\n\nStates:\n- Loading: Skeleton UI\n- Loaded: Full content\n- Tracked: Track button disabled, shows 'Tracked'\n\ni18n: Add all text to locales/en.json","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:36.461446465-05:00","updated_at":"2025-12-23T16:16:25.017143174-05:00","closed_at":"2025-12-23T16:16:25.017152673-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.6","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:36.462340675-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.6","depends_on_id":"ArcataAI-eh7.3","type":"blocks","created_at":"2025-12-23T15:59:29.482990028-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.6","depends_on_id":"ArcataAI-eh7.5","type":"blocks","created_at":"2025-12-23T15:59:29.496772674-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.7","title":"Update HQ.tsx to use new JobDetailPanel","description":"Update HQ.tsx to properly integrate with the new JobDetailPanel.\n\nFile: apps/hq/src/routes/hq/HQ.tsx\n\nChanges:\n- Remove hardcoded panelJobData state\n- Pass only jobId to JobDetailPanel (panel fetches its own data)\n- Panel handles its own loading state\n- After tracking success, refresh the kanban/applications query\n- Wrap app with ToastProvider if not already done at root level","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:43.171898034-05:00","updated_at":"2025-12-23T16:16:25.047259539-05:00","closed_at":"2025-12-23T16:16:25.047266984-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.7","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:43.173235691-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.7","depends_on_id":"ArcataAI-eh7.1","type":"blocks","created_at":"2025-12-23T15:59:29.509747519-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.7","depends_on_id":"ArcataAI-eh7.6","type":"blocks","created_at":"2025-12-23T15:59:29.522370476-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.8","title":"Create useTrackJob hook","description":"Create a React hook for tracking jobs (adding to application board).\n\nFile: apps/hq/src/routes/jobs/useTrackJob.ts\n\nHook signature:\nuseTrackJob() =\u003e {\n  trackJob: (jobId: number, streamId: number) =\u003e Promise\u003cvoid\u003e,\n  isTracking: boolean\n}\n\nLogic:\n1. Query application_statuses for current user, order by status_order, get first\n2. Insert into job_applications with status_id, job_id, profile_id\n3. Update job_stream set application_id = new application ID\n4. Return success/throw error\n\nUses Supabase JS client (RLS - user manages their own data).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:50.867430743-05:00","updated_at":"2025-12-23T16:11:11.992449143-05:00","closed_at":"2025-12-23T16:11:11.992457329-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.8","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:50.868368117-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.8","depends_on_id":"ArcataAI-eh7.4","type":"blocks","created_at":"2025-12-23T15:59:29.535501657-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-eh7.9","title":"Wire up Track button in JobDetailPanel","description":"Connect the Track button in JobDetailPanel to useTrackJob hook.\n\nFile: apps/hq/src/routes/jobs/JobDetailPanel.tsx\n\nBehavior:\n- Track button calls trackJob(jobId, streamId)\n- Shows Spinner while isTracking is true\n- On success: show success toast, close panel\n- On error: show error toast, keep panel open\n- If already tracked (application_id exists): button disabled, shows 'Tracked'\n\nButton states:\n- Default: FiyaIcon + 'Track' (enabled)\n- Loading: Spinner + 'Track' (disabled)\n- Tracked: FiyaIcon + 'Tracked' (disabled, different style)\n\ni18n: Add toast messages to locales/en.json","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:58:58.04292082-05:00","updated_at":"2025-12-23T16:16:25.032215374-05:00","closed_at":"2025-12-23T16:16:25.032222117-05:00","labels":["feature","frontend"],"dependencies":[{"issue_id":"ArcataAI-eh7.9","depends_on_id":"ArcataAI-eh7","type":"parent-child","created_at":"2025-12-23T15:58:58.043769691-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.9","depends_on_id":"ArcataAI-eh7.8","type":"blocks","created_at":"2025-12-23T15:59:29.548154643-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.9","depends_on_id":"ArcataAI-eh7.2","type":"blocks","created_at":"2025-12-23T15:59:29.561255265-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-eh7.9","depends_on_id":"ArcataAI-eh7.1","type":"blocks","created_at":"2025-12-23T15:59:29.574037814-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-fen","title":"Add architecture diagram maintenance rule to AGENTS.md","description":"Add section to AGENTS.md instructing AI agents to keep architecture diagrams in sync when modifying system topology. Reference docs/architecture.md and apps/api/README.md diagrams.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-22T18:40:12.528576224-05:00","updated_at":"2025-12-22T18:42:50.802277545-05:00","closed_at":"2025-12-22T18:42:50.802277545-05:00"}
{"id":"ArcataAI-jmt","title":"Wire up AccountSettings logout functionality","description":"Connect handleLogout to Supabase signOut() and redirect to login page","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T11:34:15.044115402-05:00","updated_at":"2025-12-27T12:24:44.973337006-05:00","closed_at":"2025-12-27T12:24:44.973337006-05:00"}
{"id":"ArcataAI-l49","title":"Refactor domain models to use SnakePickle for automatic snake_case conversion","description":"## Problem\n\nCurrently, each domain model (Company, Job, JobStreamEntry, JobApplication) has a verbose custom `ReadWriter` that manually maps each field between camelCase (Scala) and snake_case (Supabase/PostgreSQL). This is error-prone, hard to maintain, and duplicates logic.\n\n## Solution\n\nUse uPickle's built-in `objectAttributeKeyReadMap` and `objectAttributeKeyWriteMap` hooks to create a custom `SnakePickle` object that automatically handles the conversion.\n\n## Implementation\n\n### 1. Create SnakePickle utility\nLocation: `apps/api/src/main/scala/arcata/api/json/SnakePickle.scala`\n\n```scala\npackage arcata.api.json\n\nobject SnakePickle extends upickle.AttributeTagged {\n  // camelCase -\u003e snake_case\n  private def camelToSnake(s: String): String = {\n    s.replaceAll(\"([A-Z])\", \"_$1\").toLowerCase.stripPrefix(\"_\")\n  }\n  \n  // snake_case -\u003e camelCase\n  private def snakeToCamel(s: String): String = {\n    val parts = s.split(\"_\", -1)\n    if (parts.isEmpty) s\n    else parts.head + parts.tail.map(_.capitalize).mkString\n  }\n\n  override def objectAttributeKeyReadMap(s: CharSequence): CharSequence =\n    snakeToCamel(s.toString)\n    \n  override def objectAttributeKeyWriteMap(s: CharSequence): CharSequence =\n    camelToSnake(s.toString)\n}\n```\n\n### 2. Update domain models\nRemove custom ReadWriter implementations, use `derives SnakePickle.ReadWriter`:\n\n```scala\npackage arcata.api.domain\n\nimport arcata.api.json.SnakePickle.{ReadWriter, macroRW}\n\nfinal case class Company(\n  companyId: Option[Long] = None,\n  companyName: Option[String] = None,\n  // ... other fields\n)\n\nobject Company:\n  given ReadWriter[Company] = macroRW\n```\n\n### 3. Update SupabaseClient\nImport SnakePickle instead of upickle.default:\n\n```scala\nimport arcata.api.json.SnakePickle.{read, write}\n// Instead of: import upickle.default.*\n```\n\n### 4. Keep upickle.default for non-Supabase JSON\nSome models (ExtractedJobData, ExtractedCompanyData) are used with BoogieLoops AI which expects camelCase. These should continue using `upickle.default`.\n\n## Files to modify\n\n1. **Create**: `apps/api/src/main/scala/arcata/api/json/SnakePickle.scala`\n2. **Simplify**: `apps/api/src/main/scala/arcata/api/domain/Company.scala`\n3. **Simplify**: `apps/api/src/main/scala/arcata/api/domain/Job.scala`\n4. **Simplify**: `apps/api/src/main/scala/arcata/api/domain/JobStreamEntry.scala`\n5. **Simplify**: `apps/api/src/main/scala/arcata/api/domain/JobApplication.scala`\n6. **Update**: `apps/api/src/main/scala/arcata/api/clients/SupabaseClient.scala`\n\n## Benefits\n- ~200 lines of boilerplate removed\n- Single source of truth for case conversion\n- New fields automatically handled\n- Less error-prone\n- Easier to add new domain models\n\n## Testing\n- Ensure all existing tests pass\n- Verify Company insert returns companyId\n- Verify Job insert returns jobId\n- End-to-end test of job ingestion pipeline\n\n## Acceptance Criteria\n- [ ] SnakePickle utility created and tested\n- [ ] All domain models simplified to use macroRW\n- [ ] SupabaseClient uses SnakePickle for Supabase models\n- [ ] All 53 tests pass\n- [ ] Job ingestion pipeline works end-to-end","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T14:49:33.093694863-05:00","updated_at":"2025-12-23T14:49:33.093694863-05:00","labels":["api","refactor"]}
{"id":"ArcataAI-lbq","title":"Remove docs/plans/ directory","description":"Delete the docs/plans/ directory. Planning now lives in bd CLI. Remove 2025-12-22-migration-to-arcata-ai.md and the plans/ folder.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-22T18:39:59.689120305-05:00","updated_at":"2025-12-22T18:40:42.482487766-05:00","closed_at":"2025-12-22T18:40:42.482487766-05:00"}
{"id":"ArcataAI-rag","title":"Fix Scala compilation errors in API","description":"The API fails to compile with 11 errors after the recent ETL rework.\n\n## Errors:\n\n1. **ProgressEmitter syntax in for-comprehension** (JobIngestionPipeline.scala:81,123)\n   - `_ = progressEmitter.emit(...)` invalid in Scala 3 for-comprehension\n\n2. **SchemaError import not found** (JobExtractionAgent.scala:7, CompanyEnrichmentAgent.scala:7)\n   - `boogieloops.schema.SchemaError` doesn't exist\n\n3. **.message not a member of Any** (JobParser.scala:53, CompanyResolver.scala:82)\n   - Error types inferred as Any","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-23T09:32:18.94705359-05:00","updated_at":"2025-12-24T14:00:20.898963793-05:00","closed_at":"2025-12-24T14:00:20.898963793-05:00"}
{"id":"ArcataAI-rag.1","title":"Fix ProgressEmitter calls in for-comprehension","description":"Lines 81 and 123 use invalid syntax `_ = progressEmitter.emit(...)`. Move emit calls outside the for-comprehension.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-23T09:32:25.702125355-05:00","updated_at":"2025-12-24T14:00:20.910535024-05:00","closed_at":"2025-12-24T14:00:20.910535024-05:00","dependencies":[{"issue_id":"ArcataAI-rag.1","depends_on_id":"ArcataAI-rag","type":"parent-child","created_at":"2025-12-23T09:32:25.703180902-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-rag.2","title":"Fix SchemaError import in AI agents","description":"Import `boogieloops.schema.SchemaError` doesn't exist. Find correct error type from BoogieLoops AI library.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-23T09:32:25.717690104-05:00","updated_at":"2025-12-24T14:00:20.922923406-05:00","closed_at":"2025-12-24T14:00:20.922923406-05:00","dependencies":[{"issue_id":"ArcataAI-rag.2","depends_on_id":"ArcataAI-rag","type":"parent-child","created_at":"2025-12-23T09:32:25.718335928-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-rag.3","title":"Fix .message access on Any type","description":"In JobParser.scala:53 and CompanyResolver.scala:82, error types are inferred as Any. Add type annotations or use toString.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-23T09:32:25.73201289-05:00","updated_at":"2025-12-24T14:00:20.934697783-05:00","closed_at":"2025-12-24T14:00:20.934697783-05:00","dependencies":[{"issue_id":"ArcataAI-rag.3","depends_on_id":"ArcataAI-rag","type":"parent-child","created_at":"2025-12-23T09:32:25.732614919-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-s91","title":"AI Profile+ Feature: Generate personalized cover letters and resumes","description":"Leverage AI to generate personalized cover letters and resumes by analyzing job descriptions and matching them with the candidate's profile, skills, and experiences. Enhances application quality with tailored documents.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-26T17:21:52.251917334-05:00","updated_at":"2025-12-26T17:21:52.251917334-05:00"}
{"id":"ArcataAI-uq9","title":"Company Discovery Workflow","description":"## Overview\n\nWorkflow to discover and validate new companies to add to the companies database.\n\n## Problem\n\nThe system needs a growing database of companies with job boards to be useful. This workflow automates company discovery from various sources.\n\n## Potential Sources\n\n1. **YC company directory** (ycombinator.com/companies) - high quality tech companies\n2. **Crunchbase API** (requires API key) - comprehensive company data\n3. **LinkedIn company search** - large coverage but may have ToS restrictions\n4. **AngelList/Wellfound** - startup focused\n5. **GitHub trending organizations** - open source companies\n6. **Manual curation / community contributions** - curated lists\n7. **Job board scraping** - extract company info from job postings\n\n## Data to Capture\n\nPer company:\n- `company_name`\n- `company_domain`\n- `company_jobs_url` (if discoverable)\n- `company_jobs_source` (ATS type if detected)\n- `company_linkedin_url`\n- `primary_industry`\n- `company_city`, `company_state`\n\n## Future Tasks (to be planned)\n\n- [ ] Research data sources and their terms of service\n- [ ] Design company validation pipeline (verify domain, dedupe)\n- [ ] Implement discovery workflow for first source\n- [ ] Handle deduplication with existing companies (by domain)\n- [ ] Integrate ATS detection (what job board does this company use?)\n\n## Relationship\n\n- **Related:** Greenhouse Company Discovery Workflow (specific ATS detection)\n- **Related:** Company Enrichment Workflow (ArcataAI-7ob) - enriches existing companies\n- **Enables:** Job Discovery Collector Service (ArcataAI-5er) - needs companies to discover jobs from","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-02T11:12:02.939045389-05:00","updated_at":"2026-01-02T11:12:02.939045389-05:00"}
{"id":"ArcataAI-vms","title":"Fix Supabase JWT authentication - invalid service role key format","description":"SupabaseClient sends invalid JWT to Supabase. Error: Expected 3 parts in JWT; got 1. The service role key may not be loaded correctly from env.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T13:23:58.38350008-05:00","updated_at":"2025-12-27T12:30:06.698034813-05:00","closed_at":"2025-12-27T12:30:06.698034813-05:00"}
{"id":"ArcataAI-web","title":"Greenhouse Company Discovery Workflow","description":"## Overview\n\nWorkflow to discover companies that use Greenhouse ATS and populate their `company_jobs_url` and `company_jobs_source` fields.\n\n## Problem\n\nThe JobDiscoveryWorkflow (ArcataAI-5er) requires companies to already have `company_jobs_source = 'greenhouse'` and a valid `company_jobs_url`. This workflow finds and populates that data.\n\n## Potential Approaches\n\n1. **Search engine discovery**: Use search APIs to find `boards.greenhouse.io/*` and `job-boards.greenhouse.io/*` URLs\n2. **Known company lists**: Scrape YC, tech company directories for Greenhouse users\n3. **Manual curation**: Community-contributed list of Greenhouse URLs\n4. **Reverse lookup**: Start with known company domains, try common ATS URL patterns\n5. **Greenhouse sitemap**: Check if Greenhouse publishes a sitemap of boards\n\n## Greenhouse URL Patterns\n\nKnown patterns to search for:\n- `https://boards.greenhouse.io/{company}`\n- `https://job-boards.greenhouse.io/{company}`\n- `https://{company}.greenhouse.io` (less common)\n\n## Future Tasks (to be planned)\n\n- [ ] Research best discovery approach\n- [ ] Implement discovery logic\n- [ ] Create workflow to update companies table\n- [ ] Handle URL validation (ensure board exists and returns 200)\n- [ ] Deduplicate against existing companies\n\n## Relationship\n\n- **Enables:** ArcataAI-5er (Job Discovery Collector Service) - needs companies with Greenhouse URLs to be useful\n- **Related:** Company Discovery Workflow (general company discovery)","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-02T11:11:48.059505681-05:00","updated_at":"2026-01-02T11:11:48.059505681-05:00"}
{"id":"ArcataAI-xzo","title":"Config-Driven Job Extraction System","description":"Replace monolithic HTML cleaner with a config-driven extraction system that learns and improves over time.\n\n## Vision\n- Extraction configs define how to find and map job data from HTML\n- Configs are matched to pages via patterns (CSS selectors, URL patterns)\n- When no config matches, AI generates a new config\n- AI refines configs in a retry loop (up to 3 attempts) until extraction is complete/sufficient\n- Configs are saved to database for deterministic future extractions\n\n## Key Properties\n1. Starts dumb, gets smarter - Initially relies on AI, learns deterministic configs over time\n2. Config as knowledge - Database of configs becomes institutional knowledge\n3. Efficiency compounds - More jobs = more configs = less AI needed\n4. Human-auditable - Configs are inspectable, not black-box AI\n\n## Architecture\nSee docs/plans/ for detailed architecture diagrams\n\n## Success Criteria\n- Netflix job URL extracts complete job data (title, description, salary, qualifications)\n- System saves working configs to database\n- Future Netflix jobs use saved config (no AI needed)\n- Partial extractions are saved with appropriate CompletionState","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-12-24T09:55:35.415677926-05:00","updated_at":"2025-12-24T14:00:20.946946854-05:00","closed_at":"2025-12-24T14:00:20.946946854-05:00"}
{"id":"ArcataAI-xzo.1","title":"Define CompletionState enum and scoring system","description":"Create the CompletionState enum and weighted scoring system for evaluating extraction quality.\n\n## CompletionState Enum\n```scala\nenum CompletionState:\n  case Complete    // 90%+ score - all weighted fields extracted\n  case Sufficient  // 70-90% score - required + enough optional\n  case Partial     // 50-70% score - some fields, missing important ones\n  case Minimal     // \u003c50% but has required - title, company only\n  case Failed      // Missing required fields\n```\n\n## Weighted Scoring\n| Field | Weight | Required |\n|-------|--------|----------|\n| title | 20 | Yes |\n| company_name | 15 | Yes |\n| description | 25 | Yes |\n| location | 10 | No |\n| salary_min/max | 10 | No |\n| qualifications | 5 | No |\n| responsibilities | 5 | No |\n| benefits | 5 | No |\n| job_type | 3 | No |\n| experience_level | 2 | No |\n\n## Validation Rules\n- Required fields must be non-empty\n- Fields must have min_length \u003e 4-5 chars (not too rigid)\n- Score = sum of weights for extracted fields / total possible\n\n## Files to Create\n- `apps/api/src/main/scala/arcata/api/extraction/CompletionState.scala`\n- `apps/api/src/main/scala/arcata/api/extraction/CompletionScorer.scala`\n\n## Tests\n- Test scoring with various field combinations\n- Test threshold boundaries (89% vs 90%, etc.)\n- Test empty/whitespace handling","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:55:47.387264197-05:00","updated_at":"2025-12-24T10:20:30.764607847-05:00","closed_at":"2025-12-24T10:20:30.764607847-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.1","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:55:47.387898686-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.10","title":"Create seed config for Schema.org JSON-LD JobPosting","description":"Create a default extraction config for pages with Schema.org JSON-LD JobPosting data.\n\n## Why\nMany job sites (Netflix, LinkedIn, Indeed) include Schema.org structured data.\nThis is the most reliable extraction source when present.\n\n## Config\n```yaml\nname: 'Schema.org JSON-LD JobPosting'\nversion: 1\ncreated_by: 'manual'\n\nmatch:\n  - type: css_exists\n    selector: \"script[type='application/ld+json']\"\n    content_contains: 'JobPosting'\n\nextract:\n  title:\n    - source: jsonld\n      path: $.title\n  \n  description:\n    - source: jsonld\n      path: $.description\n      transform: html_decode\n  \n  company_name:\n    - source: jsonld\n      path: $.hiringOrganization.name\n  \n  location:\n    - source: jsonld\n      path: $.jobLocation[0].address.addressLocality\n    - source: jsonld\n      path: $.jobLocation.address.addressLocality\n  \n  salary_min:\n    - source: jsonld\n      path: $.baseSalary.value.minValue\n    - source: jsonld\n      path: $.baseSalary.minValue\n  \n  salary_max:\n    - source: jsonld\n      path: $.baseSalary.value.maxValue\n    - source: jsonld\n      path: $.baseSalary.maxValue\n  \n  salary_currency:\n    - source: jsonld\n      path: $.baseSalary.currency\n  \n  job_type:\n    - source: jsonld\n      path: $.employmentType\n  \n  posted_date:\n    - source: jsonld\n      path: $.datePosted\n  \n  closing_date:\n    - source: jsonld\n      path: $.validThrough\n  \n  application_url:\n    - source: jsonld\n      path: $.url\n```\n\n## Deliverable\n- Create migration to insert seed config\n- Or: Create seed SQL file\n- Test against Netflix URL","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T09:57:59.39554768-05:00","updated_at":"2025-12-24T14:00:20.984414159-05:00","closed_at":"2025-12-24T14:00:20.984414159-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.10","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:57:59.396192549-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.10","depends_on_id":"ArcataAI-xzo.7","type":"blocks","created_at":"2025-12-24T09:58:27.860038332-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.11","title":"Add completion_state column to jobs table","description":"Track the extraction completion state for each job in the database.\n\n## Why\n- Know which jobs have complete data vs partial\n- Enable background job to retry incomplete extractions\n- Show UI indicators for data quality\n\n## Migration\n```sql\nALTER TABLE jobs\nADD COLUMN completion_state TEXT DEFAULT 'unknown';\n\nALTER TABLE jobs\nADD COLUMN extraction_config_id UUID REFERENCES extraction_configs(id);\n\nCREATE INDEX idx_jobs_completion_state ON jobs(completion_state);\n```\n\n## Values\n- 'complete' - All important fields extracted\n- 'sufficient' - Enough for user value\n- 'partial' - Missing some important fields\n- 'minimal' - Only basic fields\n- 'failed' - Extraction failed\n- 'unknown' - Legacy jobs before this feature\n\n## UI Considerations\n- Could show indicator on job cards\n- Could filter by completion state\n- Out of scope for this task, but consider\n\n## Files\n- `supabase/migrations/YYYYMMDD_add_job_completion_state.sql`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T09:58:08.239779096-05:00","updated_at":"2025-12-24T14:00:20.996316104-05:00","closed_at":"2025-12-24T14:00:20.996316104-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.11","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:58:08.240458913-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.11","depends_on_id":"ArcataAI-xzo.8","type":"blocks","created_at":"2025-12-24T09:58:27.871210043-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.12","title":"Write architecture documentation for config-driven extraction","description":"Document the config-driven extraction system architecture.\n\n## Location\n`docs/plans/YYYY-MM-DD-config-driven-extraction.md`\n\n## Contents\n\n### Overview\n- Problem statement (Netflix missing data)\n- Solution vision (config-driven, self-improving)\n\n### Architecture Diagrams\n- Main flow diagram (from our discussion)\n- AI Config Generator detail diagram\n- Data model diagram\n\n### Config Schema\n- Full schema documentation\n- Match pattern types\n- Extract rule types\n- Transform types\n\n### Completion Scoring\n- Field weights table\n- State thresholds\n- Examples\n\n### Database Schema\n- extraction_configs table\n- Indexes\n- RLS policies\n\n### API Changes\n- New pipeline steps\n- Input/output types\n\n### Future Considerations\n- Background retry job for partial extractions\n- A/B testing configs\n- Manual config editing UI\n- Config sharing between instances\n\n## Update existing docs\n- `docs/architecture.md` - add extraction system\n- `apps/api/README.md` - update pipeline diagram","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T09:58:18.797799971-05:00","updated_at":"2025-12-24T14:00:21.008457936-05:00","closed_at":"2025-12-24T14:00:21.008457936-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.12","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:58:18.798403018-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.2","title":"Create extraction_configs database table and migration","description":"Create the database schema for storing extraction configs.\n\n## Schema\n```sql\nCREATE TABLE extraction_configs (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  name TEXT NOT NULL,\n  version INTEGER NOT NULL DEFAULT 1,\n  \n  -- Matching\n  match_patterns JSONB NOT NULL,  -- Array of match rules\n  match_hash TEXT NOT NULL,       -- Hash of patterns for quick lookup\n  \n  -- Extraction rules\n  extract_rules JSONB NOT NULL,\n  \n  -- Metadata\n  completion_state TEXT NOT NULL DEFAULT 'unknown',\n  times_used INTEGER DEFAULT 0,\n  times_succeeded INTEGER DEFAULT 0,\n  last_used_at TIMESTAMPTZ,\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW(),\n  created_by TEXT,  -- 'ai' or 'manual'\n  \n  -- For debugging/improvement\n  sample_url TEXT,\n  sample_extraction JSONB,\n  \n  UNIQUE(match_hash, version)\n);\n\nCREATE INDEX idx_extraction_configs_match_hash ON extraction_configs(match_hash);\nCREATE INDEX idx_extraction_configs_completion ON extraction_configs(completion_state);\n```\n\n## RLS Policies\n- Service role can read/write all configs\n- Authenticated users can read configs (for transparency)\n- Only service role can create/update\n\n## Files\n- `supabase/migrations/YYYYMMDD_create_extraction_configs.sql`\n\n## Considerations\n- match_hash should be deterministic (sorted, normalized)\n- JSONB columns for flexibility\n- version field for A/B testing later","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:55:58.80524536-05:00","updated_at":"2025-12-24T10:21:21.58050855-05:00","closed_at":"2025-12-24T10:21:21.58050855-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.2","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:55:58.806143654-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.3","title":"Define ExtractionConfig domain model and JSON schema","description":"Create the Scala domain model for extraction configs with JSON serialization.\n\n## Config Schema Structure\n```yaml\nid: uuid\nname: string\nversion: integer\n\nmatch:  # 1 or more patterns (all must match)\n  - type: css_exists | url_pattern | content_contains\n    selector: string (for css_exists)\n    pattern: string (for url_pattern, content_contains)\n    content_contains: string (optional, for css_exists)\n\nextract:  # Field extraction rules\n  \u003cfield_name\u003e:\n    - source: jsonld | css | meta | regex\n      path: string (JSONPath for jsonld)\n      selector: string (CSS selector)\n      name: string (meta tag name)\n      pattern: string (regex with capture group)\n      transform: html_decode | inner_html | inner_text | regex:\u003cpattern\u003e | parse_number | split:\u003cdelim\u003e:\u003cidx\u003e | json_parse\n```\n\n## Scala Models\n```scala\ncase class ExtractionConfig(\n  id: UUID,\n  name: String,\n  version: Int,\n  matchPatterns: Seq[MatchPattern],\n  extractRules: Map[String, Seq[ExtractRule]],\n  completionState: CompletionState,\n  timesUsed: Int,\n  timesSucceeded: Int,\n  createdBy: String,\n  sampleUrl: Option[String]\n)\n\nsealed trait MatchPattern\ncase class CssExists(selector: String, contentContains: Option[String]) extends MatchPattern\ncase class UrlPattern(pattern: String) extends MatchPattern\ncase class ContentContains(pattern: String) extends MatchPattern\n\nsealed trait ExtractRule\ncase class JsonLdRule(path: String, transform: Option[Transform]) extends ExtractRule\ncase class CssRule(selector: String, transform: Option[Transform]) extends ExtractRule\ncase class MetaRule(name: String, transform: Option[Transform]) extends ExtractRule\ncase class RegexRule(selector: String, pattern: String, transform: Option[Transform]) extends ExtractRule\n\nenum Transform:\n  case HtmlDecode\n  case InnerHtml\n  case InnerText\n  case Regex(pattern: String)\n  case ParseNumber\n  case Split(delimiter: String, index: Int)\n  case JsonParse\n```\n\n## Files\n- `apps/api/src/main/scala/arcata/api/extraction/ExtractionConfig.scala`\n- `apps/api/src/main/scala/arcata/api/extraction/MatchPattern.scala`\n- `apps/api/src/main/scala/arcata/api/extraction/ExtractRule.scala`\n- `apps/api/src/main/scala/arcata/api/extraction/Transform.scala`\n\n## JSON Serialization\n- Use upickle for serialization\n- Support reading from DB JSONB columns\n- Validate on parse (invalid configs should fail loudly)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:56:16.540081052-05:00","updated_at":"2025-12-24T10:22:48.887303883-05:00","closed_at":"2025-12-24T10:22:48.887303883-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.3","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:56:16.54071989-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.3","depends_on_id":"ArcataAI-xzo.1","type":"blocks","created_at":"2025-12-24T09:58:27.714166383-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.4","title":"Implement ConfigMatcher - find matching configs for a page","description":"Create the ConfigMatcher that finds the best matching extraction config for a given URL + HTML.\n\n## Responsibilities\n1. Load all configs from database\n2. For each config, evaluate all match patterns against URL + HTML\n3. Return configs sorted by specificity (most patterns matched first)\n4. Tie-breaker: most recent (latest updated_at)\n\n## Matching Logic\n```scala\ntrait ConfigMatcher:\n  def findMatch(url: String, html: String): Option[ExtractionConfig]\n  def findAllMatches(url: String, html: String): Seq[ExtractionConfig]\n```\n\n## Pattern Evaluation\n- **css_exists**: Use jsoup to check if selector matches any elements\n  - If content_contains specified, check element text/html contains string\n- **url_pattern**: Regex match against URL\n- **content_contains**: Check if HTML contains string (case-insensitive)\n\n## Specificity Scoring\n- Count number of patterns that must match\n- More patterns = more specific = higher priority\n- Example: config with 3 patterns beats config with 1 pattern\n\n## Caching Considerations\n- Configs don't change often - consider in-memory cache\n- Cache invalidation on config create/update\n- For now: simple DB query each time (optimize later)\n\n## Files\n- `apps/api/src/main/scala/arcata/api/extraction/ConfigMatcher.scala`\n- `apps/api/src/main/scala/arcata/api/extraction/PatternEvaluator.scala`\n\n## Tests\n- Test each pattern type individually\n- Test specificity ordering\n- Test tie-breaker by date\n- Test no match returns None","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:56:28.602492543-05:00","updated_at":"2025-12-24T10:24:47.008592356-05:00","closed_at":"2025-12-24T10:24:47.008592356-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.4","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:56:28.603188402-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.4","depends_on_id":"ArcataAI-xzo.2","type":"blocks","created_at":"2025-12-24T09:58:27.725743396-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.4","depends_on_id":"ArcataAI-xzo.3","type":"blocks","created_at":"2025-12-24T09:58:27.737668728-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.5","title":"Implement DeterministicExtractor - apply config to extract data","description":"Create the DeterministicExtractor that applies an ExtractionConfig to HTML and returns structured job data.\n\n## Responsibilities\n1. Take ExtractionConfig + HTML as input\n2. For each field in extract_rules, try each rule in order\n3. First rule that produces non-empty result wins\n4. Apply transforms to extracted values\n5. Return ExtractedJobData + CompletionState\n\n## Extraction Sources\n\n### jsonld\n- Find all `\u003cscript type=\"application/ld+json\"\u003e` tags\n- Parse JSON, find object with `@type: JobPosting`\n- Use **JsonPathTraverser** (created in xzo.9) to extract value\n\n### css\n- Use jsoup to select elements\n- Get text content or innerHTML based on transform\n\n### meta\n- Find `\u003cmeta name=\"X\"\u003e` or `\u003cmeta property=\"X\"\u003e`\n- Return content attribute value\n\n### regex\n- Select element with CSS selector (or use whole document)\n- Apply regex pattern, return first capture group\n\n## Transform Pipeline\nEach transform modifies the extracted value:\n- **html_decode**: Decode \u0026amp; ‚Üí \u0026, etc.\n- **inner_html**: Get innerHTML (default for css)\n- **inner_text**: Get text only, strip tags\n- **regex:\u003cpattern\u003e**: Apply regex, return first capture\n- **parse_number**: Remove non-numeric, parse to number\n- **split:\u003cdelim\u003e:\u003cidx\u003e**: Split string, return nth element\n- **json_parse**: Parse as JSON (for embedded JSON strings)\n\n## Interface\n```scala\ntrait DeterministicExtractor:\n  def extract(config: ExtractionConfig, html: String, url: String): ExtractionResult\n\ncase class ExtractionResult(\n  data: ExtractedJobData,\n  completionState: CompletionState,\n  score: Double,\n  missingFields: Seq[String],\n  extractedFields: Map[String, String]  // For debugging\n)\n```\n\n## Dependencies\n- JsonPathTraverser (completed in xzo.9)\n- CompletionState and scoring (xzo.1)\n- ExtractionConfig domain models (xzo.3)\n\n## Files\n- `apps/api/src/main/scala/arcata/api/extraction/DeterministicExtractor.scala`\n- `apps/api/src/main/scala/arcata/api/extraction/SourceExtractor.scala` (jsonld, css, meta, regex)\n- `apps/api/src/main/scala/arcata/api/extraction/TransformPipeline.scala`\n\n## Tests\n- Test each source type\n- Test each transform\n- Test fallback (first rule fails, second succeeds)\n- Test with real Netflix HTML","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:56:47.877045503-05:00","updated_at":"2025-12-24T10:28:58.03084419-05:00","closed_at":"2025-12-24T10:28:58.03084419-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.5","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:56:47.877695052-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.5","depends_on_id":"ArcataAI-xzo.3","type":"blocks","created_at":"2025-12-24T09:58:27.749831102-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.5","depends_on_id":"ArcataAI-xzo.9","type":"blocks","created_at":"2025-12-24T09:58:27.762735065-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.6","title":"Implement AI ConfigGenerator with retry loop","description":"Create the AI-powered config generator that analyzes HTML and creates extraction configs.\n\n## Flow (see architecture diagram)\n```\nHTML + URL\n    ‚îÇ\n    ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Attempt 1        ‚îÇ\n‚îÇ Generate Config  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ AI Agent analyzes page structure\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Apply Config     ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ Use DeterministicExtractor\n‚îÇ (extract data)   ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Evaluate         ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ Complete/Sufficient ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∫ Return\n‚îÇ Completeness     ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    Config + Data\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº (Incomplete + attempts \u003c 3)\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Attempt N        ‚îÇ\n‚îÇ Refine Config    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ Context: 'Missing: description,\n‚îÇ with feedback    ‚îÇ      salary. Found empty at path X'\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n         ‚îÇ\n         ‚ñº\n     (loop back to Apply Config)\n\nAfter 3 attempts:\n‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n‚îÇ Return best      ‚îÇ\n‚îÇ config + data    ‚îÇ\n‚îÇ with completion  ‚îÇ\n‚îÇ state (may be    ‚îÇ\n‚îÇ Partial/Minimal) ‚îÇ\n‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n```\n\n## AI Agent Prompt Design\n\n### Initial Generation Prompt\n- Provide: URL, HTML (truncated if needed), list of target fields\n- Ask AI to:\n  1. Identify data sources (JSON-LD, meta tags, visible content, embedded JSON)\n  2. Create match patterns that would identify this page type\n  3. Create extract rules for each target field\n  4. Return as structured ExtractionConfig JSON\n\n### Refinement Prompt\n- Provide: Previous config, extraction result, missing fields\n- Context: 'Field X was empty. The selector returned no elements.'\n- Ask AI to:\n  1. Analyze why extraction failed\n  2. Suggest alternative selectors/paths\n  3. Return updated config\n\n## Max Attempts: 3\n- Track best result across attempts\n- Return best even if not Complete\n- Always save config to DB (with appropriate completion_state)\n\n## Interface\n```scala\ntrait ConfigGenerator:\n  def generate(url: String, html: String): ConfigGenerationResult\n\ncase class ConfigGenerationResult(\n  config: ExtractionConfig,\n  data: ExtractedJobData,\n  completionState: CompletionState,\n  attempts: Int\n)\n```\n\n## Files\n- `apps/api/src/main/scala/arcata/api/extraction/ConfigGenerator.scala`\n- `apps/api/src/main/scala/arcata/api/ai/ConfigGeneratorAgent.scala`\n\n## Tests\n- Mock AI responses for testing\n- Test retry loop with improving responses\n- Test max attempts reached\n- Test saving partial results","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:57:08.268897051-05:00","updated_at":"2025-12-24T11:09:11.289258467-05:00","closed_at":"2025-12-24T11:09:11.289258467-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.6","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:57:08.269431123-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.6","depends_on_id":"ArcataAI-xzo.5","type":"blocks","created_at":"2025-12-24T09:58:27.775226983-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.7","title":"Create ExtractionConfigRepository for DB operations","description":"Create the repository for CRUD operations on extraction_configs table.\n\n## Responsibilities\n- Save new configs\n- Update existing configs (increment version)\n- Find configs by match patterns\n- Update usage stats (times_used, times_succeeded, last_used_at)\n- List configs by completion_state\n\n## Interface\n```scala\ntrait ExtractionConfigRepository:\n  def save(config: ExtractionConfig): Either[Error, ExtractionConfig]\n  def findByMatchHash(hash: String): Either[Error, Option[ExtractionConfig]]\n  def findAll(): Either[Error, Seq[ExtractionConfig]]\n  def incrementUsage(id: UUID, succeeded: Boolean): Either[Error, Unit]\n  def createNewVersion(config: ExtractionConfig): Either[Error, ExtractionConfig]\n```\n\n## Match Hash Generation\n- Deterministic hash of match patterns\n- Sort patterns before hashing\n- Use consistent JSON serialization\n- SHA-256 or similar\n\n## Version Management\n- When creating new version: copy config, increment version\n- Old versions remain in DB (for rollback/comparison)\n- findByMatchHash returns latest version only\n\n## Files\n- `apps/api/src/main/scala/arcata/api/extraction/ExtractionConfigRepository.scala`\n- `apps/api/src/main/scala/arcata/api/extraction/MatchHasher.scala`\n\n## Tests\n- Test save and retrieve\n- Test version increment\n- Test usage stats update\n- Test match hash consistency","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:57:18.097084366-05:00","updated_at":"2025-12-24T14:00:20.958850261-05:00","closed_at":"2025-12-24T14:00:20.958850261-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.7","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:57:18.097763842-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.7","depends_on_id":"ArcataAI-xzo.2","type":"blocks","created_at":"2025-12-24T09:58:27.786658832-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.7","depends_on_id":"ArcataAI-xzo.3","type":"blocks","created_at":"2025-12-24T09:58:27.798808392-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.8","title":"Integrate extraction system into JobIngestionPipeline","description":"Replace the current HtmlCleaner + JobParser with the new config-driven extraction system.\n\n## Current Pipeline\n1. HtmlFetcher - fetch raw HTML\n2. HtmlCleaner - clean and convert to Markdown\n3. JobParser - AI extraction from Markdown\n4. CompanyResolver - resolve/create company\n5. JobLoader - save to database\n6. StreamLoader - add to job stream\n7. ApplicationLoader - optionally create application\n\n## New Pipeline\n1. HtmlFetcher - fetch raw HTML (unchanged)\n2. **JobExtractor** (new) - config-driven extraction\n   - ConfigMatcher.findMatch(url, html)\n   - If match: DeterministicExtractor.extract(config, html)\n   - If no match: ConfigGenerator.generate(url, html)\n   - Save config to DB if new\n   - Returns ExtractedJobData + CompletionState\n3. CompanyResolver - resolve/create company (updated to use ExtractedJobData)\n4. JobLoader - save to database (add completion_state column?)\n5. StreamLoader - add to job stream (unchanged)\n6. ApplicationLoader - optionally create application (unchanged)\n\n## Pipeline Step Interface\n```scala\ncase class JobExtractorInput(\n  html: String,\n  url: String,\n  objectId: Option[String]\n)\n\ncase class JobExtractorOutput(\n  extractedData: ExtractedJobData,\n  completionState: CompletionState,\n  configId: UUID,  // Config that was used\n  configWasGenerated: Boolean  // True if AI generated new config\n)\n```\n\n## Migration Considerations\n- Keep old HtmlCleaner/JobParser temporarily for comparison?\n- Feature flag to switch between old and new?\n- Or just replace entirely?\n\n## Files to Modify\n- `apps/api/src/main/scala/arcata/api/etl/JobIngestionPipeline.scala`\n- `apps/api/src/main/scala/arcata/api/etl/steps/JobExtractor.scala` (new, replaces HtmlCleaner + JobParser)\n\n## Tests\n- Integration test with real Netflix URL\n- Test config matching path\n- Test config generation path\n- Verify all pipeline steps still work","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-24T09:57:32.31187679-05:00","updated_at":"2025-12-24T14:00:20.971085566-05:00","closed_at":"2025-12-24T14:00:20.971085566-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.8","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:57:32.312544754-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.8","depends_on_id":"ArcataAI-xzo.4","type":"blocks","created_at":"2025-12-24T09:58:27.813559731-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.8","depends_on_id":"ArcataAI-xzo.5","type":"blocks","created_at":"2025-12-24T09:58:27.826247912-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.8","depends_on_id":"ArcataAI-xzo.6","type":"blocks","created_at":"2025-12-24T09:58:27.837916884-05:00","created_by":"daemon"},{"issue_id":"ArcataAI-xzo.8","depends_on_id":"ArcataAI-xzo.7","type":"blocks","created_at":"2025-12-24T09:58:27.848442343-05:00","created_by":"daemon"}]}
{"id":"ArcataAI-xzo.9","title":"Research: upickle vs json-path for JSONPath queries","description":"Determine the best approach for extracting values from JSON-LD using JSONPath expressions.\n\n## Context\nJSON-LD in job pages contains structured data like:\n```json\n{\n  \"@type\": \"JobPosting\",\n  \"title\": \"Software Engineer\",\n  \"hiringOrganization\": {\n    \"name\": \"Netflix\"\n  },\n  \"baseSalary\": {\n    \"value\": {\n      \"minValue\": 100000,\n      \"maxValue\": 720000\n    }\n  }\n}\n```\n\nWe need to extract values using paths like:\n- `$.title`\n- `$.hiringOrganization.name`\n- `$.baseSalary.value.minValue`\n\n## Options\n\n### Option A: upickle with manual path traversal\n- Already a dependency\n- Parse JSON to ujson.Value\n- Write simple path traversal: `json(\"baseSalary\")(\"value\")(\"minValue\")`\n- Pro: No new dependency\n- Con: Not full JSONPath spec (no wildcards, filters)\n\n### Option B: jayway/json-path library\n- `com.jayway:json-path:2.9.0`\n- Full JSONPath spec support\n- Pro: Standard JSONPath syntax\n- Con: New dependency, Java library\n\n### Option C: Custom mini JSONPath parser\n- Support subset: `$.foo.bar[0].baz`\n- Use upickle for JSON parsing\n- Pro: No dependency, full control\n- Con: More code to write/maintain\n\n## Recommendation\nStart with Option A (upickle manual traversal) for simplicity.\nIf we need advanced JSONPath features later, add json-path.\n\n## Deliverable\n- Document decision\n- Create utility function for path extraction\n- Add tests for common path patterns","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T09:57:47.281263842-05:00","updated_at":"2025-12-24T10:12:37.069307257-05:00","closed_at":"2025-12-24T10:12:37.069307257-05:00","dependencies":[{"issue_id":"ArcataAI-xzo.9","depends_on_id":"ArcataAI-xzo","type":"parent-child","created_at":"2025-12-24T09:57:47.281873973-05:00","created_by":"daemon"}]}
